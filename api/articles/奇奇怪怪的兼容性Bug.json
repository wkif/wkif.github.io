{"title":"奇奇怪怪的兼容性Bug","uid":"311754d371a04ae5df8f53f2dae3f317","slug":"奇奇怪怪的兼容性Bug","date":"2022-12-05T16:28:00.000Z","updated":"2023-08-19T05:53:53.806Z","comments":true,"path":"api/articles/奇奇怪怪的兼容性Bug.json","keywords":null,"cover":"https://kifimg.oss-cn-beijing.aliyuncs.com/img/202212060030103.png","content":"<h2 id=\"IOS-不支持this-router-go\"><a href=\"#IOS-不支持this-router-go\" class=\"headerlink\" title=\"IOS 不支持this.$router.go\"></a>IOS 不支持this.$router.go</h2><p>项目中遇到需要刷新当前界面，就使用了this.$router.go(0)，结果ios端不生效,this.router.go(0) 和 window.location.reload() 都是刷新当前页面的方法,Vue 写H5页面时，用 this.$router.go(0); 方法刷新当前页面，在苹果手机失效，安卓、pc、开发工具等都可以改用 <em><strong>*window.location.reload()*</strong></em> 问题解决！</p>\n<h2 id=\"微信端input-type-x3D-file-无法上传图片\"><a href=\"#微信端input-type-x3D-file-无法上传图片\" class=\"headerlink\" title=\"微信端input type&#x3D;file 无法上传图片\"></a>微信端input type&#x3D;file 无法上传图片</h2><p>在做一个上传头像功能时</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;input id&#x3D;&quot;photo&quot; type&#x3D;&quot;file&quot; accept&#x3D;&quot;image&#x2F;jpeg, image&#x2F;x-png, image&#x2F;gif&quot; capture&#x3D;&quot;camera&quot;&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这段代码在非微信浏览器内能选中图片并上传，而在微信浏览器内就失效了，查了各种资料并没有找个解决方案，一次 偶然的机会将代码改成</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;input id&#x3D;&quot;photo&quot; type&#x3D;&quot;file&quot; accept&#x3D;&quot;image&#x2F;*&quot; capture&#x3D;&quot;camera&quot;&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>发现奇迹般的在微信里成功了。</p>\n<p>自己猜测，可能是 accept&#x3D;”image&#x2F;jpeg, image&#x2F;x-png, image&#x2F;gif” 这个属性在微信里寻找手机里的图片的时候类型不匹配，导致上传失败，将其改成 accept&#x3D;”image&#x2F;*” 这个时候就能成功。可能是微信浏览器内对input的配置问题。</p>\n<p>最后发现可以不要 capture&#x3D;”camera” 也能调用摄像头。最后代码为</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;input id&#x3D;&quot;photo&quot; type&#x3D;&quot;file&quot; accept&#x3D;&quot;image&#x2F;*&quot;&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>或者使用JSSDK</p>\n<p>参考：<a href=\"https://cloud.tencent.com/developer/article/1399109\">微信端input type&#x3D;file 无法上传图片</a></p>\n<h2 id=\"网页刷新或标签页关闭时发个请求\"><a href=\"#网页刷新或标签页关闭时发个请求\" class=\"headerlink\" title=\"网页刷新或标签页关闭时发个请求\"></a>网页刷新或标签页关闭时发个请求</h2><p>应用场景：一般来说埋点数据请求遇到这个场景可能比较多，项目需要对信息编辑页内容进行数据缓存，由于操作会到其他分包，所以基于vueRouter的keepalive便失去了效果，诚然，这种情况使用localStorage才是更好的，但是这个信息编辑页数据之间太复杂，接手项目再来梳理时间成本太高，考虑到已经有保存草稿这个功能，遂打算稍微改造这个接口用来做信息缓存，故需要考虑到网页刷新或标签页关闭时发个请求。</p>\n<p>项目中使用Axios做数据请求，但Axios异步的，不支持同步的请求，请求会被cancel。</p>\n<p>与浏览器关闭事件相关事件有onunload和onbeforeunload两个。区别在于onbeforeunload在onunload之前执行，它还可以阻止onunload的执行。因此我们着重关注onbeforeunload事件。</p>\n<h3 id=\"fetch\"><a href=\"#fetch\" class=\"headerlink\" title=\"fetch\"></a>fetch</h3><p>Fetch 的keepalive属性提供了一套健壮的与服务器端交互的方式，提供了跨越不同平台 API 的一致接口。它提供了一个keepalive属性，保证不管发送请求的页面关闭与否，请求都会持续直到结束。不过上传数据的限制是64 KB。写法如下：</p>\n<pre class=\"line-numbers language-js\" data-language=\"js\"><code class=\"language-js\">window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span>‘onbeforeunload’<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n<span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/api'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token literal-property property\">method</span><span class=\"token operator\">:</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">body</span><span class=\"token operator\">:</span> data<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">keepalive</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>这个方法可以在刷新或标签页关闭前把请求发出去，但是 <strong>企业微信</strong>中不支持</p>\n<h3 id=\"SendBeacon\"><a href=\"#SendBeacon\" class=\"headerlink\" title=\"SendBeacon()\"></a>SendBeacon()</h3><p><img src=\"https://kifimg.oss-cn-beijing.aliyuncs.com/img/202212072259919.png\" alt=\"image-20221207225912863\"></p>\n<p>群里一问了解到这个 <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Navigator/sendBeacon\">Navigator.sendBeacon()</a></p>\n<p>但<img src=\"https://kifimg.oss-cn-beijing.aliyuncs.com/img/202212072300083.png\" alt=\"img\"></p>\n<p>只能吐槽企微和微信。。。</p>\n<p>最终考虑到最不想用的：使用定时器检查编辑数据和上次提交的数据有无变化，此处可以用diff的包也可以自己写，如果变了就发个请求，缺陷在于定时diff性能消耗可能有点大。</p>\n<h2 id=\"ios及部分安卓浏览器引入unocss报错导致首屏白屏\"><a href=\"#ios及部分安卓浏览器引入unocss报错导致首屏白屏\" class=\"headerlink\" title=\"ios及部分安卓浏览器引入unocss报错导致首屏白屏\"></a>ios及部分安卓浏览器引入unocss报错导致首屏白屏</h2><p>先说问题原因：</p>\n<p>浏览器内核不支持 toplevel await, 解决办法参看pr （<a href=\"https://github.com/unocss/unocss/pull/2066%EF%BC%89\">https://github.com/unocss/unocss/pull/2066）</a></p>\n<p>vite.config.ts 中配置 hmrTopLevelAwait 为false</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">UnoCSS(&#123;\n     hmrTopLevelAwait: false,\n&#125;)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n\n\n<p>在unocss源码中 packages\\vite\\src\\modes\\global\\dev.ts，</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">let hmr &#x3D; &#96;\ntry &#123;\n let hash &#x3D; __vite__css.match(&#x2F;__uno_hash_(\\\\w&#123;$&#123;HASH_LENGTH&#125;&#125;)&#x2F;)\n hash &#x3D; hash &amp;&amp; hash[1]\n if (!hash)\n  console.warn(&#39;[unocss-hmr]&#39;, &#39;failed to get unocss hash, hmr might not work kif&#39;)\n else\n  await import.meta.hot.send(&#39;$&#123;WS_EVENT_PREFIX&#125;&#39;, [&#39;$&#123;layer&#125;&#39;, hash]);\n&#125; catch (e) &#123;\n console.warn(&#39;[unocss-hmr]&#39;, e)\n&#125;\nif (!import.meta.url.includes(&#39;?&#39;))\n await new Promise(resolve &#x3D;&gt; setTimeout(resolve, 100))&#96;\n\n\n\nconst config &#x3D; await getConfig() as VitePluginConfig\n\nif (config.hmrTopLevelAwait &#x3D;&#x3D;&#x3D; false)\n\thmr &#x3D; &#96;;(async function() &#123;$&#123;hmr&#125;\\n&#125;)()&#96;\nhmr &#x3D; &#96;\\nif (import.meta.hot) &#123;$&#123;hmr&#125;&#125;&#96;\n\nconst s &#x3D; new MagicString(code)\ns.append(hmr)\n\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>通过 config.hmrTopLevelAwait 判断是否支持 顶级await，向上找发现此项是UnoCSS 的手动配置项</p>\n<h2 id=\"ios端-Unexpected-token-‘-x3D-’-Expected-an-opening-‘-‘-before-a-method’s-parameter-list\"><a href=\"#ios端-Unexpected-token-‘-x3D-’-Expected-an-opening-‘-‘-before-a-method’s-parameter-list\" class=\"headerlink\" title=\"ios端 Unexpected token ‘&#x3D;’. Expected an opening ‘(‘ before a method’s parameter list\"></a>ios端 Unexpected token ‘&#x3D;’. Expected an opening ‘(‘ before a method’s parameter list</h2><p>问题出在项目中Axios封装：</p>\n<pre class=\"line-numbers language-ts\" data-language=\"ts\"><code class=\"language-ts\">import type &#123; AxiosInstance, AxiosRequestConfig, AxiosResponse, AxiosError &#125; from &quot;axios&quot;;\nimport &#123; ApiDataResponse &#125; from &quot;#&#x2F;axios&quot;;\nimport Axios from &quot;axios&quot;;\nimport &#123; Toast &#125; from &quot;vant&quot;;\nimport &#123; whiteCodes &#125; from &quot;.&#x2F;codes&quot;;\n\nAxios.defaults.withCredentials &#x3D; true;\n\nconst defaultConfig: AxiosRequestConfig &#x3D; &#123;\n  baseURL: &quot;&quot;,\n  timeout: 1000 * 30,\n&#125;;\nclass Request &#123;\n  private axiosInstance: AxiosInstance;\n  constructor() &#123;\n    this.axiosInstance &#x3D; Axios.create(defaultConfig);\n    this.httpInterceptorsRequest();\n    this.httpInterceptorsResponse();\n &#125;\n  &#x2F;**\n   * @description 请求拦截器\n   *&#x2F;\n  private httpInterceptorsRequest(): void &#123;\n    this.axiosInstance.interceptors.request.use(\n     (config: AxiosRequestConfig) &#x3D;&gt; &#123;\n        &#x2F;&#x2F; 添加逻辑\n        return config;\n     &#125;,\n     (error: AxiosError): Promise&lt;any&gt; &#x3D;&gt; &#123;\n        return Promise.reject(error);\n     &#125;,\n   );\n &#125;\n  &#x2F;**\n   * @description 响应拦截器\n   *&#x2F;\n  private httpInterceptorsResponse(): void &#123;\n    this.axiosInstance.interceptors.response.use(\n     (response: AxiosResponse) &#x3D;&gt; &#123;\n        if (response.headers.hxe_auth) &#123;\n          response.data.data.userToken &#x3D; response.headers.hxe_auth;\n       &#125;\n        this.responseHandle(response);\n        return response;\n     &#125;,\n     (error: AxiosError): Promise&lt;any&gt; &#x3D;&gt; &#123;\n        const &#123; response, message &#125; &#x3D; error;\n        if (response) &#123;\n          this.responseHandle(response, message);\n       &#125; else &#123;\n          const message &#x3D; error.message.includes(&quot;timeout&quot;)\n            ? &quot;请求超时！请检查网络是否正常&quot;\n           : &quot;请求失败，请检查网络是否已连接&quot;;\n          Toast.fail(message);\n       &#125;\n        return Promise.reject(error);\n     &#125;,\n   );\n &#125;\n  request&lt;T &#x3D; any, U &#x3D; any&gt;(config: AxiosRequestConfig): Promise&lt;ApiDataResponse&lt;T&gt; | U&gt; &#123;\n    return new Promise((resolve, reject) &#x3D;&gt; &#123;\n      this.axiosInstance(config)\n       .then((res: AxiosResponse) &#x3D;&gt; &#123;\n          resolve(res.data);\n       &#125;)\n       .catch((err: Error | AxiosError) &#x3D;&gt; &#123;\n          reject(err);\n       &#125;);\n   &#125;);\n &#125;\n\n  &#x2F;**\n   * @description 错误码处理\n   * @param &#123; Object &#125; response 响应结果\n   *&#x2F;\n  private responseHandle(response: AxiosResponse, message?: string): void &#123;\n    switch (response.status) &#123;\n      case 401:\n      case 403:\n        console.log(&quot;需要登录&quot;);\n        break;\n      case 404:\n        Toast.fail(&quot;请求资源不存在&quot;);\n        break;\n      case 200:\n        if (response.config.responseType &#x3D;&#x3D;&#x3D; &quot;blob&quot;) &#123;\n          return;\n       &#125;\n        const code &#x3D; response.data?.code;\n        if (code !&#x3D;&#x3D; 0 &amp;&amp; !Object.keys(whiteCodes).includes(String(code))) &#123;\n          Toast.fail(response.data?.message ?? response.data?.msg ?? &quot;出错了&quot;);\n       &#125;\n        break;\n      default:\n        Toast.fail(response.data?.message ?? message ?? &quot;未知错误&quot;);\n        break;\n   &#125;\n &#125;\n&#125;\n\nexport const http &#x3D; new Request();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<p><code>private axiosInstance: AxiosInstance</code> 使用了 公有字段声明<a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes#field_declarations\">Private class features</a>，例子如下：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">class Account &#123;\n accountFields &#x3D; [&#39;field1&#39;, &#39;field2&#39;, &#39;field3&#39;]\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>其兼容性如下：</p>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/Public_class_fields#browser_compatibility\">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/Public_class_fields#browser_compatibility</a></p>\n<p>bug记录：</p>\n<p><a href=\"https://bugs.webkit.org/show_bug.cgi?id=194095\">https://bugs.webkit.org/show_bug.cgi?id=194095</a></p>\n<p>It’s currently <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/Public_class_fields#browser_compatibility\">supported</a> by most modern browsers. However, <strong>the only Safari versions that support this feature are v14.1</strong> (released April 26th, 2021) and higher. If you need to support older versions of Safari &#x2F; a wider variety of older browsers you’ll need to follow one of the suggestions below.</p>\n<p>Instead of using public field declarations, you can use a <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes#Constructor\">constructor() method</a> to define the properties for your class instances. Using a constructor does have <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes#Browser_compatibility\">good browser compatibility</a> (for IE support you can use a <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new#description\">constructor function</a>):</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">class Account &#123;\n  constructor() &#123;\n    this.accountFields &#x3D; [&#39;field1&#39;, &#39;field2&#39;, &#39;field3&#39;];\n &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>As pointed out in the comments by <a href=\"https://stackoverflow.com/users/1062794/baz\">@Baz</a>, you can also use Babel as an alternative solution. Using babel means that you won’t have to change your code, which can make things easier on you if you’re using public field declarations a lot throughout your project. Babel will transpile&#x2F;compile your modern JS code into older (ES5 and below) JS code which can be understood by many browsers. You can use <a href=\"https://babeljs.io/docs/en/babel-plugin-proposal-class-properties\">this</a> babel plugin like so.</p>\n<p>First, install the babel plugin:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">npm install --save-dev @babel&#x2F;plugin-proposal-class-properties<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>Then add the plugin to your configuration file:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n  &quot;plugins&quot;: [&quot;@babel&#x2F;plugin-proposal-class-properties&quot;]\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>For other installation options (babel CLI, etc), see the <a href=\"https://babeljs.io/docs/en/babel-plugin-proposal-class-properties#usage\">usage section</a> of the plugin’s docs.</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><a href=\"https://stackoverflow.com/questions/60026651/safari-unexpected-token-expected-an-opening-before-a-methods-paramet\">https://stackoverflow.com/questions/60026651/safari-unexpected-token-expected-an-opening-before-a-methods-paramet</a></p></blockquote>\n<p>待續……</p>\n","text":"IOS 不支持this.$router.go项目中遇到需要刷新当前界面，就使用了this.$router.go(0)，结果ios端不生效,this.router.go(0) 和 window.location.reload() 都是刷新当前页面的方法,Vue 写H5页面时，用 t...","link":"","photos":[],"count_time":{"symbolsCount":"8.5k","symbolsTime":"8 mins."},"categories":[{"name":"开发笔记","slug":"开发笔记","count":3,"path":"api/categories/开发笔记.json"}],"tags":[{"name":"兼容性","slug":"兼容性","count":1,"path":"api/tags/兼容性.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#IOS-%E4%B8%8D%E6%94%AF%E6%8C%81this-router-go\"><span class=\"toc-text\">IOS 不支持this.$router.go</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%BE%AE%E4%BF%A1%E7%AB%AFinput-type-x3D-file-%E6%97%A0%E6%B3%95%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87\"><span class=\"toc-text\">微信端input type&#x3D;file 无法上传图片</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%BD%91%E9%A1%B5%E5%88%B7%E6%96%B0%E6%88%96%E6%A0%87%E7%AD%BE%E9%A1%B5%E5%85%B3%E9%97%AD%E6%97%B6%E5%8F%91%E4%B8%AA%E8%AF%B7%E6%B1%82\"><span class=\"toc-text\">网页刷新或标签页关闭时发个请求</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#fetch\"><span class=\"toc-text\">fetch</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#SendBeacon\"><span class=\"toc-text\">SendBeacon()</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#ios%E5%8F%8A%E9%83%A8%E5%88%86%E5%AE%89%E5%8D%93%E6%B5%8F%E8%A7%88%E5%99%A8%E5%BC%95%E5%85%A5unocss%E6%8A%A5%E9%94%99%E5%AF%BC%E8%87%B4%E9%A6%96%E5%B1%8F%E7%99%BD%E5%B1%8F\"><span class=\"toc-text\">ios及部分安卓浏览器引入unocss报错导致首屏白屏</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#ios%E7%AB%AF-Unexpected-token-%E2%80%98-x3D-%E2%80%99-Expected-an-opening-%E2%80%98-%E2%80%98-before-a-method%E2%80%99s-parameter-list\"><span class=\"toc-text\">ios端 Unexpected token ‘&#x3D;’. Expected an opening ‘(‘ before a method’s parameter list</span></a></li></ol>","author":{"name":"kif","slug":"blog-author","avatar":"https://kifimg.oss-cn-beijing.aliyuncs.com/imgforteachingdemo/20201127203438.png","link":"/","description":"时间再拉长一点，让我有时间收拾一下心情","socials":{"github":"https://github.com/wkif","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/qq_54739682?type=blog","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"js 数组详细操作方法及解析","uid":"24deb55255063425129571f44dab3ef2","slug":"js-数组详细操作方法及解析","date":"2023-01-10T03:18:00.000Z","updated":"2023-01-10T03:23:08.955Z","comments":true,"path":"api/articles/js-数组详细操作方法及解析.json","keywords":null,"cover":"https://kifimg.oss-cn-beijing.aliyuncs.com/img/202301101122188.png","text":"创建一个数组: // 字面量方式: // 这个方法也是我们最常用的，在初始化数组的时候 相当方便 var a = [3, 11, 8]; // [3,11,8]; // 构造器: // 实际上 new Array === Array,加不加new 一点影响都没有。 var a =...","link":"","photos":[],"count_time":{"symbolsCount":"19k","symbolsTime":"17 mins."},"categories":[{"name":"转载","slug":"转载","count":1,"path":"api/categories/转载.json"},{"name":"学习笔记","slug":"转载/学习笔记","count":1,"path":"api/categories/转载/学习笔记.json"}],"tags":[{"name":"javascript","slug":"javascript","count":7,"path":"api/tags/javascript.json"},{"name":"数组","slug":"数组","count":1,"path":"api/tags/数组.json"}],"author":{"name":"kif","slug":"blog-author","avatar":"https://kifimg.oss-cn-beijing.aliyuncs.com/imgforteachingdemo/20201127203438.png","link":"/","description":"时间再拉长一点，让我有时间收拾一下心情","socials":{"github":"https://github.com/wkif","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/qq_54739682?type=blog","juejin":"","customs":{}}}},"next_post":{"title":"vue3+vite+ts配置eslint+husky","uid":"59055f5d64cb45bdfcbaa23146e2d50d","slug":"vue3-vite-ts配置eslint-husky","date":"2022-11-19T08:06:00.000Z","updated":"2022-11-19T08:09:05.319Z","comments":true,"path":"api/articles/vue3-vite-ts配置eslint-husky.json","keywords":null,"cover":"https://kifimg.oss-cn-beijing.aliyuncs.com/img/202211191608596.jpg","text":"vue3+vite+ts配置eslint+husky创建项目命令 yarn create vite vue3-vite-ts –template vue-ts eslint代码风格检查，prettier进行格式化代码 安装相关依赖 ； yarn add eslint eslint...","link":"","photos":[],"count_time":{"symbolsCount":"5.3k","symbolsTime":"5 mins."},"categories":[{"name":"开发记录","slug":"开发记录","count":3,"path":"api/categories/开发记录.json"}],"tags":[{"name":"开发规范","slug":"开发规范","count":2,"path":"api/tags/开发规范.json"}],"author":{"name":"kif","slug":"blog-author","avatar":"https://kifimg.oss-cn-beijing.aliyuncs.com/imgforteachingdemo/20201127203438.png","link":"/","description":"时间再拉长一点，让我有时间收拾一下心情","socials":{"github":"https://github.com/wkif","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/qq_54739682?type=blog","juejin":"","customs":{}}}}}